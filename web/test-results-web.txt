
> helix-observatory@1.0.0 test
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90mC:/Users/Specter/Desktop/Helix/web[39m

[90mstderr[2m | src/services/status/status-service.test.ts
[22m[39mSupabase credentials not found. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file.

[90mstderr[2m | src/components/InviteMembers.test.tsx
[22m[39mSupabase credentials not found. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file.

[90mstderr[2m | src/components/InvitationAccept.test.tsx
[22m[39mSupabase credentials not found. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file.

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mComponent Health Checks[2m > [22m[2mshould check API gateway status
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:27:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:27:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mComponent Health Checks[2m > [22m[2mshould mark component as degraded when latency > 2000ms
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:48:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:48:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConnection Management[2m > [22m[2mshould connect to WebSocket server
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConnection Management[2m > [22m[2mshould disconnect from WebSocket server
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConnection Management[2m > [22m[2mshould support reconnection with exponential backoff
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/components/TenantSettings.test.tsx
[22m[39mSupabase credentials not found. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file.

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Subscription[2m > [22m[2mshould subscribe to specific event type
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Subscription[2m > [22m[2mshould support multiple subscribers for same event
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstdout[2m | src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22m[2mRedisRateLimiter[2m > [22m[2mQuota Management[2m > [22m[2mshould reset rate limit for user
[22m[39m[RateLimiter] Reset limit for user test-user-123

[90mstdout[2m | src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22m[2mRedisRateLimiter[2m > [22m[2mError Handling[2m > [22m[2mshould handle reset limit errors gracefully
[22m[39m[RateLimiter] Reset limit for user test-user-123

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Subscription[2m > [22m[2mshould return unsubscribe function
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2minviteUser[2m > [22m[2mshould reject invalid email format
[22m[39mFailed to invite user: Error: Invalid email address: not-an-email
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:51:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:142:17
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2minviteUser[2m > [22m[2mshould reject if user already has pending invitation
[22m[39mFailed to invite user: Error: User user@example.com already has a pending invitation
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:57:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:165:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/services/rate-limiting/redis-rate-limiter.test.ts [2m([22m[2m31 tests[22m[2m | [22m[31m31 failed[39m[2m)[22m[32m 136[2mms[22m[39m
[31m       [31mÃ—[31m should initialize with default Redis URL[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should initialize with custom Redis URL[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should load Lua script on initialization[39m[32m 112[2mms[22m[39m
[31m       [31mÃ—[31m should allow request within limit[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should deny request when limit exceeded[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should decrement remaining tokens on each request[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should use custom limit value[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should use custom window value[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should reset bucket after window expires[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should not allow overfilling bucket[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should get current quota[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should return default quota when key missing[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should reset rate limit for user[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should get all active rate limit keys[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support custom key patterns[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle multiple concurrent requests[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle concurrent requests for different users[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should fail open when Redis is unavailable[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should reload script on NOSCRIPT error[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle get quota errors gracefully[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle reset limit errors gracefully[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should include reset time in response[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should include retry-after for denied requests[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should not include retry-after for allowed requests[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should close Redis connection[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle close errors gracefully[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should provide singleton instance[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should allow custom config on first initialization[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle 1000 requests efficiently[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support API rate limiting workflow[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should support per-operation rate limiting[39m[32m 0[2mms[22m[39m
[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2minviteUser[2m > [22m[2mshould handle database insertion error
[22m[39mFailed to invite user: Error: Failed to create invitation: Database constraint violation
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:87:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:289:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Subscription[2m > [22m[2mshould subscribe to multiple event types at once
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2macceptInvitation[2m > [22m[2mshould successfully accept valid pending invitation
[22m[39mFailed to accept invitation: Error: User not found
    at TenantInviteService.acceptInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:155:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:330:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2macceptInvitation[2m > [22m[2mshould reject expired invitation
[22m[39mFailed to accept invitation: Error: Invitation has expired
    at TenantInviteService.acceptInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:142:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2macceptInvitation[2m > [22m[2mshould reject already accepted invitation
[22m[39mFailed to accept invitation: Error: Invitation already accepted
    at TenantInviteService.acceptInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:147:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2macceptInvitation[2m > [22m[2mshould reject invalid/missing invitation token
[22m[39mFailed to accept invitation: Error: Invalid or expired invitation
    at TenantInviteService.acceptInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:137:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2macceptInvitation[2m > [22m[2mshould reject if user not found
[22m[39mFailed to accept invitation: Error: User not found
    at TenantInviteService.acceptInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:155:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:427:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2macceptInvitation[2m > [22m[2mshould preserve role from invitation
[22m[39mFailed to accept invitation: Error: User not found
    at TenantInviteService.acceptInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:155:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:461:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mrejectInvitation[2m > [22m[2mshould reject if invitation not found
[22m[39mFailed to reject invitation: Error: Invitation not found
    at TenantInviteService.rejectInvitation (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:225:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mchangeMemberRole[2m > [22m[2mshould reject invalid role
[22m[39mFailed to change member role: Error: Invalid role: superadmin
    at TenantInviteService.changeMemberRole (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:333:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:644:17
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mremoveMember[2m > [22m[2mshould prevent removing owner
[22m[39mFailed to remove member: Error: Cannot remove tenant owner
    at TenantInviteService.removeMember (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:384:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Handling[2m > [22m[2mshould deliver operation_complete event to subscribers
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mEmail validation[2m > [22m[2mshould reject invalid email addresses
[22m[39mFailed to invite user: Error: Invalid email address: notanemail
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:51:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:906:19
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mEmail validation[2m > [22m[2mshould reject invalid email addresses
[22m[39mFailed to invite user: Error: Invalid email address: @example.com
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:51:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:906:19
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mEmail validation[2m > [22m[2mshould reject invalid email addresses
[22m[39mFailed to invite user: Error: Invalid email address: user@
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:51:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:906:19
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mEmail validation[2m > [22m[2mshould reject invalid email addresses
[22m[39mFailed to invite user: Error: Invalid email address: user @example.com
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:51:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:906:19
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/tenant/invite-service.test.ts[2m > [22m[2mTenantInviteService[2m > [22m[2mEmail validation[2m > [22m[2mshould reject invalid email addresses
[22m[39mFailed to invite user: Error: Invalid email address: 
    at TenantInviteService.inviteUser (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.ts:51:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invite-service.test.ts:906:19
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/services/tenant/invite-service.test.ts [2m([22m[2m39 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 45[2mms[22m[39m
       [32mâœ“[39m should successfully invite user with default role (member)[32m 3[2mms[22m[39m
       [32mâœ“[39m should successfully invite user with specific role (admin)[32m 0[2mms[22m[39m
       [32mâœ“[39m should reject invalid email format[32m 6[2mms[22m[39m
       [32mâœ“[39m should reject if user already has pending invitation[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should reject if user is already a member[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m should generate unique token and set 6-hour expiry[32m 1[2mms[22m[39m
       [32mâœ“[39m should log invitation to hash chain[32m 1[2mms[22m[39m
       [32mâœ“[39m should send Discord notification[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle database insertion error[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should successfully accept valid pending invitation[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should reject expired invitation[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject already accepted invitation[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject invalid/missing invitation token[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject if user not found[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should preserve role from invitation[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should successfully reject pending invitation[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject if invitation not found[32m 2[2mms[22m[39m
       [32mâœ“[39m should return pending non-expired invitations for email[32m 1[2mms[22m[39m
       [32mâœ“[39m should return empty array if no pending invitations[32m 0[2mms[22m[39m
       [32mâœ“[39m should gracefully handle database errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should return all members ordered by joined_at[32m 1[2mms[22m[39m
       [32mâœ“[39m should return empty array for tenant with no members[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing email gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should successfully change member role[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject invalid role[32m 1[2mms[22m[39m
       [32mâœ“[39m should successfully remove non-owner member[32m 1[2mms[22m[39m
       [32mâœ“[39m should prevent removing owner[32m 1[2mms[22m[39m
       [32mâœ“[39m should return true if user has required role or higher[32m 0[2mms[22m[39m
       [32mâœ“[39m should return false if user has lower role[32m 0[2mms[22m[39m
       [32mâœ“[39m should return false if user not a member[32m 0[2mms[22m[39m
       [32mâœ“[39m should use role hierarchy correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle database errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should return invitation details without exposing token[32m 1[2mms[22m[39m
       [32mâœ“[39m should return null for expired invitation[32m 0[2mms[22m[39m
       [32mâœ“[39m should return null if invitation not found[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing tenant name[32m 0[2mms[22m[39m
       [32mâœ“[39m should return a TenantInviteService instance[32m 0[2mms[22m[39m
       [32mâœ“[39m should accept valid email address[32m 0[2mms[22m[39m
       [32mâœ“[39m should reject invalid email addresses[32m 8[2mms[22m[39m
[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Handling[2m > [22m[2mshould deliver operation_failed event to subscribers
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Handling[2m > [22m[2mshould deliver cost_update event to subscribers
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mPre-Meeting Workflow[2m > [22m[2mprepares meeting 15 minutes before start
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:52:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mPre-Meeting Workflow[2m > [22m[2mincludes recent emails in meeting context
[22m[39mFailed to find relevant emails: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).gte is not a function
    at MeetingPrepService.findRelevantEmails (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:166:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:69:47
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Handling[2m > [22m[2mshould deliver sla_update event to subscribers
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mPre-Meeting Workflow[2m > [22m[2msaves meeting context for later reference
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:137:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mPre-Meeting Workflow[2m > [22m[2msaves meeting context for later reference
[22m[39mFailed to get meeting context: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getMeetingContext (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:348:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:139:50
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mComplete Meeting Lifecycle[2m > [22m[2mexecutes full pre-meeting to post-meeting workflow
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:244:52
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mComplete Meeting Lifecycle[2m > [22m[2mlinks pre-meeting context to post-meeting actions
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:262:52
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mError Handling in Workflow[2m > [22m[2mhandles missing meeting gracefully
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:301:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mDiscord Logging & Hash Chain[2m > [22m[2mlogs meeting prep generation
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:341:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mPerformance[2m > [22m[2mcompletes meeting prep within reasonable time
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:381:32
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22m[2mMeetingâ†’Task Integration Workflow[2m > [22m[2mType Safety[2m > [22m[2mreturns properly typed meeting context
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/meeting-to-task.integration.test.ts:406:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mEvent Handling[2m > [22m[2mshould handle errors in event listeners gracefully
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
 [31mâ¯[39m src/services/__tests__/meeting-to-task.integration.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 41[2mms[22m[39m
[31m       [31mÃ—[31m prepares meeting 15 minutes before start[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m includes recent emails in meeting context[32m 1[2mms[22m[39m
       [32mâœ“[39m extracts action items from recent emails[32m 0[2mms[22m[39m
       [32mâœ“[39m generates prep checklist[32m 17[2mms[22m[39m
       [32mâœ“[39m creates prep task with HIGH priority[32m 0[2mms[22m[39m
       [32mâœ“[39m saves meeting context for later reference[32m 1[2mms[22m[39m
       [32mâœ“[39m extracts action items from meeting notes[32m 1[2mms[22m[39m
       [32mâœ“[39m infers priority from action item text[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m extracts due dates from action items[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m creates follow-up tasks for action items[32m 0[2mms[22m[39m
       [32mâœ“[39m generates summary email[32m 0[2mms[22m[39m
       [32mâœ“[39m retrieves created follow-up tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m executes full pre-meeting to post-meeting workflow[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m links pre-meeting context to post-meeting actions[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m handles multiple action items across workflow[32m 0[2mms[22m[39m
       [32mâœ“[39m handles missing meeting gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m handles empty meeting notes[32m 0[2mms[22m[39m
       [32mâœ“[39m continues workflow despite extraction failures[32m 0[2mms[22m[39m
       [32mâœ“[39m logs meeting prep generation[32m 0[2mms[22m[39m
       [32mâœ“[39m logs post-meeting followup creation[32m 0[2mms[22m[39m
       [32mâœ“[39m logs errors in workflow[32m 0[2mms[22m[39m
       [32mâœ“[39m completes meeting prep within reasonable time[32m 1[2mms[22m[39m
       [32mâœ“[39m completes post-meeting followup within reasonable time[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m returns properly typed meeting context[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m returns properly typed task IDs from followup[32m 0[2mms[22m[39m
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mBatch Progress Events[2m > [22m[2mshould track batch operation progress
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

 [31mâ¯[39m src/lib/repositories/__tests__/conversations.test.ts [2m([22m[2m18 tests[22m[2m | [22m[31m15 failed[39m[2m)[22m[32m 243[2mms[22m[39m
[31m       [31mÃ—[31m should insert conversation with emotional metadata[39m[32m 8[2mms[22m[39m
[31m       [31mÃ—[31m should store conversation with default optional fields[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should store conversation with all optional fields[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should retrieve recent memories ordered by date descending[39m[32m 215[2mms[22m[39m
[31m       [31mÃ—[31m should respect limit and offset pagination[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should exclude soft-deleted conversations from results[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should perform similarity search using pgvector[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should return empty results for user with no memories[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should respect limit parameter in search results[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should update conversation with emotion analysis[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should update secondary emotions in emotion analysis[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should store conversations with different salience tiers[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should properly store and retrieve complex message arrays[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should properly handle array fields (secondary_emotions, topics)[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should maintain timestamp integrity[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle missing required fields gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle database connection errors[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should perform complete workflow: create, retrieve, update, search[39m[32m 1[2mms[22m[39m
[90mstderr[2m | src/components/InvitationAccept.test.tsx[2m > [22m[2mInvitationAccept[2m > [22m[2mshould render loading state initially
[22m[39mâš ï¸ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
âš ï¸ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.
Warning: An update to InvitationAccept inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at InvitationAccept (C:/Users/Specter/Desktop/Helix/web/src/components/InvitationAccept.tsx:13:67)
    at RenderedRoute (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:539:7)
    at Routes (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:1273:7)
    at Router (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:1207:17)
    at MemoryRouter (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:1101:7)
Warning: An update to InvitationAccept inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at InvitationAccept (C:/Users/Specter/Desktop/Helix/web/src/components/InvitationAccept.tsx:13:67)
    at RenderedRoute (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:539:7)
    at Routes (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:1273:7)
    at Router (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:1207:17)
    at MemoryRouter (C:\Users\Specter\Desktop\Helix\web\node_modules\react-router\dist\umd\react-router.development.js:1101:7)

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mBatch Progress Events[2m > [22m[2mshould handle progress from 0 to 100
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConnection Status[2m > [22m[2mshould report connected status
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConnection Status[2m > [22m[2mshould handle token from localStorage
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConnection Status[2m > [22m[2mshould prefer explicit token over localStorage
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
[90mstderr[2m | src/components/InviteMembers.test.tsx[2m > [22m[2mInviteMembers[2m > [22m[2mshould show error message on invite failure
[22m[39mFailed to invite user: Error: User already invited
    at C:/Users/Specter/Desktop/Helix/web/src/components/InviteMembers.test.tsx:141:23
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
Not implemented: HTMLCanvasElement's getContext() method: without installing the canvas npm package
[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mListener Management[2m > [22m[2mshould return listener counts
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mListener Management[2m > [22m[2mshould clear all listeners on disconnect
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConcurrent Event Handling[2m > [22m[2mshould handle rapid successive events
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

[90mstderr[2m | src/services/monitoring/metrics-stream.test.ts[2m > [22m[2mMetricsStreamService[2m > [22m[2mConcurrent Event Handling[2m > [22m[2mshould handle mixed event types concurrently
[22m[39m[MetricsStream] WebSocket error: Event { isTrusted: [36m[Getter][39m }

 [31mâ¯[39m src/components/InviteMembers.test.tsx [2m([22m[2m13 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 517[2mms[22m[39m
     [32mâœ“[39m should render invite form[32m 192[2mms[22m[39m
[31m     [31mÃ—[31m should have role selector with three options[39m[32m 8[2mms[22m[39m
     [32mâœ“[39m should show default role description for member[32m 20[2mms[22m[39m
[31m     [31mÃ—[31m should update role description when role changes[39m[32m 4[2mms[22m[39m
     [32mâœ“[39m should disable submit button when email is empty[32m 15[2mms[22m[39m
     [32mâœ“[39m should enable submit button when email is provided[32m 16[2mms[22m[39m
[31m     [31mÃ—[31m should submit invitation with correct data[39m[32m 5[2mms[22m[39m
     [32mâœ“[39m should show success message on successful invite[32m 23[2mms[22m[39m
     [32mâœ“[39m should clear form after successful invite[32m 17[2mms[22m[39m
     [32mâœ“[39m should show error message on invite failure[32m 46[2mms[22m[39m
     [32mâœ“[39m should call onSuccess callback after successful invite[32m 111[2mms[22m[39m
     [32mâœ“[39m should show loading state during submission[32m 32[2mms[22m[39m
     [32mâœ“[39m should show 6-hour expiry info[32m 23[2mms[22m[39m
 [31mâ¯[39m src/services/monitoring/metrics-stream.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m21 failed[39m[2m)[22m[33m 708[2mms[22m[39m
[31m       [31mÃ—[31m should connect to WebSocket server[39m[32m 64[2mms[22m[39m
[31m       [31mÃ—[31m should disconnect from WebSocket server[39m[32m 10[2mms[22m[39m
[31m       [31mÃ—[31m should support reconnection with exponential backoff[39m[32m 15[2mms[22m[39m
[31m       [31mÃ—[31m should subscribe to specific event type[39m[32m 15[2mms[22m[39m
[31m       [31mÃ—[31m should support multiple subscribers for same event[39m[32m 13[2mms[22m[39m
[31m       [31mÃ—[31m should return unsubscribe function[39m[32m 21[2mms[22m[39m
[31m       [31mÃ—[31m should subscribe to multiple event types at once[39m[32m 16[2mms[22m[39m
[31m       [31mÃ—[31m should deliver operation_complete event to subscribers[39m[32m 13[2mms[22m[39m
[31m       [31mÃ—[31m should deliver operation_failed event to subscribers[39m[32m 18[2mms[22m[39m
[31m       [31mÃ—[31m should deliver cost_update event to subscribers[39m[32m 15[2mms[22m[39m
[31m       [31mÃ—[31m should deliver sla_update event to subscribers[39m[32m 16[2mms[22m[39m
[31m       [31mÃ—[31m should handle errors in event listeners gracefully[39m[32m 24[2mms[22m[39m
[31m       [31mÃ—[31m should track batch operation progress[39m[32m 35[2mms[22m[39m
[31m       [31mÃ—[31m should handle progress from 0 to 100[39m[32m 64[2mms[22m[39m
[31m       [31mÃ—[31m should report connected status[39m[32m 42[2mms[22m[39m
[31m       [31mÃ—[31m should handle token from localStorage[39m[32m 47[2mms[22m[39m
[31m       [31mÃ—[31m should prefer explicit token over localStorage[39m[32m 84[2mms[22m[39m
[31m       [31mÃ—[31m should return listener counts[39m[32m 39[2mms[22m[39m
[31m       [31mÃ—[31m should clear all listeners on disconnect[39m[32m 35[2mms[22m[39m
       [32mâœ“[39m should provide singleton instance[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should handle rapid successive events[39m[32m 61[2mms[22m[39m
[31m       [31mÃ—[31m should handle mixed event types concurrently[39m[32m 56[2mms[22m[39m
[90mstderr[2m | src/components/InvitationAccept.test.tsx[2m > [22m[2mInvitationAccept[2m > [22m[2mshould show error when getInvitationDetails fails
[22m[39mFailed to load invitation: Error: Failed to load invitation
    at C:/Users/Specter/Desktop/Helix/web/src/components/InvitationAccept.test.tsx:183:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/components/InvitationAccept.test.tsx[2m > [22m[2mInvitationAccept[2m > [22m[2mshould show error when acceptInvitation fails
[22m[39mFailed to accept invitation: Error: Failed to accept invitation
    at C:/Users/Specter/Desktop/Helix/web/src/components/InvitationAccept.test.tsx:196:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/components/InvitationAccept.test.tsx[2m > [22m[2mInvitationAccept[2m > [22m[2mshould show error when rejectInvitation fails
[22m[39mFailed to reject invitation: Error: Failed to reject invitation
    at C:/Users/Specter/Desktop/Helix/web/src/components/InvitationAccept.test.tsx:216:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/components/settings/IntelligenceSettings.test.tsx[2m > [22m[2mIntelligenceSettings[2m > [22m[2mBudget Tab[2m > [22m[2mupdates daily budget value
[22m[39mWarning: Received NaN for the `value` attribute. If this is expected, cast the value to a string.
    at input
    at div
    at div
    at div
    at div
    at IntelligenceSettings (C:/Users/Specter/Desktop/Helix/web/src/components/settings/IntelligenceSettings.tsx:7:73)

 [31mâ¯[39m src/__tests__/CalendarView.test.tsx [2m([22m[2m26 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 937[2mms[22m[39m
[31m       [31mÃ—[31m renders month view by default[39m[32m 42[2mms[22m[39m
       [32mâœ“[39m displays events on correct dates in month view[32m 57[2mms[22m[39m
       [32mâœ“[39m handles navigation buttons[32m 16[2mms[22m[39m
       [32mâœ“[39m renders week view correctly[32m 5[2mms[22m[39m
       [32mâœ“[39m renders day view correctly[32m 48[2mms[22m[39m
       [32mâœ“[39m shows loading state[32m 2[2mms[22m[39m
       [32mâœ“[39m calls onEventClick when event is clicked[32m 13[2mms[22m[39m
       [32mâœ“[39m returns to today when Today button is clicked[32m 37[2mms[22m[39m
       [32mâœ“[39m displays event information[32m 7[2mms[22m[39m
       [32mâœ“[39m displays attendees with status[32m 6[2mms[22m[39m
       [32mâœ“[39m calls onEdit when Edit button is clicked[32m 3[2mms[22m[39m
       [32mâœ“[39m calls onDelete when Delete button is clicked[32m 3[2mms[22m[39m
       [32mâœ“[39m shows loading state on Delete button[32m 5[2mms[22m[39m
       [32mâœ“[39m handles events without attendees[32m 3[2mms[22m[39m
       [32mâœ“[39m handles events with location[32m 2[2mms[22m[39m
       [32mâœ“[39m renders with correct title for new event[32m 9[2mms[22m[39m
       [32mâœ“[39m renders with correct title for editing event[32m 4[2mms[22m[39m
       [32mâœ“[39m populates form with existing event data[32m 4[2mms[22m[39m
       [32mâœ“[39m validates required title field[32m 12[2mms[22m[39m
       [33m[2mâœ“[22m[39m calls onSave with form data on submit [33m 563[2mms[22m[39m
       [32mâœ“[39m closes modal when Close button is clicked[32m 4[2mms[22m[39m
       [32mâœ“[39m closes modal when Cancel button is clicked[32m 3[2mms[22m[39m
       [32mâœ“[39m handles all-day event toggle[32m 66[2mms[22m[39m
       [32mâœ“[39m shows save button text as Create for new event[32m 5[2mms[22m[39m
       [32mâœ“[39m shows save button text as Update for editing event[32m 4[2mms[22m[39m
       [32mâœ“[39m disables submit button while saving[32m 11[2mms[22m[39m
 [31mâ¯[39m src/components/InvitationAccept.test.tsx [2m([22m[2m22 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 920[2mms[22m[39m
     [32mâœ“[39m should render loading state initially[32m 60[2mms[22m[39m
     [32mâœ“[39m should load and display invitation details[32m 13[2mms[22m[39m
     [32mâœ“[39m should display team name from invitation details[32m 7[2mms[22m[39m
     [32mâœ“[39m should display role with description[32m 35[2mms[22m[39m
     [32mâœ“[39m should show role descriptions for each role type[32m 8[2mms[22m[39m
     [32mâœ“[39m should display accept and decline buttons[32m 216[2mms[22m[39m
     [32mâœ“[39m should call acceptInvitation when accept button is clicked[32m 40[2mms[22m[39m
     [32mâœ“[39m should call rejectInvitation when decline button is clicked[32m 34[2mms[22m[39m
     [32mâœ“[39m should show success message after accepting[32m 88[2mms[22m[39m
     [32mâœ“[39m should show success message after declining[32m 72[2mms[22m[39m
     [32mâœ“[39m should show error when invitation not found[32m 32[2mms[22m[39m
     [32mâœ“[39m should show error when getInvitationDetails fails[32m 12[2mms[22m[39m
     [32mâœ“[39m should show error when acceptInvitation fails[32m 30[2mms[22m[39m
     [32mâœ“[39m should show error when rejectInvitation fails[32m 57[2mms[22m[39m
     [32mâœ“[39m should show expired invitation warning[32m 29[2mms[22m[39m
     [32mâœ“[39m should disable accept button when invitation is expired[32m 32[2mms[22m[39m
[31m     [31mÃ—[31m should show error when no token provided[39m[32m 2[2mms[22m[39m
     [32mâœ“[39m should show "Go Home" button on error[32m 13[2mms[22m[39m
     [32mâœ“[39m should disable buttons during acceptance[32m 38[2mms[22m[39m
     [32mâœ“[39m should disable buttons during rejection[32m 32[2mms[22m[39m
     [32mâœ“[39m should display info message about collaboration[32m 24[2mms[22m[39m
     [32mâœ“[39m should format expiration date correctly[32m 38[2mms[22m[39m
[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mMeeting Preparation[2m > [22m[2mprepares meeting for user
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:58:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mMeeting Preparation[2m > [22m[2mincludes relevant emails in context
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:70:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mMeeting Preparation[2m > [22m[2mincludes action items in context
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:79:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mMeeting Preparation[2m > [22m[2mcreates prep task
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:88:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mEmail Extraction[2m > [22m[2mfinds relevant emails from meeting attendees
[22m[39mFailed to find relevant emails: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).gte is not a function
    at MeetingPrepService.findRelevantEmails (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:166:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:104:47
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mEmail Extraction[2m > [22m[2mreturns emails in chronological order
[22m[39mFailed to find relevant emails: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).gte is not a function
    at MeetingPrepService.findRelevantEmails (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:166:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:114:47
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mEmail Extraction[2m > [22m[2mlimits email results to 10
[22m[39mFailed to find relevant emails: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).gte is not a function
    at MeetingPrepService.findRelevantEmails (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:166:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:128:47
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mMeeting Context Storage[2m > [22m[2mretrieves meeting context
[22m[39mFailed to get meeting context: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getMeetingContext (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:348:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:298:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mMeeting Context Storage[2m > [22m[2mreturns null for missing context
[22m[39mFailed to get meeting context: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getMeetingContext (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:348:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:308:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mDiscord Logging[2m > [22m[2mlogs meeting prep generation
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:319:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mDiscord Logging[2m > [22m[2mlogs errors to Discord
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:331:34
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mError Handling[2m > [22m[2mhandles missing event gracefully
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:341:50
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mError Handling[2m > [22m[2mhandles database errors
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:353:34
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/automation-meeting-prep.test.ts[2m > [22m[2mMeetingPrepService[2m > [22m[2mType Safety[2m > [22m[2mreturns MeetingContext with correct structure
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.test.ts:375:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

 [31mâ¯[39m src/services/automation-meeting-prep.test.ts [2m([22m[2m27 tests[22m[2m | [22m[31m6 failed[39m[2m)[22m[32m 39[2mms[22m[39m
       [32mâœ“[39m returns same instance[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m prepares meeting for user[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m includes relevant emails in context[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m includes action items in context[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m creates prep task[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m finds relevant emails from meeting attendees[32m 1[2mms[22m[39m
       [32mâœ“[39m returns emails in chronological order[32m 0[2mms[22m[39m
       [32mâœ“[39m limits email results to 10[32m 1[2mms[22m[39m
       [32mâœ“[39m extracts action items from email content[32m 0[2mms[22m[39m
       [32mâœ“[39m detects action items with keywords[32m 0[2mms[22m[39m
       [32mâœ“[39m handles empty email list[32m 0[2mms[22m[39m
       [32mâœ“[39m generates prep checklist[32m 17[2mms[22m[39m
       [32mâœ“[39m includes meeting title in checklist[32m 0[2mms[22m[39m
       [32mâœ“[39m includes action items in checklist[32m 0[2mms[22m[39m
       [32mâœ“[39m creates prep task with HIGH priority[32m 0[2mms[22m[39m
       [32mâœ“[39m sets task due date to meeting start time[32m 0[2mms[22m[39m
       [32mâœ“[39m includes meeting title in task title[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m saves meeting context[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m retrieves meeting context[32m 1[2mms[22m[39m
       [32mâœ“[39m returns null for missing context[32m 0[2mms[22m[39m
       [32mâœ“[39m logs meeting prep generation[32m 0[2mms[22m[39m
       [32mâœ“[39m logs errors to Discord[32m 0[2mms[22m[39m
       [32mâœ“[39m handles missing event gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m handles database errors[32m 0[2mms[22m[39m
       [32mâœ“[39m continues on partial failures[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m returns MeetingContext with correct structure[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m action items have required fields[32m 0[2mms[22m[39m
 [31mâ¯[39m src/__tests__/VoiceRecorder.test.tsx [2m([22m[2m14 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 1537[2mms[22m[39m
       [32mâœ“[39m initializes with correct default state[32m 11[2mms[22m[39m
       [32mâœ“[39m starts recording when startRecording is called[32m 3[2mms[22m[39m
       [32mâœ“[39m stops recording when stopRecording is called[32m 5[2mms[22m[39m
       [32mâœ“[39m pauses recording[32m 15[2mms[22m[39m
       [32mâœ“[39m resumes recording[32m 34[2mms[22m[39m
[31m       [31mÃ—[31m formats duration correctly[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m gets waveform data[32m 1[2mms[22m[39m
       [32mâœ“[39m resets recording state[32m 8[2mms[22m[39m
       [32mâœ“[39m handles missing microphone permission error[32m 2[2mms[22m[39m
       [32mâœ“[39m renders voice recorder interface[32m 50[2mms[22m[39m
       [32mâœ“[39m displays duration timer[32m 117[2mms[22m[39m
       [32mâœ“[39m shows pause button during recording[32m 127[2mms[22m[39m
       [32mâœ“[39m calls onClose when close button is clicked[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m displays error messages[39m[33m 1151[2mms[22m[39m
 [31mâ¯[39m src/services/autonomy-manager.test.ts [2m([22m[2m19 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 35[2mms[22m[39m
[31m       [31mÃ—[31m should return autonomy settings for user[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should have default values[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should update autonomy level[32m 1[2mms[22m[39m
       [32mâœ“[39m should update feature toggles[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create pending action when approval needed[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should mark high-risk actions as pending[32m 1[2mms[22m[39m
       [32mâœ“[39m should auto-approve low-risk actions at autonomy level 3[32m 1[2mms[22m[39m
       [32mâœ“[39m should approve a pending action[32m 1[2mms[22m[39m
       [32mâœ“[39m should record approval method[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject a pending action[32m 1[2mms[22m[39m
       [32mâœ“[39m should return pending actions for user[32m 1[2mms[22m[39m
       [32mâœ“[39m should return action history with default limit[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect limit parameter[32m 0[2mms[22m[39m
       [32mâœ“[39m should support pagination with offset[32m 0[2mms[22m[39m
       [32mâœ“[39m should always approve high-risk actions[32m 3[2mms[22m[39m
       [32mâœ“[39m should always require approval for dangerous action types[32m 8[2mms[22m[39m
       [32mâœ“[39m should require all approvals at level 0[32m 1[2mms[22m[39m
       [32mâœ“[39m should allow medium-risk without approval at level 2[32m 1[2mms[22m[39m
       [32mâœ“[39m should allow most actions without approval at level 3[32m 1[2mms[22m[39m
[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 2: Calendarâ†’Task Automation[2m > [22m[2mPre-Meeting Preparation[2m > [22m[2mprepares meeting before it starts
[22m[39mFailed to get calendar event: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at MeetingPrepService.getCalendarEvent (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:132:10)
    at MeetingPrepService.prepareMeeting (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:48:32)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:147:43
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 2: Calendarâ†’Task Automation[2m > [22m[2mPre-Meeting Preparation[2m > [22m[2mextracts relevant emails for attendees
[22m[39mFailed to find relevant emails: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).gte is not a function
    at MeetingPrepService.findRelevantEmails (C:/Users/Specter/Desktop/Helix/web/src/services/automation-meeting-prep.ts:166:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:162:42
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

 [31mâ¯[39m src/services/__tests__/smart-scheduling.integration.test.ts [2m([22m[2m24 tests[22m[2m | [22m[31m17 failed[39m[2m)[22m[32m 51[2mms[22m[39m
[31m       [31mÃ—[31m finds suitable times for multiple attendees[39m[32m 8[2mms[22m[39m
[31m       [31mÃ—[31m respects attendee count in scoring[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m returns sorted suggestions by quality score[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m avoids times with calendar conflicts[32m 0[2mms[22m[39m
       [32mâœ“[39m detects overlapping events[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m scores morning slots higher[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m includes time of day bonus in scoring[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m includes day of week scoring[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m penalizes excessive attendees[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m respects preferred meeting times[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m avoids blocked times[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m finds slots for 30-minute meetings[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m finds slots for 2-hour meetings[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m enforces minimum 15-minute duration[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m respects date range boundaries[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m handles narrow date ranges[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m handles wide date ranges[39m[32m 25[2mms[22m[39m
[31m       [31mÃ—[31m selects best time from suggestions[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m handles empty attendee list[32m 0[2mms[22m[39m
       [32mâœ“[39m handles invalid email addresses gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m handles inverted date ranges[32m 0[2mms[22m[39m
       [32mâœ“[39m completes scheduling within reasonable time[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m handles large attendee lists[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m returns properly typed suggestion[39m[32m 1[2mms[22m[39m
[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 4: Learning Engine[2m > [22m[2manalyzes automation execution patterns
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:288:45
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 4: Learning Engine[2m > [22m[2msuggests new automations based on patterns
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at AutomationLearningEngine.suggestNewAutomations (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:138:35)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:301:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 4: Learning Engine[2m > [22m[2midentifies high-performing patterns
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at AutomationLearningEngine.getHighPerformingPatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:272:35)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:309:45
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 4: Learning Engine[2m > [22m[2mgenerates learning report
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at AutomationLearningEngine.getLearningReport (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:299:35)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:320:43
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mTrack 4: Learning Engine[2m > [22m[2mgenerates learning report
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at AutomationLearningEngine.suggestNewAutomations (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:138:35)
    at AutomationLearningEngine.getLearningReport (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:300:38)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:320:22
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mCross-Track Integration[2m > [22m[2mlearning engine observes all automation types
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:375:45
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mCross-Track Integration[2m > [22m[2mlearning engine observes all automation types
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at AutomationLearningEngine.suggestNewAutomations (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:138:35)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:378:48
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/__tests__/phase7-e2e.test.ts[2m > [22m[2mPhase 7 End-to-End Automation Workflows[2m > [22m[2mError Recovery[2m > [22m[2mhandles missing data gracefully
[22m[39mFailed to get execution history: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).order is not a function
    at AutomationLearningEngine.getExecutionHistory (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:205:10)
    at AutomationLearningEngine.analyzePatterns (C:/Users/Specter/Desktop/Helix/web/src/services/automation-learning.ts:35:37)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/phase7-e2e.test.ts:491:45
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

 [31mâ¯[39m src/services/__tests__/phase7-e2e.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m14 failed[39m[2m)[22m[32m 48[2mms[22m[39m
[31m       [31mÃ—[31m creates task from incoming email matching rule[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m respects email from filter[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m substitutes template variables in task title[39m[32m 1[2mms[22m[39m
[31m         [31mÃ—[31m prepares meeting before it starts[39m[32m 2[2mms[22m[39m
         [32mâœ“[39m extracts relevant emails for attendees[32m 1[2mms[22m[39m
         [32mâœ“[39m generates meeting prep checklist[32m 17[2mms[22m[39m
         [32mâœ“[39m extracts action items from meeting notes[32m 1[2mms[22m[39m
         [32mâœ“[39m creates tasks from extracted action items[32m 0[2mms[22m[39m
         [32mâœ“[39m generates summary email for meeting[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m finds best meeting times for multiple attendees[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m scores time slots based on multiple factors[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m respects time preferences[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m analyzes automation execution patterns[32m 1[2mms[22m[39m
       [32mâœ“[39m suggests new automations based on patterns[32m 1[2mms[22m[39m
       [32mâœ“[39m identifies high-performing patterns[32m 1[2mms[22m[39m
       [32mâœ“[39m generates learning report[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m orchestrator manages all automation types[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m multiple triggers can fire in sequence[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m learning engine observes all automation types[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m executes full automation lifecycle[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m handles complex multi-step workflows[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m continues workflow on partial failures[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m handles missing data gracefully[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m handles concurrent automation executions[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m maintains data consistency across workflows[39m[32m 0[2mms[22m[39m
 [31mâ¯[39m src/components/TeamMemberCard.test.tsx [2m([22m[2m16 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 1804[2mms[22m[39m
     [32mâœ“[39m should render member card with email and role[32m 160[2mms[22m[39m
[31m     [31mÃ—[31m should display role badges with correct colors[39m[32m 9[2mms[22m[39m
     [32mâœ“[39m should show "You" badge for current user[32m 7[2mms[22m[39m
     [32mâœ“[39m should show menu button when can manage[32m 252[2mms[22m[39m
     [32mâœ“[39m should not show menu button when cannot manage[32m 6[2mms[22m[39m
     [32mâœ“[39m should not show menu button for owner even when can manage[32m 3[2mms[22m[39m
     [32mâœ“[39m should not show menu button for current user[32m 3[2mms[22m[39m
     [32mâœ“[39m should toggle menu visibility on button click[32m 25[2mms[22m[39m
[31m     [31mÃ—[31m should show role options in submenu[39m[33m 1116[2mms[22m[39m
     [32mâœ“[39m should disable current role in role submenu[32m 27[2mms[22m[39m
     [32mâœ“[39m should call onChangeRole when new role is selected[32m 31[2mms[22m[39m
     [32mâœ“[39m should call onRemove when remove member is clicked[32m 17[2mms[22m[39m
     [32mâœ“[39m should show loading state during action[32m 43[2mms[22m[39m
     [32mâœ“[39m should format joined date correctly[32m 3[2mms[22m[39m
     [32mâœ“[39m should close menu after role change[32m 59[2mms[22m[39m
     [32mâœ“[39m should close menu after remove[32m 39[2mms[22m[39m
[90mstderr[2m | src/services/scheduling/cron-scheduler.test.ts[2m > [22m[2mCronScheduler[2m > [22m[2mNext Execution Calculation[2m > [22m[2mshould handle minute-based schedules
[22m[39mFailed to schedule job test-3: RangeError: Invalid time value
    at ClockDate.toISOString (<anonymous>)
    at CronScheduler.scheduleJob (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/cron-scheduler.ts:102:46)
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/cron-scheduler.test.ts:125:23
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/scheduling/cron-scheduler.test.ts[2m > [22m[2mCronScheduler[2m > [22m[2mError Handling[2m > [22m[2mshould handle invalid cron expressions
[22m[39mInvalid cron expression: invalid cron expression

[90mstderr[2m | src/services/scheduling/cron-scheduler.test.ts[2m > [22m[2mCronScheduler[2m > [22m[2mMultiple Operations[2m > [22m[2mshould initialize all schedules for a user
[22m[39mInvalid cron expression: undefined

 [31mâ¯[39m src/services/scheduling/cron-scheduler.test.ts [2m([22m[2m20 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 28[2mms[22m[39m
       [32mâœ“[39m should create a basic schedule[32m 4[2mms[22m[39m
       [32mâœ“[39m should handle email composition schedule[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle task prioritization schedule[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should calculate next execution for daily schedule[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m should schedule for next day if time passed[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle minute-based schedules[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should cancel a scheduled job[32m 1[2mms[22m[39m
       [32mâœ“[39m should disable all schedules for a user[32m 1[2mms[22m[39m
       [32mâœ“[39m should track cost for executed operations[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect maximum cost per month limit[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle invalid cron expressions[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle network errors gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle disabled schedules[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle UTC timezone[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle US Eastern timezone[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle Asia/Tokyo timezone[32m 1[2mms[22m[39m
       [32mâœ“[39m should fetch execution history for a schedule[32m 1[2mms[22m[39m
       [32mâœ“[39m should limit execution history results[32m 1[2mms[22m[39m
       [32mâœ“[39m should schedule multiple different operations[32m 1[2mms[22m[39m
       [32mâœ“[39m should initialize all schedules for a user[32m 1[2mms[22m[39m
[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mdetectAgentProposals[2m > [22m[2mshould detect agent proposals from conversation patterns
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:81:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mdetectAgentProposals[2m > [22m[2mshould return empty array for users with no conversations
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:87:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mdetectAgentProposals[2m > [22m[2mshould create proposals with detected patterns
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:93:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mpattern analysis[2m > [22m[2mshould identify topic clusters from conversations
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:108:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mpattern analysis[2m > [22m[2mshould calculate frequency correctly
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:116:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mpattern analysis[2m > [22m[2mshould set confidence based on frequency
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:126:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal filtering[2m > [22m[2mshould not propose agents for topics below frequency threshold
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:139:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal filtering[2m > [22m[2mshould exclude existing agent roles from proposals
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:149:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal status[2m > [22m[2mshould mark all proposals as pending
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:157:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal status[2m > [22m[2mshould generate unique proposal IDs
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:165:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal status[2m > [22m[2mshould include user_id in proposals
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:172:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2merror handling[2m > [22m[2mshould return empty array on fetch error
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:182:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2merror handling[2m > [22m[2mshould not throw on pattern analysis errors
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:188:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal content validation[2m > [22m[2mshould include detailed pattern information
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:196:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal content validation[2m > [22m[2mshould format proposal names with capitalization
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:208:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/pattern-detection.test.ts[2m > [22m[2mPatternDetectionService[2m > [22m[2mproposal content validation[2m > [22m[2mshould include human-readable reason
[22m[39mFailed to detect agent proposals: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:64:16
    at Array.map (<anonymous>)
    at PatternDetectionService.detectAgentProposals (C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.ts:63:52)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/pattern-detection.test.ts:217:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/services/pattern-detection.test.ts [2m([22m[2m16 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 25[2mms[22m[39m
       [32mâœ“[39m should detect agent proposals from conversation patterns[32m 6[2mms[22m[39m
       [32mâœ“[39m should return empty array for users with no conversations[32m 1[2mms[22m[39m
       [32mâœ“[39m should create proposals with detected patterns[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should identify topic clusters from conversations[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should calculate frequency correctly[32m 1[2mms[22m[39m
       [32mâœ“[39m should set confidence based on frequency[32m 1[2mms[22m[39m
       [32mâœ“[39m should not propose agents for topics below frequency threshold[32m 1[2mms[22m[39m
       [32mâœ“[39m should exclude existing agent roles from proposals[32m 1[2mms[22m[39m
       [32mâœ“[39m should mark all proposals as pending[32m 1[2mms[22m[39m
       [32mâœ“[39m should generate unique proposal IDs[32m 1[2mms[22m[39m
       [32mâœ“[39m should include user_id in proposals[32m 1[2mms[22m[39m
       [32mâœ“[39m should return empty array on fetch error[32m 1[2mms[22m[39m
       [32mâœ“[39m should not throw on pattern analysis errors[32m 2[2mms[22m[39m
       [32mâœ“[39m should include detailed pattern information[32m 1[2mms[22m[39m
       [32mâœ“[39m should format proposal names with capitalization[32m 1[2mms[22m[39m
       [32mâœ“[39m should include human-readable reason[32m 1[2mms[22m[39m
[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould generate 768-dimensional embedding
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:14:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:14:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould be normalized (magnitude close to 1)
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:24:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:24:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould throw on empty text
[22m[39mFailed to generate embedding: Error: Text input cannot be empty
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:13:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:31:28
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould throw on whitespace-only text
[22m[39mFailed to generate embedding: Error: Text input cannot be empty
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:13:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:37:28
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould generate different embeddings for different texts
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:46:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:46:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould handle long text
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:59:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:59:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateEmbedding[2m > [22m[2mshould be consistent (same text produces same embedding)
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:68:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:68:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateBatchEmbeddings[2m > [22m[2mshould generate embeddings for multiple texts
[22m[39mFailed to generate batch embeddings: TypeError: Failed to parse URL from /api/embedding/batch
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateBatchEmbeddings (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:66:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:84:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateBatchEmbeddings (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:66:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:84:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding/batch'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateBatchEmbeddings[2m > [22m[2mshould throw on empty array
[22m[39mFailed to generate batch embeddings: Error: Texts array cannot be empty
    at EmbeddingService.generateBatchEmbeddings (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:59:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:95:28
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateBatchEmbeddings[2m > [22m[2mshould throw if any text is empty
[22m[39mFailed to generate batch embeddings: Error: All texts must be non-empty
    at EmbeddingService.generateBatchEmbeddings (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:63:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:103:28
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mgenerateBatchEmbeddings[2m > [22m[2mshould preserve order of embeddings
[22m[39mFailed to generate batch embeddings: TypeError: Failed to parse URL from /api/embedding/batch
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateBatchEmbeddings (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:66:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:111:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateBatchEmbeddings (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:66:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:111:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding/batch'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mvalidateEmbedding[2m > [22m[2mshould validate correct embedding
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:127:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:127:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mcalculateMagnitude[2m > [22m[2mshould calculate magnitude of normalized embedding
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:162:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:162:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mcosineSimilarity[2m > [22m[2mshould return 1 for identical embeddings
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:186:25
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:186:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mcosineSimilarity[2m > [22m[2mshould handle different embeddings
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:196:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:196:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mcosineSimilarity[2m > [22m[2mshould throw on dimension mismatch
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:207:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:207:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/embedding.test.ts[2m > [22m[2mEmbeddingService[2m > [22m[2mcosineSimilarity[2m > [22m[2mshould be commutative
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:219:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/embedding.test.ts:219:40
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

 [31mâ¯[39m src/services/__tests__/embedding.test.ts [2m([22m[2m24 tests[22m[2m | [22m[31m13 failed[39m[2m)[22m[32m 27[2mms[22m[39m
[31m       [31mÃ—[31m should generate 768-dimensional embedding[39m[32m 8[2mms[22m[39m
[31m       [31mÃ—[31m should be normalized (magnitude close to 1)[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw on empty text[32m 2[2mms[22m[39m
       [32mâœ“[39m should throw on whitespace-only text[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should generate different embeddings for different texts[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle long text[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should be consistent (same text produces same embedding)[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should generate embeddings for multiple texts[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw on empty array[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw if any text is empty[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should preserve order of embeddings[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should validate correct embedding[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject wrong dimension[32m 0[2mms[22m[39m
       [32mâœ“[39m should reject non-array[32m 0[2mms[22m[39m
       [32mâœ“[39m should reject NaN values[32m 0[2mms[22m[39m
       [32mâœ“[39m should reject non-numeric values[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should calculate magnitude of normalized embedding[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate magnitude of zero vector[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate magnitude of unit vector[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return 1 for identical embeddings[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle different embeddings[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should throw on dimension mismatch[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should be commutative[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should return 0 for orthogonal vectors[32m 1[2mms[22m[39m
 [31mâ¯[39m src/services/__tests__/email-compose.test.ts [2m([22m[2m26 tests[22m[2m | [22m[31m16 failed[39m[2m)[22m[32m 33[2mms[22m[39m
       [32mâœ“[39m should create a new draft[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should save draft with partial updates (upsert)[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should get draft by ID[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should list drafts with limit[32m 0[2mms[22m[39m
       [32mâœ“[39m should delete draft[32m 0[2mms[22m[39m
       [32mâœ“[39m should get all templates[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should create template[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should apply template to draft[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should delete template[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should track template usage[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should get signatures for account[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should get default signature[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should create signature[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should insert signature into draft[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should delete signature[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should validate email format[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject invalid email format[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should validate required fields[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should handle RFC 5321 compliance[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should allow multiple recipients[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should schedule send with future time[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject past time[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should cancel scheduled send[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle timezone[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support partial draft updates[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should not lose data on rapid saves[39m[32m 2[2mms[22m[39m
[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mComponent Health Checks[2m > [22m[2mshould mark component as down on fetch error
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:59:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:59:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mComponent Health Checks[2m > [22m[2mshould mark component as degraded on non-ok response
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:73:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:73:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mOverall Status Calculation[2m > [22m[2mshould return operational when all components are operational
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:87:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:87:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mOverall Status Calculation[2m > [22m[2mshould return major_outage when API gateway is down
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:107:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:107:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mOverall Status Calculation[2m > [22m[2mshould return degraded when any component degraded
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:130:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:130:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mStatus Caching[2m > [22m[2mshould cache status
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:145:37
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:145:37
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mStatus Caching[2m > [22m[2mshould cache status
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:148:37
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:148:37
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mUptime Calculation[2m > [22m[2mshould calculate 90-day uptime
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:162:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:162:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mIncident History[2m > [22m[2mshould fetch recent incidents
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:177:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:177:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mIncident History[2m > [22m[2mshould include incident details
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:189:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:189:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mComponent Status Properties[2m > [22m[2mshould include last check timestamp
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:277:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:277:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mComponent Status Properties[2m > [22m[2mshould include latency for all components
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:290:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:290:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mStatus Response Structure[2m > [22m[2mshould include required fields
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:307:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:307:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mStatus Response Structure[2m > [22m[2mshould have all component checks
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:324:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:324:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mError Handling[2m > [22m[2mshould handle fetch errors gracefully
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:338:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:338:36
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstderr[2m | src/services/status/status-service.test.ts[2m > [22m[2mStatusService[2m > [22m[2mError Handling[2m > [22m[2mshould not throw on service errors
[22m[39m[StatusService] Failed to get incidents: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.getRecentIncidents (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:210:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:47:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:348:23
    at Proxy.assertThrows [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:2798:5[90m)[39m
    at Proxy.methodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1700:25[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1149:12[90m)[39m
    at Proxy.overwritingMethodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1750:33[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1485:16[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1090:14[90m)[39m
    at Proxy.methodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1700:25[90m)[39m
[StatusService] Failed to calculate uptime: TypeError: (0 , __vite_ssr_import_0__.getDb)(...).from(...).select(...).gte is not a function
    at StatusService.calculate90DayUptime (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:189:10)
    at StatusService.getStatus (C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.ts:48:14)
    at C:/Users/Specter/Desktop/Helix/web/src/services/status/status-service.test.ts:348:23
    at Proxy.assertThrows [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:2798:5[90m)[39m
    at Proxy.methodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1700:25[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1149:12[90m)[39m
    at Proxy.overwritingMethodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1750:33[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1485:16[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1090:14[90m)[39m
    at Proxy.methodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1700:25[90m)[39m

 [31mâ¯[39m src/services/status/status-service.test.ts [2m([22m[2m24 tests[22m[2m | [22m[31m13 failed[39m[2m)[22m[33m 2600[2mms[22m[39m
       [32mâœ“[39m should check API gateway status[32m 7[2mms[22m[39m
       [33m[2mâœ“[22m[39m should mark component as degraded when latency > 2000ms [33m 2509[2mms[22m[39m
       [32mâœ“[39m should mark component as down on fetch error[32m 3[2mms[22m[39m
       [32mâœ“[39m should mark component as degraded on non-ok response[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should return operational when all components are operational[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m should return major_outage when API gateway is down[32m 2[2mms[22m[39m
       [32mâœ“[39m should return degraded when any component degraded[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should cache status[39m[32m 7[2mms[22m[39m
       [32mâœ“[39m should calculate 90-day uptime[32m 7[2mms[22m[39m
       [32mâœ“[39m should fetch recent incidents[32m 2[2mms[22m[39m
       [32mâœ“[39m should include incident details[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should return 30-day uptime breakdown[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should have uptime in valid range[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should have incident counts[39m[32m 35[2mms[22m[39m
[31m       [31mÃ—[31m should return unsubscribe function[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return status history for specified days[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return valid status values[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should default to 90 days[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should include last check timestamp[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should include latency for all components[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should include required fields[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should have all component checks[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle fetch errors gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m should not throw on service errors[32m 2[2mms[22m[39m
[90mstdout[2m | src/components/settings/IntelligenceSettings.test.tsx[2m > [22m[2mIntelligenceSettings[2m > [22m[2mSave Functionality[2m > [22m[2msends save request with operation and budget settings
[22m[39mSettings saved successfully

[90mstdout[2m | src/components/settings/IntelligenceSettings.test.tsx[2m > [22m[2mIntelligenceSettings[2m > [22m[2mSave Functionality[2m > [22m[2mdisables save button while saving
[22m[39mSettings saved successfully

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mService Worker Registration[2m > [22m[2mshould register service worker successfully
[22m[39m[PWA] Service Worker registered successfully

[90mstderr[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mService Worker Registration[2m > [22m[2mshould handle service worker registration failure
[22m[39m[PWA] Service Worker registration failed: Error: SW registration failed
    at C:/Users/Specter/Desktop/Helix/web/src/utils/__tests__/pwa-setup.test.ts:74:21
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mService Worker Registration[2m > [22m[2mshould return null if service workers not supported
[22m[39m[PWA] Service Worker registration failed: TypeError: Cannot read properties of undefined (reading 'register')
    at setupPWA (C:/Users/Specter/Desktop/Helix/web/src/utils/pwa-setup.ts:20:56)
    at C:/Users/Specter/Desktop/Helix/web/src/utils/__tests__/pwa-setup.test.ts:88:28
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mCache Management[2m > [22m[2mshould clear all caches
[22m[39m[PWA] All caches cleared

[90mstderr[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mCache Management[2m > [22m[2mshould handle cache clear failure gracefully
[22m[39m[PWA] Failed to clear caches: Error: Cache error
    at C:/Users/Specter/Desktop/Helix/web/src/utils/__tests__/pwa-setup.test.ts:171:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mService Worker Unregistration[2m > [22m[2mshould unregister all service workers
[22m[39m[PWA] All service workers unregistered

[90mstderr[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mService Worker Unregistration[2m > [22m[2mshould handle unregistration failure gracefully
[22m[39m[PWA] Failed to unregister service workers: Error: Failed to get registrations
    at C:/Users/Specter/Desktop/Helix/web/src/utils/__tests__/pwa-setup.test.ts:199:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mInstall Prompt[2m > [22m[2mshould track appinstalled event
[22m[39m[PWA] App installed
[PWA] App installed

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mFull Initialization[2m > [22m[2mshould initialize all PWA features
[22m[39m[PWA] Initializing PWA features

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mFull Initialization[2m > [22m[2mshould initialize all PWA features
[22m[39m[PWA] Service Worker registered successfully

[90mstdout[2m | src/utils/__tests__/pwa-setup.test.ts[2m > [22m[2mPWA Setup[2m > [22m[2mFull Initialization[2m > [22m[2mshould initialize all PWA features
[22m[39m[PWA] Initialization complete
[PWA] Running standalone: false
[PWA] Currently online: true

 [31mâ¯[39m src/utils/__tests__/pwa-setup.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 25[2mms[22m[39m
[31m       [31mÃ—[31m should register service worker successfully[39m[32m 11[2mms[22m[39m
[31m       [31mÃ—[31m should handle service worker registration failure[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should return null if service workers not supported[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect online status[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect offline status[32m 0[2mms[22m[39m
       [32mâœ“[39m should setup online status listener[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect standalone mode (installed)[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect non-standalone mode[32m 0[2mms[22m[39m
       [32mâœ“[39m should clear all caches[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle cache clear failure gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m should unregister all service workers[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle unregistration failure gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m should check if app is installable[32m 0[2mms[22m[39m
       [32mâœ“[39m should return false if app not installed[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle getInstalledRelatedApps gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should setup install prompt listener[32m 0[2mms[22m[39m
       [32mâœ“[39m should track appinstalled event[32m 0[2mms[22m[39m
       [32mâœ“[39m should initialize all PWA features[32m 1[2mms[22m[39m
       [32mâœ“[39m should dispatch online status change event[32m 0[2mms[22m[39m
       [32mâœ“[39m should cache important assets on install[32m 1[2mms[22m[39m
       [32mâœ“[39m should identify API patterns for network-first caching[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify static assets for cache-first caching[32m 0[2mms[22m[39m
[90mstderr[2m | src/services/alerting/alert-engine.test.ts
[22m[39mSupabase credentials not found. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file.

 [31mâ¯[39m src/services/alerting/alert-engine.test.ts [2m([22m[2m42 tests[22m[2m | [22m[31m42 failed[39m[2m)[22m[32m 24[2mms[22m[39m
[31m       [31mÃ—[31m should create a new alert rule[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should support multiple alert channels[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should evaluate greater than operator[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should evaluate less than operator[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should evaluate between operator[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should evaluate equals operator[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should evaluate not equals operator[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should add metrics snapshot[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should buffer multiple snapshots[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should clean up old snapshots beyond 24 hours[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should parse 5 minute window[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should parse 15 minute window[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should parse 1 hour window[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should parse 24 hour window[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should respect cooldown period[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should allow alert after cooldown expires[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support info severity[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support warning severity[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support critical severity[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support Discord channel[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support email channel[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support SMS channel[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support in-app channel[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support error_rate metric[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support latency_p95 metric[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support cost_spike metric[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support sla_violation metric[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support budget_exceeded metric[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support operation_failure_rate metric[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should start evaluation loop[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should stop evaluation loop[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should not double-start evaluation loop[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should acknowledge an alert[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should resolve an alert[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should get rules for a user[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should update an alert rule[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should delete an alert rule[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should provide singleton instance[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create high error rate alert (> 5% in 5 min)[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create high latency alert (> 2000ms in 15 min)[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create cost spike alert (> 120% in 1h)[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create budget exceeded alert[39m[32m 0[2mms[22m[39m
[90mstdout[2m | src/components/settings/IntelligenceSettings.test.tsx[2m > [22m[2mIntelligenceSettings[2m > [22m[2mSave Functionality[2m > [22m[2mshows last saved timestamp
[22m[39mSettings saved successfully

 [31mâ¯[39m src/services/automation-smart-scheduling.test.ts [2m([22m[2m32 tests[22m[2m | [22m[31m19 failed[39m[2m)[22m[32m 28[2mms[22m[39m
       [32mâœ“[39m returns same instance[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m finds best meeting times for single attendee[39m[32m 7[2mms[22m[39m
[31m       [31mÃ—[31m finds best meeting times for multiple attendees[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m respects duration parameter[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m returns empty array when no slots available[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m calculates free slots[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m handles multiple calendar entries[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m respects duration in slot calculation[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m detects no conflict when slot is free[32m 0[2mms[22m[39m
       [32mâœ“[39m detects conflict with overlapping event[32m 0[2mms[22m[39m
       [32mâœ“[39m detects no conflict with adjacent events[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m scores morning slots high[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m scores lunch time low[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m includes score breakdown[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m penalizes high attendee counts[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m respects user preferences[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m generates scheduling suggestion[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m returns sorted suggestions by score[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m limits suggestions to top 5[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m includes best time separately[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m fetches calendars for all attendees[32m 0[2mms[22m[39m
       [32mâœ“[39m handles invalid attendee emails gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m returns empty calendar for attendee with no events[32m 0[2mms[22m[39m
       [32mâœ“[39m logs scheduling calculation[32m 1[2mms[22m[39m
       [32mâœ“[39m logs errors to Discord[32m 0[2mms[22m[39m
       [32mâœ“[39m handles no attendees gracefully[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m handles invalid date range[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m handles very short duration[32m 1[2mms[22m[39m
       [32mâœ“[39m handles very long duration[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m returns SchedulingSuggestion with correct structure[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m time slots have required fields[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m score breakdown is complete[32m 0[2mms[22m[39m
[90mstderr[2m | src/components/settings/IntelligenceSettings.test.tsx[2m > [22m[2mIntelligenceSettings[2m > [22m[2mError Handling[2m > [22m[2mhandles fetch errors gracefully
[22m[39mFailed to load operations: Error: Network error
    at C:/Users/Specter/Desktop/Helix/web/src/components/settings/IntelligenceSettings.test.tsx:390:47
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m
Failed to load settings: Error: Network error
    at C:/Users/Specter/Desktop/Helix/web/src/components/settings/IntelligenceSettings.test.tsx:390:47
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/services/automation-post-meeting.test.ts[2m > [22m[2mPostMeetingFollowupService[2m > [22m[2mFollowup Retrieval[2m > [22m[2mretrieves created tasks for meeting
[22m[39mFailed to get post-meeting follow-up: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at PostMeetingFollowupService.getPostMeetingFollowup (C:/Users/Specter/Desktop/Helix/web/src/services/automation-post-meeting.ts:374:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-post-meeting.test.ts:336:46
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-post-meeting.test.ts[2m > [22m[2mPostMeetingFollowupService[2m > [22m[2mFollowup Retrieval[2m > [22m[2mreturns empty array for meeting with no followups
[22m[39mFailed to get post-meeting follow-up: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function
    at PostMeetingFollowupService.getPostMeetingFollowup (C:/Users/Specter/Desktop/Helix/web/src/services/automation-post-meeting.ts:374:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-post-meeting.test.ts:345:46
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

 [31mâ¯[39m src/services/automation-post-meeting.test.ts [2m([22m[2m37 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 20[2mms[22m[39m
       [32mâœ“[39m returns same instance[32m 1[2mms[22m[39m
       [32mâœ“[39m creates followup from meeting notes[32m 2[2mms[22m[39m
       [32mâœ“[39m handles empty notes gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m processes meeting transcript[32m 0[2mms[22m[39m
       [32mâœ“[39m extracts action items from natural text[32m 0[2mms[22m[39m
       [32mâœ“[39m detects action items with "- action:" pattern[32m 0[2mms[22m[39m
       [32mâœ“[39m detects action items with imperative verbs[32m 0[2mms[22m[39m
       [32mâœ“[39m extracts assignee from mention[32m 0[2mms[22m[39m
       [32mâœ“[39m handles action items without assignee[32m 0[2mms[22m[39m
       [32mâœ“[39m infers HIGH priority for urgent keywords[32m 1[2mms[22m[39m
       [32mâœ“[39m infers NORMAL priority for important keywords[32m 0[2mms[22m[39m
       [32mâœ“[39m defaults to NORMAL priority[32m 0[2mms[22m[39m
       [32mâœ“[39m calculates confidence score[32m 0[2mms[22m[39m
       [32mâœ“[39m higher confidence with clear action items[32m 0[2mms[22m[39m
       [32mâœ“[39m extracts due date from text[32m 0[2mms[22m[39m
       [32mâœ“[39m parses relative dates[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m parses explicit dates[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m returns null for no due date[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m extracts assignee from @ mention[32m 0[2mms[22m[39m
       [32mâœ“[39m extracts assignee from name at line start[32m 0[2mms[22m[39m
       [32mâœ“[39m returns null when no assignee found[32m 0[2mms[22m[39m
       [32mâœ“[39m creates task for action item[32m 0[2mms[22m[39m
       [32mâœ“[39m sets task priority from action item[32m 0[2mms[22m[39m
       [32mâœ“[39m sets task due date from action item[32m 0[2mms[22m[39m
       [32mâœ“[39m creates multiple tasks for multiple action items[32m 0[2mms[22m[39m
       [32mâœ“[39m generates summary email[32m 0[2mms[22m[39m
       [32mâœ“[39m includes action items in summary[32m 0[2mms[22m[39m
       [32mâœ“[39m includes created task IDs in summary[32m 0[2mms[22m[39m
       [32mâœ“[39m retrieves created tasks for meeting[32m 2[2mms[22m[39m
       [32mâœ“[39m returns empty array for meeting with no followups[32m 1[2mms[22m[39m
       [32mâœ“[39m logs followup creation[32m 0[2mms[22m[39m
       [32mâœ“[39m logs errors to Discord[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m handles invalid dates gracefully[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m continues on partial extraction failures[32m 0[2mms[22m[39m
       [32mâœ“[39m handles empty action item list[32m 0[2mms[22m[39m
       [32mâœ“[39m returns string array from createPostMeetingFollowup[32m 0[2mms[22m[39m
       [32mâœ“[39m action items have required properties[32m 0[2mms[22m[39m
[90mstdout[2m | src/components/settings/IntelligenceSettings.test.tsx[2m > [22m[2mIntelligenceSettings[2m > [22m[2mIntegration[2m > [22m[2mcompletes full workflow: load, modify, save
[22m[39mSettings saved successfully

 [31mâ¯[39m src/services/email-intelligence.test.ts [2m([22m[2m74 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 25[2mms[22m[39m
         [32mâœ“[39m composes email with all required fields[32m 1[2mms[22m[39m
         [32mâœ“[39m returns composed email content[32m 0[2mms[22m[39m
         [32mâœ“[39m returns subject line[32m 0[2mms[22m[39m
         [32mâœ“[39m calculates token count[32m 0[2mms[22m[39m
         [32mâœ“[39m returns confidence score[32m 0[2mms[22m[39m
         [32mâœ“[39m provides composition suggestions[32m 0[2mms[22m[39m
         [32mâœ“[39m composes professional tone emails[32m 0[2mms[22m[39m
         [32mâœ“[39m composes casual tone emails[32m 0[2mms[22m[39m
         [32mâœ“[39m composes formal tone emails[32m 0[2mms[22m[39m
         [32mâœ“[39m defaults to professional tone when not specified[32m 0[2mms[22m[39m
         [32mâœ“[39m uses context when provided[32m 0[2mms[22m[39m
         [32mâœ“[39m composes without context[32m 0[2mms[22m[39m
         [32mâœ“[39m uses meeting notes as context[32m 0[2mms[22m[39m
         [32mâœ“[39m uses previous email chain as context[32m 0[2mms[22m[39m
         [32mâœ“[39m respects maxLength parameter[32m 0[2mms[22m[39m
         [32mâœ“[39m defaults to 500 characters when maxLength not specified[32m 0[2mms[22m[39m
         [32mâœ“[39m handles very short max length[32m 0[2mms[22m[39m
         [32mâœ“[39m handles very long max length[32m 0[2mms[22m[39m
         [32mâœ“[39m includes recipient email in composition[32m 0[2mms[22m[39m
         [32mâœ“[39m handles different recipient email formats[32m 0[2mms[22m[39m
         [32mâœ“[39m logs successful composition to Discord[32m 0[2mms[22m[39m
         [32mâœ“[39m logs composition to hash chain[32m 0[2mms[22m[39m
         [32mâœ“[39m includes latency in logs[32m 0[2mms[22m[39m
         [32mâœ“[39m classifies email with all fields[32m 0[2mms[22m[39m
         [32mâœ“[39m returns priority level[32m 1[2mms[22m[39m
         [32mâœ“[39m returns category[32m 0[2mms[22m[39m
         [32mâœ“[39m returns suggested action[32m 0[2mms[22m[39m
         [32mâœ“[39m indicates if response is required[32m 0[2mms[22m[39m
         [32mâœ“[39m returns confidence score[32m 0[2mms[22m[39m
         [32mâœ“[39m sets response deadline when required[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m classifies urgent emails as high priority[39m[32m 6[2mms[22m[39m
         [32mâœ“[39m classifies important emails as medium priority[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m classifies promotional emails as low priority[39m[32m 1[2mms[22m[39m
         [32mâœ“[39m categorizes work emails[32m 0[2mms[22m[39m
         [32mâœ“[39m categorizes personal emails[32m 0[2mms[22m[39m
         [32mâœ“[39m categorizes promotional emails[32m 0[2mms[22m[39m
         [32mâœ“[39m categorizes system/notification emails[32m 0[2mms[22m[39m
         [32mâœ“[39m detects when response is required[32m 0[2mms[22m[39m
         [32mâœ“[39m detects when response is not required[32m 0[2mms[22m[39m
         [32mâœ“[39m sets realistic deadline for responses[32m 0[2mms[22m[39m
         [32mâœ“[39m classifies without sender information[32m 0[2mms[22m[39m
         [32mâœ“[39m logs classification to Discord[32m 0[2mms[22m[39m
         [32mâœ“[39m logs to hash chain[32m 0[2mms[22m[39m
         [32mâœ“[39m generates acknowledge responses[32m 0[2mms[22m[39m
         [32mâœ“[39m generates approve responses[32m 0[2mms[22m[39m
         [32mâœ“[39m generates decline responses[32m 0[2mms[22m[39m
         [32mâœ“[39m generates info request responses[32m 0[2mms[22m[39m
         [32mâœ“[39m returns response with confidence score[32m 0[2mms[22m[39m
         [32mâœ“[39m specifies response tone[32m 0[2mms[22m[39m
         [32mâœ“[39m estimates token usage[32m 0[2mms[22m[39m
         [32mâœ“[39m generates concise responses[32m 0[2mms[22m[39m
         [32mâœ“[39m uses additional context when provided[32m 0[2mms[22m[39m
         [32mâœ“[39m generates response without additional context[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m acknowledge response confirms receipt[39m[32m 1[2mms[22m[39m
         [32mâœ“[39m approve response indicates agreement[32m 0[2mms[22m[39m
         [32mâœ“[39m decline response is polite and professional[32m 0[2mms[22m[39m
         [32mâœ“[39m request_info response asks clarifying questions[32m 0[2mms[22m[39m
         [32mâœ“[39m logs response generation to Discord[32m 0[2mms[22m[39m
         [32mâœ“[39m logs to hash chain[32m 0[2mms[22m[39m
       [32mâœ“[39m classifies multiple emails in batch[32m 0[2mms[22m[39m
       [32mâœ“[39m continues processing even if one email fails[32m 0[2mms[22m[39m
       [32mâœ“[39m returns correct count of processed emails[32m 0[2mms[22m[39m
       [32mâœ“[39m analyzes email conversation thread[32m 0[2mms[22m[39m
       [32mâœ“[39m identifies action items from thread[32m 0[2mms[22m[39m
       [32mâœ“[39m detects thread sentiment[32m 0[2mms[22m[39m
       [32mâœ“[39m handles compose errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m handles classify errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m handles respond errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m completes full email composition workflow[32m 0[2mms[22m[39m
       [32mâœ“[39m classifies then suggests response[32m 0[2mms[22m[39m
       [32mâœ“[39m processes email thread and extracts action items[32m 0[2mms[22m[39m
       [32mâœ“[39m composes email within acceptable time[32m 0[2mms[22m[39m
       [32mâœ“[39m classifies email within acceptable time[32m 0[2mms[22m[39m
       [32mâœ“[39m generates response within acceptable time[32m 0[2mms[22m[39m
 [31mâ¯[39m src/components/settings/IntelligenceSettings.test.tsx [2m([22m[2m28 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 3894[2mms[22m[39m
       [32mâœ“[39m renders settings panel with header[32m 37[2mms[22m[39m
       [32mâœ“[39m renders all three tabs[32m 7[2mms[22m[39m
       [32mâœ“[39m loads and displays operations[32m 23[2mms[22m[39m
       [32mâœ“[39m displays operation descriptions[32m 20[2mms[22m[39m
       [32mâœ“[39m displays operation costs[32m 119[2mms[22m[39m
       [32mâœ“[39m displays criticality levels[32m 16[2mms[22m[39m
       [32mâœ“[39m displays all operation categories[32m 6[2mms[22m[39m
       [32mâœ“[39m toggles operation enabled status[32m 217[2mms[22m[39m
       [32mâœ“[39m displays enabled state for all operations[32m 35[2mms[22m[39m
       [32mâœ“[39m switches to budget tab[32m 123[2mms[22m[39m
       [32mâœ“[39m displays daily budget setting[32m 89[2mms[22m[39m
       [32mâœ“[39m displays monthly budget setting[32m 87[2mms[22m[39m
       [32mâœ“[39m displays warning threshold setting[32m 91[2mms[22m[39m
       [32mâœ“[39m updates daily budget value[32m 205[2mms[22m[39m
       [32mâœ“[39m updates monthly budget value[32m 221[2mms[22m[39m
       [32mâœ“[39m displays current budget usage[32m 140[2mms[22m[39m
       [32mâœ“[39m switches to models tab[32m 64[2mms[22m[39m
       [32mâœ“[39m displays model selection sections[32m 94[2mms[22m[39m
[31m       [31mÃ—[31m displays model options[39m[33m 1118[2mms[22m[39m
       [32mâœ“[39m displays save button[32m 8[2mms[22m[39m
       [32mâœ“[39m sends save request with operation and budget settings[32m 128[2mms[22m[39m
[31m       [31mÃ—[31m disables save button while saving[39m[32m 221[2mms[22m[39m
       [32mâœ“[39m shows last saved timestamp[32m 119[2mms[22m[39m
       [32mâœ“[39m displays reset button[32m 4[2mms[22m[39m
       [32mâœ“[39m reloads settings on reset[32m 99[2mms[22m[39m
       [32mâœ“[39m handles fetch errors gracefully[32m 27[2mms[22m[39m
       [32mâœ“[39m handles API errors gracefully[32m 19[2mms[22m[39m
       [33m[2mâœ“[22m[39m completes full workflow: load, modify, save [33m 552[2mms[22m[39m
 [31mâ¯[39m src/services/agent.test.ts [2m([22m[2m12 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[32m 21[2mms[22m[39m
[31m       [31mÃ—[31m should create an agent with default personality[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should create an agent with custom personality[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should have autonomy level 0 by default[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should have system creation origin[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should return agent by ID[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should return agents for a user[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should update agent autonomy level[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should accept autonomy levels 0-3[32m 1[2mms[22m[39m
       [32mâœ“[39m should merge personality updates[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should preserve unmodified personality dimensions[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should store agent conversation[32m 1[2mms[22m[39m
       [32mâœ“[39m should soft delete an agent[32m 1[2mms[22m[39m
[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould initialize in production with DSN
[22m[39m[Sentry] Initialized for production

[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould use environment variable DSN
[22m[39m[Sentry] Initialized for production

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould skip initialization without DSN
[22m[39m[Sentry] No DSN configured, skipping initialization

[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould set performance monitoring sample rate
[22m[39m[Sentry] Initialized for production

[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould set session replay sample rates
[22m[39m[Sentry] Initialized for production

[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould include integrations
[22m[39m[Sentry] Initialized for production

[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould include beforeSend hook for sanitization
[22m[39m[Sentry] Initialized for production

[90mstdout[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould include beforeBreadcrumb hook
[22m[39m[Sentry] Initialized for production

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2minitSentry[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:170:9
    at Proxy.assertThrows [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:2798:5[90m)[39m
    at Proxy.methodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1700:25[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1149:12[90m)[39m
    at Proxy.overwritingMethodWrapper [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mchai[24m/index.js:1750:33[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1485:16[90m)[39m
    at Proxy.<anonymous> [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/expect[24m/dist/index.js:1090:14[90m)[39m

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould sanitize authorization header
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:331:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould filter third-party network errors
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:352:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2mbeforeBreadcrumb Hook[2m > [22m[2mshould filter health check breadcrumbs
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:378:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2mbeforeBreadcrumb Hook[2m > [22m[2mshould keep ui.click breadcrumbs
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:396:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2mError Filtering[2m > [22m[2mshould ignore browser extension errors
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:420:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | src/lib/sentry-init.test.ts[2m > [22m[2mSentry Integration[2m > [22m[2mError Filtering[2m > [22m[2mshould ignore ResizeObserver errors
[22m[39m[Sentry] Failed to initialize: Error: Sentry initialization failed
    at Proxy.<anonymous> (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:166:15)
    at Proxy.Mock [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.initSentry (C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.ts:44:12)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/sentry-init.test.ts:430:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

 [31mâ¯[39m src/lib/sentry-init.test.ts [2m([22m[2m29 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 24[2mms[22m[39m
       [32mâœ“[39m should skip initialization in development[32m 1[2mms[22m[39m
       [32mâœ“[39m should initialize in production with DSN[32m 3[2mms[22m[39m
       [32mâœ“[39m should use environment variable DSN[32m 1[2mms[22m[39m
       [32mâœ“[39m should skip initialization without DSN[32m 0[2mms[22m[39m
       [32mâœ“[39m should set performance monitoring sample rate[32m 0[2mms[22m[39m
       [32mâœ“[39m should set session replay sample rates[32m 0[2mms[22m[39m
       [32mâœ“[39m should include integrations[32m 0[2mms[22m[39m
       [32mâœ“[39m should include beforeSend hook for sanitization[32m 0[2mms[22m[39m
       [32mâœ“[39m should include beforeBreadcrumb hook[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle initialization errors gracefully[32m 4[2mms[22m[39m
       [32mâœ“[39m should set user context[32m 1[2mms[22m[39m
       [32mâœ“[39m should clear user context when null[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle partial user data[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture exception without context[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture exception with context[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture info message by default[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture message with custom level[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture message with context[32m 0[2mms[22m[39m
       [32mâœ“[39m should add breadcrumb with default category[32m 0[2mms[22m[39m
       [32mâœ“[39m should add breadcrumb with custom category[32m 0[2mms[22m[39m
       [32mâœ“[39m should add breadcrumb with data[32m 0[2mms[22m[39m
       [32mâœ“[39m should start transaction with name and op[32m 0[2mms[22m[39m
       [32mâœ“[39m should start transaction with default op[32m 0[2mms[22m[39m
       [32mâœ“[39m should sanitize authorization header[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should filter third-party network errors[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should filter health check breadcrumbs[32m 1[2mms[22m[39m
       [32mâœ“[39m should keep ui.click breadcrumbs[32m 0[2mms[22m[39m
       [32mâœ“[39m should ignore browser extension errors[32m 1[2mms[22m[39m
       [32mâœ“[39m should ignore ResizeObserver errors[32m 1[2mms[22m[39m
[90mstderr[2m | src/middleware/tenant-middleware.test.ts[2m > [22m[2mTenant Middleware[2m > [22m[2mtenantMiddleware[2m > [22m[2mshould return 500 on unexpected error
[22m[39mFailed to verify tenant access: Error: Database error
    at C:/Users/Specter/Desktop/Helix/web/src/middleware/tenant-middleware.test.ts:311:46
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/middleware/tenant-middleware.test.ts[2m > [22m[2mTenant Middleware[2m > [22m[2mwithTenantContext[2m > [22m[2mshould throw on function error
[22m[39mError in tenant context for tenant-123: Error: Function error
    at C:/Users/Specter/Desktop/Helix/web/src/middleware/tenant-middleware.test.ts:466:48
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

 [31mâ¯[39m src/middleware/tenant-middleware.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 22[2mms[22m[39m
       [32mâœ“[39m should extract tenant ID from X-Tenant-ID header[32m 2[2mms[22m[39m
       [32mâœ“[39m should extract tenant ID from X-Tenant-Context header[32m 0[2mms[22m[39m
       [32mâœ“[39m should extract tenant ID from query parameter[32m 0[2mms[22m[39m
       [32mâœ“[39m should return 400 if tenant ID missing[32m 2[2mms[22m[39m
       [32mâœ“[39m should return 401 if user not authenticated[32m 0[2mms[22m[39m
       [32mâœ“[39m should return 403 if user lacks access to tenant[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow access if user is owner[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow access if user is member[32m 0[2mms[22m[39m
       [32mâœ“[39m should set tenant context for RLS[32m 1[2mms[22m[39m
       [32mâœ“[39m should attach tenant details to request[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return 500 on unexpected error[39m[32m 7[2mms[22m[39m
       [32mâœ“[39m should allow request with tenant context[32m 0[2mms[22m[39m
       [32mâœ“[39m should deny request without tenant context[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow free tier accessing free feature[32m 0[2mms[22m[39m
       [32mâœ“[39m should deny free tier accessing pro feature[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow pro tier accessing pro feature[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow enterprise accessing all features[32m 0[2mms[22m[39m
       [32mâœ“[39m should get tenant ID from request[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw if tenant ID missing[32m 1[2mms[22m[39m
       [32mâœ“[39m should get user ID from request[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw if user ID missing[32m 0[2mms[22m[39m
       [32mâœ“[39m should verify tenant ownership[32m 0[2mms[22m[39m
       [32mâœ“[39m should deny non-owner[32m 0[2mms[22m[39m
       [32mâœ“[39m should execute function with tenant context[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw on function error[32m 1[2mms[22m[39m
[90mstderr[2m | src/services/scheduling/schedule-manager.test.ts[2m > [22m[2mScheduleManager[2m > [22m[2mError Handling[2m > [22m[2mshould handle missing schedules gracefully
[22m[39m[ScheduleManager] Execution error: TypeError: db.from is not a function
    at ScheduleManager.executeSchedule (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/schedule-manager.ts:106:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/schedule-manager.test.ts:266:23
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

 [31mâ¯[39m src/services/scheduling/schedule-manager.test.ts [2m([22m[2m17 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 58[2mms[22m[39m
       [32mâœ“[39m should prevent duplicate execution with running_execution_id lock[32m 1[2mms[22m[39m
       [32mâœ“[39m should execute when not running[32m 0[2mms[22m[39m
       [32mâœ“[39m should return cost estimate with confidence range[32m 0[2mms[22m[39m
       [32mâœ“[39m should provide reasonable estimates for different operations[32m 0[2mms[22m[39m
       [32mâœ“[39m should enforce monthly cost limits[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow execution within limits[32m 0[2mms[22m[39m
       [32mâœ“[39m should verify HMAC-SHA256 signature correctly[32m 44[2mms[22m[39m
       [32mâœ“[39m should reject invalid signatures[32m 0[2mms[22m[39m
       [32mâœ“[39m should load webhook secret from 1Password[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle 1Password secret loading failure[32m 0[2mms[22m[39m
       [32mâœ“[39m should initialize schedules on app startup[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return 202 Accepted immediately[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should execute webhook async without blocking[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing schedules gracefully[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle database errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should log all errors to Discord and hash chain[32m 0[2mms[22m[39m
       [32mâœ“[39m should return low/mid/high range instead of point estimate[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/llm-router/llm-router.test.ts [2m([22m[2m46 tests[22m[2m | [22m[31m26 failed[39m[2m)[22m[32m 23[2mms[22m[39m
         [32mâœ“[39m calculates Claude Opus 4.5 cost correctly[32m 2[2mms[22m[39m
         [32mâœ“[39m calculates DeepSeek v3.2 cost correctly[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m calculates Gemini 2.0 Flash cost correctly[39m[32m 4[2mms[22m[39m
         [32mâœ“[39m throws error for unknown model[32m 1[2mms[22m[39m
         [32mâœ“[39m handles zero tokens[32m 0[2mms[22m[39m
         [32mâœ“[39m handles large token counts[32m 0[2mms[22m[39m
         [32mâœ“[39m fetches user budget correctly[32m 0[2mms[22m[39m
         [32mâœ“[39m caches budget for performance[32m 1[2mms[22m[39m
         [32mâœ“[39m allows operation within daily budget[32m 0[2mms[22m[39m
         [32mâœ“[39m rejects operation exceeding daily budget[32m 0[2mms[22m[39m
         [32mâœ“[39m checks monthly budget limit[32m 0[2mms[22m[39m
         [32mâœ“[39m creates default budget for new user[32m 0[2mms[22m[39m
         [32mâœ“[39m requires approval for MEDIUM criticality operation[32m 0[2mms[22m[39m
         [32mâœ“[39m requires approval for HIGH criticality operation[32m 0[2mms[22m[39m
         [32mâœ“[39m may require approval for LOW criticality operation near budget limit[32m 0[2mms[22m[39m
         [32mâœ“[39m does not require approval for LOW criticality operation with budget available[32m 0[2mms[22m[39m
         [32mâœ“[39m logs operation execution[32m 0[2mms[22m[39m
         [32mâœ“[39m invalidates budget cache after logging[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m returns correct pricing for Claude Opus 4.5[39m[32m 2[2mms[22m[39m
[31m         [31mÃ—[31m returns correct pricing for DeepSeek v3.2[39m[32m 1[2mms[22m[39m
[31m         [31mÃ—[31m returns correct pricing for Gemini 2.0 Flash[39m[32m 0[2mms[22m[39m
         [32mâœ“[39m throws error for unknown model pricing[32m 0[2mms[22m[39m
         [32mâœ“[39m estimates cost for email-compose operation[32m 0[2mms[22m[39m
         [32mâœ“[39m estimates latency based on token count[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m initializes with operations loaded[39m[32m 1[2mms[22m[39m
[31m         [31mÃ—[31m caches operations for performance[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m clears operation cache on demand[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m returns routing decision for email-compose operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m uses primary model when available[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m marks operation as not requiring approval when in budget[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m indicates budget status in routing decision[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m sets isFeatureEnabled to true by default[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m executes operation successfully[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m handles execution errors gracefully[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m tracks execution latency[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes email-compose operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes email-classify operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes email-respond operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes calendar-prep operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes calendar-time operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes task-prioritize operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes task-breakdown operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes analytics-summary operation[39m[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m routes analytics-anomaly operation[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m coordinates between router and cost tracker[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m processes complete operation workflow[39m[32m 0[2mms[22m[39m
[90mstderr[2m | src/services/automation-email-trigger.test.ts[2m > [22m[2mAutomationEmailTriggerService[2m > [22m[2mRule Management[2m > [22m[2mupdates email trigger
[22m[39mFailed to update email trigger: TypeError: __vite_ssr_import_0__.supabase.from(...).update(...).eq(...).select is not a function
    at AutomationEmailTriggerService.updateEmailTrigger (C:/Users/Specter/Desktop/Helix/web/src/services/automation-email-trigger.ts:412:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-email-trigger.test.ts:286:49
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

[90mstderr[2m | src/services/automation-email-trigger.test.ts[2m > [22m[2mAutomationEmailTriggerService[2m > [22m[2mRule Management[2m > [22m[2mdeletes email trigger
[22m[39mFailed to delete email trigger: TypeError: __vite_ssr_import_0__.supabase.from(...).delete(...).eq(...).eq is not a function
    at AutomationEmailTriggerService.deleteEmailTrigger (C:/Users/Specter/Desktop/Helix/web/src/services/automation-email-trigger.ts:445:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/automation-email-trigger.test.ts:297:49
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

 [31mâ¯[39m src/services/calendar-task-intelligence.test.ts [2m([22m[2m53 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 18[2mms[22m[39m
         [32mâœ“[39m generates meeting preparation plan[32m 1[2mms[22m[39m
         [32mâœ“[39m includes key discussion points[32m 0[2mms[22m[39m
         [32mâœ“[39m suggests discussion topics[32m 0[2mms[22m[39m
         [32mâœ“[39m estimates preparation time[32m 0[2mms[22m[39m
         [32mâœ“[39m provides confidence score[32m 0[2mms[22m[39m
         [32mâœ“[39m handles different meeting durations[32m 0[2mms[22m[39m
         [32mâœ“[39m handles different attendee counts[32m 0[2mms[22m[39m
         [32mâœ“[39m respects time until meeting context[32m 0[2mms[22m[39m
         [32mâœ“[39m creates summary of meeting[32m 0[2mms[22m[39m
         [32mâœ“[39m logs preparation to Discord[32m 0[2mms[22m[39m
         [32mâœ“[39m suggests optimal meeting times[32m 0[2mms[22m[39m
         [32mâœ“[39m returns best time separately[32m 0[2mms[22m[39m
         [32mâœ“[39m quality scores are within valid range[32m 0[2mms[22m[39m
         [32mâœ“[39m suggests times with reasons[32m 0[2mms[22m[39m
         [32mâœ“[39m respects attendee count in suggestions[32m 0[2mms[22m[39m
         [32mâœ“[39m respects time duration in suggestions[32m 0[2mms[22m[39m
         [32mâœ“[39m respects date range constraints[32m 0[2mms[22m[39m
         [32mâœ“[39m uses user preferences when provided[32m 0[2mms[22m[39m
         [32mâœ“[39m avoids specified times[32m 0[2mms[22m[39m
         [32mâœ“[39m provides confidence score for suggestions[32m 0[2mms[22m[39m
         [32mâœ“[39m ranks suggestions by quality[32m 0[2mms[22m[39m
         [32mâœ“[39m logs time suggestions to Discord[32m 0[2mms[22m[39m
         [32mâœ“[39m prioritizes tasks by urgency and impact[32m 0[2mms[22m[39m
         [32mâœ“[39m assigns valid priority levels[32m 1[2mms[22m[39m
         [32mâœ“[39m estimates hours for each task[32m 0[2mms[22m[39m
         [32mâœ“[39m provides reasoning for priority[32m 0[2mms[22m[39m
         [32mâœ“[39m calculates blocking factor[32m 0[2mms[22m[39m
         [32mâœ“[39m assigns timeline position[32m 0[2mms[22m[39m
         [32mâœ“[39m prioritizes critical bugs highest[32m 0[2mms[22m[39m
         [32mâœ“[39m respects task dependencies[32m 0[2mms[22m[39m
         [32mâœ“[39m uses context for prioritization[32m 0[2mms[22m[39m
         [32mâœ“[39m handles single task[32m 0[2mms[22m[39m
         [32mâœ“[39m handles many tasks[32m 0[2mms[22m[39m
         [32mâœ“[39m logs prioritization to Discord[32m 0[2mms[22m[39m
         [32mâœ“[39m breaks down complex task into subtasks[32m 0[2mms[22m[39m
         [32mâœ“[39m returns original task reference[32m 0[2mms[22m[39m
         [32mâœ“[39m estimates hours for subtasks[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m subtask hours total approximately original estimate[39m[32m 4[2mms[22m[39m
         [32mâœ“[39m identifies prerequisites[32m 0[2mms[22m[39m
         [32mâœ“[39m provides descriptions for subtasks[32m 0[2mms[22m[39m
         [32mâœ“[39m suggests logical order[32m 0[2mms[22m[39m
         [32mâœ“[39m provides confidence score[32m 0[2mms[22m[39m
         [32mâœ“[39m respects task complexity[32m 0[2mms[22m[39m
         [32mâœ“[39m uses context in breakdown[32m 0[2mms[22m[39m
         [32mâœ“[39m handles tasks with due dates[32m 0[2mms[22m[39m
         [32mâœ“[39m handles tasks without estimates[32m 0[2mms[22m[39m
         [32mâœ“[39m logs breakdown to Discord[32m 0[2mms[22m[39m
       [32mâœ“[39m prioritizes tasks then breaks down critical task[32m 0[2mms[22m[39m
       [32mâœ“[39m prepares meeting then suggests follow-up time[32m 0[2mms[22m[39m
       [32mâœ“[39m handles meeting prep errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m handles task prioritization errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m returns same calendar service instance[32m 0[2mms[22m[39m
       [32mâœ“[39m returns same task service instance[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/automation-email-trigger.test.ts [2m([22m[2m31 tests[22m[2m | [22m[31m11 failed[39m[2m)[22m[32m 20[2mms[22m[39m
       [32mâœ“[39m returns same instance[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m creates email-to-task rule with email from filter[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m creates rule with subject keyword filter[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m creates rule with body keyword filter[32m 0[2mms[22m[39m
       [32mâœ“[39m creates rule with attachment requirement[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m creates disabled rule[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m matches email from filter exactly[32m 1[2mms[22m[39m
       [32mâœ“[39m matches email with subject keywords[32m 0[2mms[22m[39m
       [32mâœ“[39m matches email with body keywords[32m 0[2mms[22m[39m
       [32mâœ“[39m matches email with attachments[32m 0[2mms[22m[39m
       [32mâœ“[39m does not match email without required condition[32m 0[2mms[22m[39m
       [32mâœ“[39m creates task with simple title[32m 0[2mms[22m[39m
       [32mâœ“[39m creates task with template variables substituted[32m 0[2mms[22m[39m
       [32mâœ“[39m creates task with custom priority[32m 0[2mms[22m[39m
       [32mâœ“[39m creates task with due date[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m processes incoming email and checks triggers[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m returns task ID on successful execution[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m handles multiple triggers for same email[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m logs trigger execution to Discord[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m adds execution record to hash chain[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m gets all email triggers for user[32m 0[2mms[22m[39m
       [32mâœ“[39m updates email trigger[32m 1[2mms[22m[39m
       [32mâœ“[39m deletes email trigger[32m 1[2mms[22m[39m
       [32mâœ“[39m handles rule creation errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m handles email processing errors gracefully[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m continues on trigger execution failure[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m replaces emailSubject variable[32m 0[2mms[22m[39m
       [32mâœ“[39m replaces emailFrom variable[32m 0[2mms[22m[39m
       [32mâœ“[39m handles missing variables gracefully[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m enforces trigger type[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m enforces action type[39m[32m 0[2mms[22m[39m
 [31mâ¯[39m src/components/TenantSettings.test.tsx [2m([22m[2m10 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 4449[2mms[22m[39m
[31m     [31mÃ—[31m should render tenant settings page[39m[32m 105[2mms[22m[39m
[31m     [31mÃ—[31m should display tabs for members and invite[39m[32m 216[2mms[22m[39m
[31m     [31mÃ—[31m should load and display members[39m[33m 1011[2mms[22m[39m
[31m     [31mÃ—[31m should switch to invite tab[39m[32m 12[2mms[22m[39m
     [32mâœ“[39m should show loading state while fetching members[32m 4[2mms[22m[39m
[31m     [31mÃ—[31m should show no members message when empty[39m[33m 1030[2mms[22m[39m
[31m     [31mÃ—[31m should handle remove member[39m[33m 1031[2mms[22m[39m
[31m     [31mÃ—[31m should handle invite success[39m[32m 10[2mms[22m[39m
     [32mâœ“[39m should handle no tenant selected[32m 2[2mms[22m[39m
[31m     [31mÃ—[31m should display error message on load failure[39m[33m 1027[2mms[22m[39m
[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotionDetectionService - Integration Tests[2m > [22m[2mshould detect joy emotion from positive conversation
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:29:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:29:41
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotionDetectionService - Integration Tests[2m > [22m[2mshould detect sadness emotion from negative conversation
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:51:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:51:41
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotionDetectionService - Integration Tests[2m > [22m[2mshould calculate salience score with correct formula
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:68:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:68:41
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotionDetectionService - Integration Tests[2m > [22m[2mshould classify salience tiers correctly
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:109:22
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:109:43
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotionDetectionService - Integration Tests[2m > [22m[2mshould return valid dimensional values
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:131:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:131:41
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotionDetectionService - Integration Tests[2m > [22m[2mshould handle multi-turn conversations
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:169:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:169:41
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mTopicExtractionService - Integration Tests[2m > [22m[2mshould extract 3-5 topics from conversation
[22m[39mFailed to extract topics: TypeError: Failed to parse URL from /api/topic-extraction
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:194:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:194:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/topic-extraction'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mTopicExtractionService - Integration Tests[2m > [22m[2mshould extract relevant topics from technical conversation
[22m[39mFailed to extract topics: TypeError: Failed to parse URL from /api/topic-extraction
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:215:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:215:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/topic-extraction'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mTopicExtractionService - Integration Tests[2m > [22m[2mshould extract distinct topics without duplicates
[22m[39mFailed to extract topics: TypeError: Failed to parse URL from /api/topic-extraction
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:235:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:235:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/topic-extraction'[39m
  }
}

[90mstderr[2m | src/services/voice-phase4.test.ts
[22m[39mSupabase credentials not found. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file.

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mTopicExtractionService - Integration Tests[2m > [22m[2mshould handle empty or short conversations gracefully
[22m[39mFailed to extract topics: TypeError: Failed to parse URL from /api/topic-extraction
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:252:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:252:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/topic-extraction'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mTopicExtractionService - Integration Tests[2m > [22m[2mshould return valid JSON format
[22m[39mFailed to extract topics: TypeError: Failed to parse URL from /api/topic-extraction
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:267:20
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:267:39
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/topic-extraction'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotion Detection and Topic Extraction - Combined Tests[2m > [22m[2mshould analyze emotion and extract topics from same conversation
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:292:27
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:292:48
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/integration.test.ts[2m > [22m[2mEmotion Detection and Topic Extraction - Combined Tests[2m > [22m[2mshould handle high-salience emotional conversation with relevant topics
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:318:27
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/integration.test.ts:318:48
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

 [31mâ¯[39m src/services/__tests__/integration.test.ts [2m([22m[2m13 tests[22m[2m | [22m[31m13 failed[39m[2m)[22m[32m 18[2mms[22m[39m
[31m     [31mÃ—[31m should detect joy emotion from positive conversation[39m[32m 7[2mms[22m[39m
[31m     [31mÃ—[31m should detect sadness emotion from negative conversation[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should calculate salience score with correct formula[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should classify salience tiers correctly[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should return valid dimensional values[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should handle multi-turn conversations[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should extract 3-5 topics from conversation[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should extract relevant topics from technical conversation[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should extract distinct topics without duplicates[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should handle empty or short conversations gracefully[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should return valid JSON format[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should analyze emotion and extract topics from same conversation[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should handle high-salience emotional conversation with relevant topics[39m[32m 1[2mms[22m[39m
[90mstderr[2m | src/services/voice-phase4.test.ts[2m > [22m[2mPhase 4.2: Voice Features[2m > [22m[2mSentiment Analysis Service[2m > [22m[2manalyzeTranscript[2m > [22m[2mshould throw error on network failure
[22m[39mSentiment analysis error: Error: Network error
    at C:/Users/Specter/Desktop/Helix/web/src/services/voice-phase4.test.ts:158:53
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/services/voice-phase4.test.ts[2m > [22m[2mPhase 4.2: Voice Features[2m > [22m[2mSentiment Analysis Service[2m > [22m[2manalyzeTranscript[2m > [22m[2mshould throw error on API error response
[22m[39mSentiment analysis error: Error: Sentiment analysis failed: Internal Server Error
    at SentimentAnalysisService.analyzeTranscript (C:/Users/Specter/Desktop/Helix/web/src/services/sentiment-analysis.ts:94:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

 [31mâ¯[39m src/services/voice-phase4.test.ts [2m([22m[2m27 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 18[2mms[22m[39m
         [32mâœ“[39m should analyze transcript and return sentiment result[32m 2[2mms[22m[39m
         [32mâœ“[39m should handle transcripts with negative sentiment[32m 0[2mms[22m[39m
         [32mâœ“[39m should handle neutral transcripts[32m 0[2mms[22m[39m
         [32mâœ“[39m should handle confused/uncertain emotion[32m 0[2mms[22m[39m
         [32mâœ“[39m should throw error on network failure[32m 4[2mms[22m[39m
         [32mâœ“[39m should throw error on API error response[32m 1[2mms[22m[39m
         [32mâœ“[39m should analyze multiple transcripts in batch[32m 1[2mms[22m[39m
         [32mâœ“[39m should ensure sentimentScore is between 0 and 1[32m 0[2mms[22m[39m
         [32mâœ“[39m should validate emotion types[32m 0[2mms[22m[39m
         [32mâœ“[39m should validate tone types[32m 0[2mms[22m[39m
         [32mâœ“[39m should validate VAD model ranges[32m 0[2mms[22m[39m
         [32mâœ“[39m should calculate duration formatting correctly[32m 0[2mms[22m[39m
         [32mâœ“[39m should calculate confidence distribution correctly[32m 0[2mms[22m[39m
         [32mâœ“[39m should calculate emotion distribution[32m 0[2mms[22m[39m
         [32mâœ“[39m should identify positive sentiment trend[32m 0[2mms[22m[39m
         [32mâœ“[39m should identify negative sentiment trend[32m 0[2mms[22m[39m
[31m         [31mÃ—[31m should identify emotional volatility[39m[32m 1[2mms[22m[39m
         [32mâœ“[39m should calculate average sentiment correctly[32m 0[2mms[22m[39m
         [32mâœ“[39m should format CSV correctly[32m 0[2mms[22m[39m
         [32mâœ“[39m should escape CSV values properly[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate WebRTC constraints[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate ICE server configuration[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle connection state transitions[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle very short transcripts[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle transcripts with mixed languages[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle sarcasm detection[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle large batch analysis[32m 1[2mms[22m[39m
 [31mâ¯[39m src/__tests__/Phase3-E2E.test.ts [2m([22m[2m12 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 5169[2mms[22m[39m
       [32mâœ“[39m validates, creates, executes, and logs tool usage[32m 3[2mms[22m[39m
       [32mâœ“[39m detects and prevents dangerous code execution[32m 1[2mms[22m[39m
       [32mâœ“[39m enforces tool parameter validation[32m 0[2mms[22m[39m
       [32mâœ“[39m creates, validates, and executes multi-step workflow[32m 1[2mms[22m[39m
       [32mâœ“[39m handles skill step failures and recovery[32m 0[2mms[22m[39m
       [32mâœ“[39m initiates, monitors, and retrieves synthesis results[32m 2[2mms[22m[39m
       [32mâœ“[39m detects patterns across multiple psychological layers[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m executes complete user journey: create tool â†’ use in skill â†’ run synthesis[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m tool metrics feed into pattern synthesis[32m 2[2mms[22m[39m
       [32mâœ“[39m handles concurrent executions of multiple tools[32m 3[2mms[22m[39m
       [32mâœ“[39m recovers from transient network failures[32m 126[2mms[22m[39m
[31m       [31mÃ—[31m enforces execution timeouts[39m[33m 5022[2mms[22m[39m
 [31mâ¯[39m src/__tests__/Phase3-Integration.test.ts [2m([22m[2m16 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 5194[2mms[22m[39m
[31m       [31mÃ—[31m executes simple arithmetic tool and logs usage[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m handles tool execution with multiple parameters[32m 1[2mms[22m[39m
       [32mâœ“[39m reports tool execution errors[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m executes multi-step composite skill[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m validates skill steps before execution[32m 0[2mms[22m[39m
       [32mâœ“[39m detects invalid skill configuration[32m 0[2mms[22m[39m
       [32mâœ“[39m starts memory synthesis job[32m 1[2mms[22m[39m
       [32mâœ“[39m monitors synthesis job progress[32m 0[2mms[22m[39m
       [32mâœ“[39m retrieves completed synthesis results[32m 1[2mms[22m[39m
       [32mâœ“[39m executes tool via composite skill[32m 0[2mms[22m[39m
       [32mâœ“[39m synthesis tracks tool execution patterns[32m 1[2mms[22m[39m
       [32mâœ“[39m retries execution on temporary network failure[32m 130[2mms[22m[39m
[31m       [31mÃ—[31m handles execution timeout gracefully[39m[33m 5043[2mms[22m[39m
[31m       [31mÃ—[31m reports partial execution failure in composite skills[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m tracks execution time for performance analysis[32m 0[2mms[22m[39m
       [32mâœ“[39m maintains sub-second response for simple tools[32m 1[2mms[22m[39m
 [31mâ¯[39m src/services/intelligence/integration.test.ts [2m([22m[2m26 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 13[2mms[22m[39m
       [32mâœ“[39m should handle email composition request[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle email classification request[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens correctly for email operations[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle meeting preparation request[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle optimal time request[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle task prioritization request[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle task breakdown request[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle weekly summary request[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle anomaly detection request[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for email composition[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for meeting prep[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should estimate tokens for analytics summary[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should route email operations to deepseek[32m 0[2mms[22m[39m
       [32mâœ“[39m should route calendar-prep to deepseek[32m 0[2mms[22m[39m
       [32mâœ“[39m should route calendar-time to gemini_flash[32m 0[2mms[22m[39m
       [32mâœ“[39m should route task operations to deepseek[32m 0[2mms[22m[39m
       [32mâœ“[39m should route analytics-summary to gemini_flash[32m 0[2mms[22m[39m
       [32mâœ“[39m should route analytics-anomaly to deepseek[32m 0[2mms[22m[39m
       [32mâœ“[39m should verify all Phase 8 operations cost less than $0.10/call[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate daily cost correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing user ID gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle invalid email address format[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle empty task lists[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate email metadata[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate task data structure[32m 1[2mms[22m[39m
       [32mâœ“[39m should validate date ranges[32m 0[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/e2e-memory-flow.test.ts[2m > [22m[2mEnd-to-End Memory Flow[2m > [22m[2mSingle Conversation Processing[2m > [22m[2mshould capture a full conversation end-to-end
[22m[39mStep 1: Analyzing emotions...

(node:46028) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/services/__tests__/e2e-memory-flow.test.ts[2m > [22m[2mEnd-to-End Memory Flow[2m > [22m[2mSingle Conversation Processing[2m > [22m[2mshould capture a full conversation end-to-end
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:55:24
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:55:45
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/e2e-memory-flow.test.ts[2m > [22m[2mEnd-to-End Memory Flow[2m > [22m[2mSingle Conversation Processing[2m > [22m[2mshould handle multiple distinct conversations
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:177:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:177:47
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/e2e-memory-flow.test.ts[2m > [22m[2mEnd-to-End Memory Flow[2m > [22m[2mSemantic Search Accuracy[2m > [22m[2mshould find semantically similar conversations
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:259:24
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:259:45
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/e2e-memory-flow.test.ts[2m > [22m[2mEnd-to-End Memory Flow[2m > [22m[2mEmotion Analysis Quality[2m > [22m[2mshould detect distinct emotions correctly
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:347:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:347:47
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

 [31mâ¯[39m src/lib/tenant/tenant-context.test.ts [2m([22m[2m20 tests[22m[2m | [22m[31m20 failed[39m[2m)[22m[32m 14[2mms[22m[39m
[31m       [31mÃ—[31m should return null when no tenant set[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should return tenant ID from storage[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle storage errors gracefully[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should set tenant ID in storage[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should dispatch tenant-changed event[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle storage errors gracefully[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should throw when no tenant set[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return tenant ID and headers[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should include Base64-encoded tenant context in headers[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create valid Base64 encoded context[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should call callback when tenant changes[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return unsubscribe function[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should support multiple listeners[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should pass correct tenant ID to callback[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should synchronize tenant changes across tabs[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle rapid tenant switches[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle empty tenant ID[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle special characters in tenant ID[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle very long tenant IDs[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle UUIDs as tenant IDs[39m[32m 0[2mms[22m[39m
[90mstderr[2m | src/services/__tests__/e2e-memory-flow.test.ts[2m > [22m[2mEnd-to-End Memory Flow[2m > [22m[2mPerformance Benchmarks[2m > [22m[2mshould complete memory capture pipeline in reasonable time
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:389:24
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/e2e-memory-flow.test.ts:389:45
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/email-to-task.integration.test.ts[2m > [22m[2mEmail-to-Task Integration[2m > [22m[2mRule Management[2m > [22m[2mupdates rule configuration
[22m[39mFailed to update email trigger: TypeError: __vite_ssr_import_0__.supabase.from(...).update(...).eq(...).select is not a function
    at AutomationEmailTriggerService.updateEmailTrigger (C:/Users/Specter/Desktop/Helix/web/src/services/automation-email-trigger.ts:412:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/email-to-task.integration.test.ts:307:49
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/__tests__/email-to-task.integration.test.ts[2m > [22m[2mEmail-to-Task Integration[2m > [22m[2mRule Management[2m > [22m[2mdeletes rule
[22m[39mFailed to delete email trigger: TypeError: __vite_ssr_import_0__.supabase.from(...).delete(...).eq(...).eq is not a function
    at AutomationEmailTriggerService.deleteEmailTrigger (C:/Users/Specter/Desktop/Helix/web/src/services/automation-email-trigger.ts:445:10)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/email-to-task.integration.test.ts:326:49
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/services/__tests__/e2e-memory-flow.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 12[2mms[22m[39m
[31m       [31mÃ—[31m should capture a full conversation end-to-end[39m[32m 7[2mms[22m[39m
[31m       [31mÃ—[31m should handle multiple distinct conversations[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should find semantically similar conversations[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should detect distinct emotions correctly[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should complete memory capture pipeline in reasonable time[39m[32m 1[2mms[22m[39m
 [31mâ¯[39m src/services/__tests__/email-to-task.integration.test.ts [2m([22m[2m20 tests[22m[2m | [22m[31m14 failed[39m[2m)[22m[32m 17[2mms[22m[39m
[31m       [31mÃ—[31m executes emailâ†’ruleâ†’task workflow[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m matches multiple email conditions[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m skips email if conditions not met[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m substitutes emailSubject variable[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m substitutes emailFrom variable[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m creates task with high priority[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m creates task with normal priority[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m creates task with low priority[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m logs rule creation to Discord[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m logs email trigger execution to Discord[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m records execution in hash chain[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m executes first matching rule[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m handles malformed email gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m continues on missing user[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m processes email within timeout[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m retrieves all rules for user[32m 0[2mms[22m[39m
       [32mâœ“[39m updates rule configuration[32m 2[2mms[22m[39m
       [32mâœ“[39m deletes rule[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m enforces email trigger type[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m enforces create_task action type[39m[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/automation-learning.test.ts [2m([22m[2m47 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 18[2mms[22m[39m
       [32mâœ“[39m returns same instance[32m 1[2mms[22m[39m
       [32mâœ“[39m analyzes patterns from execution history[32m 0[2mms[22m[39m
       [32mâœ“[39m filters patterns by minimum frequency[32m 0[2mms[22m[39m
       [32mâœ“[39m calculates success rate correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m sorts patterns by frequency[32m 0[2mms[22m[39m
       [32mâœ“[39m returns empty array for user with minimal history[32m 0[2mms[22m[39m
       [32mâœ“[39m detects patterns in executions[32m 0[2mms[22m[39m
       [32mâœ“[39m filters patterns with minimum 3 executions[32m 0[2mms[22m[39m
       [32mâœ“[39m handles mixed success and failure[32m 0[2mms[22m[39m
       [32mâœ“[39m extracts pattern from execution[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m uses trigger ID and status for pattern[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m handles different statuses[32m 1[2mms[22m[39m
       [32mâœ“[39m infers trigger type from pattern[32m 0[2mms[22m[39m
       [32mâœ“[39m defaults to email_received for unknown patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m generates suggestions for high-success patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m only suggests for patterns >80% success rate[32m 0[2mms[22m[39m
       [32mâœ“[39m limits suggestions to top 3 patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m returns empty array for new users[32m 0[2mms[22m[39m
       [32mâœ“[39m creates automation suggestion from pattern[32m 0[2mms[22m[39m
       [32mâœ“[39m includes confidence in suggestion[32m 0[2mms[22m[39m
       [32mâœ“[39m identifies underperforming patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m logs optimization suggestions for underperforming rules[32m 0[2mms[22m[39m
       [32mâœ“[39m does not suggest optimization for high-performing rules[32m 0[2mms[22m[39m
       [32mâœ“[39m retrieves high-performing patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m only returns patterns with >80% success rate[32m 0[2mms[22m[39m
       [32mâœ“[39m limits to top 5 patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m calculates confidence from success rate and frequency[32m 0[2mms[22m[39m
       [32mâœ“[39m increases confidence with higher frequency[32m 0[2mms[22m[39m
       [32mâœ“[39m generates learning report[32m 0[2mms[22m[39m
       [32mâœ“[39m includes pattern count[32m 0[2mms[22m[39m
       [32mâœ“[39m includes average success rate[32m 0[2mms[22m[39m
       [32mâœ“[39m includes best performing pattern[32m 0[2mms[22m[39m
       [32mâœ“[39m includes suggestion count[32m 0[2mms[22m[39m
       [32mâœ“[39m retrieves execution history for user[32m 0[2mms[22m[39m
       [32mâœ“[39m limits to last 100 executions[32m 0[2mms[22m[39m
       [32mâœ“[39m returns empty array for new user[32m 0[2mms[22m[39m
       [32mâœ“[39m calculates average success rate[32m 0[2mms[22m[39m
       [32mâœ“[39m returns 0 for empty pattern list[32m 0[2mms[22m[39m
       [32mâœ“[39m equals success rate for single pattern[32m 0[2mms[22m[39m
       [32mâœ“[39m logs pattern analysis to Discord[32m 0[2mms[22m[39m
       [32mâœ“[39m logs errors to Discord[32m 0[2mms[22m[39m
       [32mâœ“[39m handles database errors gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m returns empty report on analysis failure[32m 0[2mms[22m[39m
       [32mâœ“[39m continues operation with partial data[32m 0[2mms[22m[39m
       [32mâœ“[39m returns patterns with required fields[32m 0[2mms[22m[39m
       [32mâœ“[39m returns suggestions with required fields[32m 0[2mms[22m[39m
       [32mâœ“[39m execution history has correct structure[32m 0[2mms[22m[39m
[90mstderr[2m | src/services/scheduling/pg-cron-manager.test.ts[2m > [22m[2mPgCronManager[2m > [22m[2mSchedule Registration[2m > [22m[2mshould register a cron schedule
[22m[39mFailed to schedule operation: Error: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:311:17[90m)[39m
    at Object.get [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:384:16[90m)[39m
    at PgCronManager.scheduleOperation (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:47:27)
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.test.ts:105:21
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37 {
  codeFrame: [32m'vi.mock(import("cron-parser"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

[90mstderr[2m | src/services/scheduling/pg-cron-manager.test.ts[2m > [22m[2mPgCronManager[2m > [22m[2mSchedule Registration[2m > [22m[2mshould validate cron expression
[22m[39mFailed to schedule operation: Error: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:311:17[90m)[39m
    at Object.get [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:384:16[90m)[39m
    at PgCronManager.scheduleOperation (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:47:27)
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.test.ts:122:21
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37 {
  codeFrame: [32m'vi.mock(import("cron-parser"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

[90mstderr[2m | src/services/scheduling/pg-cron-manager.test.ts[2m > [22m[2mPgCronManager[2m > [22m[2mSchedule Updates[2m > [22m[2mshould update schedule with new cron expression
[22m[39mFailed to schedule operation: Error: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:311:17[90m)[39m
    at Object.get [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:384:16[90m)[39m
    at PgCronManager.scheduleOperation (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:47:27)
    at PgCronManager.updateSchedule (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:116:16)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.test.ts:174:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  codeFrame: [32m'vi.mock(import("cron-parser"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

[90mstderr[2m | src/services/scheduling/pg-cron-manager.test.ts[2m > [22m[2mPgCronManager[2m > [22m[2mSchedule Enable/Disable[2m > [22m[2mshould disable schedule
[22m[39mFailed to schedule operation: Error: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:311:17[90m)[39m
    at Object.get [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:384:16[90m)[39m
    at PgCronManager.scheduleOperation (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:47:27)
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.test.ts:199:21
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37 {
  codeFrame: [32m'vi.mock(import("cron-parser"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

[90mstderr[2m | src/services/scheduling/pg-cron-manager.test.ts[2m > [22m[2mPgCronManager[2m > [22m[2mSchedule Enable/Disable[2m > [22m[2mshould enable disabled schedule
[22m[39mFailed to schedule operation: Error: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:311:17[90m)[39m
    at Object.get [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:384:16[90m)[39m
    at PgCronManager.scheduleOperation (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:47:27)
    at PgCronManager.enableSchedule (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:190:16)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.test.ts:217:7
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  codeFrame: [32m'vi.mock(import("cron-parser"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

[90mstderr[2m | src/services/scheduling/pg-cron-manager.test.ts[2m > [22m[2mPgCronManager[2m > [22m[2mTimezone Handling[2m > [22m[2mshould handle various timezones
[22m[39mFailed to schedule operation: Error: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:311:17[90m)[39m
    at Object.get [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/startModuleRunner.DEj0jb3e.js:384:16[90m)[39m
    at PgCronManager.scheduleOperation (C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.ts:47:27)
    at C:/Users/Specter/Desktop/Helix/web/src/services/scheduling/pg-cron-manager.test.ts:263:23
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37 {
  codeFrame: [32m'vi.mock(import("cron-parser"), async (importOriginal) => {\n'[39m +
    [32m'  const actual = await importOriginal()\n'[39m +
    [32m'  return {\n'[39m +
    [32m'    ...actual,\n'[39m +
    [32m'    // your mocked methods\n'[39m +
    [32m'  }\n'[39m +
    [32m'})'[39m
}

 [31mâ¯[39m src/services/scheduling/pg-cron-manager.test.ts [2m([22m[2m13 tests[22m[2m | [22m[31m6 failed[39m[2m)[22m[32m 16[2mms[22m[39m
[31m       [31mÃ—[31m should register a cron schedule[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m should validate cron expression[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should reject webhook schedules[32m 1[2mms[22m[39m
       [32mâœ“[39m should unschedule an operation[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle missing schedule gracefully[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should update schedule with new cron expression[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should list active schedules for user[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should disable schedule[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should enable disabled schedule[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should get next execution time[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate all schedules for user[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle various timezones[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m should return same instance[32m 1[2mms[22m[39m
 [31mâ¯[39m src/services/intelligence/task-intelligence.test.ts [2m([22m[2m39 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 15[2mms[22m[39m
       [32mâœ“[39m should prioritize tasks by deadline[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect high priority tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should consider task dependencies[32m 1[2mms[22m[39m
       [32mâœ“[39m should consider user goals[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle task duration constraints[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify critical path[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate urgency score[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle empty task list[32m 0[2mms[22m[39m
       [32mâœ“[39m should prioritize completed tasks lower[32m 0[2mms[22m[39m
       [32mâœ“[39m should break down complex task into subtasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should provide subtask estimates[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify dependencies between subtasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should suggest resources needed[32m 0[2mms[22m[39m
       [32mâœ“[39m should adapt to skill level[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate total hours correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify risks[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for prioritization prompt[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should estimate tokens for breakdown prompt[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should cost ~$0.0018 for task prioritization[32m 0[2mms[22m[39m
       [32mâœ“[39m should cost ~$0.0012 for task breakdown[32m 0[2mms[22m[39m
       [32mâœ“[39m should have combined daily cost ~$0.006[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate task has required fields[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate priority values[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate status values[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate due dates are in future[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle tasks without due dates[32m 0[2mms[22m[39m
       [32mâœ“[39m should track task relationships[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect circular dependencies[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle tasks with no dependencies[32m 0[2mms[22m[39m
       [32mâœ“[39m should suggest next task after completion[32m 0[2mms[22m[39m
       [32mâœ“[39m should consider completion patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle large task lists (100+ tasks)[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate priority scores efficiently[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle tasks with long descriptions[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing task ID[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle invalid priority[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle past due dates[32m 0[2mms[22m[39m
       [32mâœ“[39m should pass correct user ID to router[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for routing[32m 0[2mms[22m[39m
 [31mâ¯[39m src/lib/ai-provider-client.test.ts [2m([22m[2m18 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 17[2mms[22m[39m
       [32mâœ“[39m should estimate tokens accurately[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle empty strings[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for multiple contents[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle undefined content in multiple estimation[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate cost for email composition prompt[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate cost for meeting prep[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate cost for task prioritization[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should estimate cost for weekly analytics[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should return same instance[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle API key missing gracefully[32m 6[2mms[22m[39m
       [32mâœ“[39m should show DeepSeek is cheaper than Gemini for short prompts[32m 0[2mms[22m[39m
       [32mâœ“[39m should show cost difference for large prompts[32m 0[2mms[22m[39m
       [32mâœ“[39m should support all required Phase 8 models[32m 0[2mms[22m[39m
       [32mâœ“[39m should use appropriate temperature for each operation type[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate output tokens for different response lengths[32m 0[2mms[22m[39m
       [32mâœ“[39m should show email operations are low cost[32m 0[2mms[22m[39m
       [32mâœ“[39m should show calendar operations are moderate cost[32m 0[2mms[22m[39m
       [32mâœ“[39m should show analytics operations are higher cost[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/intelligence/analytics-intelligence.test.ts [2m([22m[2m38 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 18[2mms[22m[39m
       [32mâœ“[39m should generate summary for valid week[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate week duration[32m 0[2mms[22m[39m
       [32mâœ“[39m should include previous weeks for comparison[32m 0[2mms[22m[39m
       [32mâœ“[39m should include user goals context[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate performance scores[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify high achievers[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle zero metrics gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should schedule summary for Sunday 6pm[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect spike in email processing[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect drop in task completion[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect unusual working hours[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect improved performance[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate baseline from historical data[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing historical data[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should estimate tokens for weekly summary prompt[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should estimate tokens for anomaly detection prompt[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should cost ~$0.0300 for weekly summary[32m 0[2mms[22m[39m
       [32mâœ“[39m should cost ~$0.0009 for anomaly detection[32m 0[2mms[22m[39m
       [32mâœ“[39m should have weekly cost ~$0.0042[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate all metrics are non-negative[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate response time is reasonable[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate total time is reasonable[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle edge case metrics[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate week-over-week change[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate moving average[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify trend direction[32m 0[2mms[22m[39m
       [32mâœ“[39m should initialize scheduler[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should calculate next Sunday at 6pm[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should handle midnight boundary[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate performance scores[32m 0[2mms[22m[39m
       [32mâœ“[39m should provide actionable recommendations[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify top productivity hours[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing user ID[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle invalid date range[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle negative metrics[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle large historical datasets[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle multiple users efficiently[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/intelligence/calendar-intelligence.test.ts [2m([22m[2m34 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 15[2mms[22m[39m
       [32mâœ“[39m should generate meeting prep with valid request[32m 1[2mms[22m[39m
       [32mâœ“[39m should include agenda items in preparation[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate meeting duration correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle events without location[32m 0[2mms[22m[39m
       [32mâœ“[39m should include all attendees in preparation context[32m 1[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for meeting prep prompt[32m 0[2mms[22m[39m
       [32mâœ“[39m should find optimal times for multiple attendees[32m 0[2mms[22m[39m
       [32mâœ“[39m should respect time constraints[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle early morning preference[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle late evening preference[32m 0[2mms[22m[39m
       [32mâœ“[39m should suggest multiple time options[32m 0[2mms[22m[39m
       [32mâœ“[39m should include confidence scores for suggestions[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate date range correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should initialize scheduler without error[32m 1[2mms[22m[39m
       [32mâœ“[39m should schedule prep 30 minutes before events[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate next check interval[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for meeting prep prompt[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate tokens for optimal time prompt[32m 0[2mms[22m[39m
       [32mâœ“[39m should cost ~$0.0025 for meeting prep[32m 0[2mms[22m[39m
       [32mâœ“[39m should cost ~$0.0080 for optimal time finding[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should combine to ~$0.0105 per day if called twice each[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m should validate event has required fields[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate attendee email addresses[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle events with no description[32m 0[2mms[22m[39m
       [32mâœ“[39m should ensure end time is after start time[32m 0[2mms[22m[39m
       [32mâœ“[39m should integrate with router client[32m 0[2mms[22m[39m
       [32mâœ“[39m should pass correct parameters to AI provider[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing optional fields gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle large attendee lists[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle long event descriptions[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle date ranges spanning multiple weeks[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing user ID[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle invalid date range[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle empty attendee list[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/batching/batch-executor.test.ts [2m([22m[2m21 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 16[2mms[22m[39m
       [32mâœ“[39m should create a parallel batch[32m 2[2mms[22m[39m
       [32mâœ“[39m should create a sequential batch[32m 0[2mms[22m[39m
       [32mâœ“[39m should create a conditional batch with dependencies[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle large batch creation[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate total cost for batch operations[32m 0[2mms[22m[39m
       [32mâœ“[39m should keep costs under budget[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should execute a batch successfully[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should track operation completion events[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle batch execution failure gracefully[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should retrieve batch status[32m 0[2mms[22m[39m
       [32mâœ“[39m should retrieve batch history for user[32m 0[2mms[22m[39m
       [32mâœ“[39m should limit batch history results[32m 0[2mms[22m[39m
       [32mâœ“[39m should support parallel execution with multiple concurrent operations[32m 0[2mms[22m[39m
       [32mâœ“[39m should support sequential execution with ordered operations[32m 0[2mms[22m[39m
       [32mâœ“[39m should support conditional execution with dependencies[32m 0[2mms[22m[39m
       [32mâœ“[39m should preserve operation parameters[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle empty parameters[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle complex nested parameters[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle invalid batch type gracefully[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle missing batch gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m should track failed operations[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/preferences/preferences.service.test.ts [2m([22m[2m24 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 61[2mms[22m[39m
       [32mâœ“[39m should get operation preferences for user[32m 28[2mms[22m[39m
       [32mâœ“[39m should get specific operation preference[32m 1[2mms[22m[39m
       [32mâœ“[39m should set operation preference with model selection[32m 1[2mms[22m[39m
       [32mâœ“[39m should set operation preference with budget[32m 16[2mms[22m[39m
       [32mâœ“[39m should set operation preference with default parameters[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should bulk update operation preferences[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m should disable individual operation[32m 0[2mms[22m[39m
       [32mâœ“[39m should get remaining budget for operation[32m 0[2mms[22m[39m
       [32mâœ“[39m should check if operation is within budget[32m 0[2mms[22m[39m
       [32mâœ“[39m should get theme preferences[32m 0[2mms[22m[39m
       [32mâœ“[39m should set theme with color scheme[32m 0[2mms[22m[39m
       [32mâœ“[39m should set theme with accent color[32m 0[2mms[22m[39m
       [32mâœ“[39m should set compact mode[32m 0[2mms[22m[39m
       [32mâœ“[39m should set layout preferences[32m 0[2mms[22m[39m
       [32mâœ“[39m should set notification preferences[32m 0[2mms[22m[39m
       [32mâœ“[39m should set sidebar state[32m 0[2mms[22m[39m
       [32mâœ“[39m should merge theme updates[32m 0[2mms[22m[39m
       [32mâœ“[39m should reset all preferences to defaults[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate model options[32m 1[2mms[22m[39m
       [32mâœ“[39m should track monthly budget[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate remaining budget correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should prevent overspend for operation[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle missing user gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle invalid operation ID gracefully[32m 0[2mms[22m[39m
(node:46112) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 [31mâ¯[39m src/components/TenantProvider.test.tsx [2m([22m[2m13 tests[22m[2m | [22m[31m13 failed[39m[2m)[22m[32m 10[2mms[22m[39m
[31m       [31mÃ—[31m should show loading state initially[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should load user tenants on mount[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create default tenant if none exist[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle database errors gracefully[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should switch to different tenant[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should deny access to unauthorized tenant[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should create new tenant[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should throw if user not authenticated[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should persist tenant selection in localStorage[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should restore previous tenant on reload[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should display error message on load failure[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle missing user gracefully[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should throw when useTenant used outside TenantProvider[39m[32m 0[2mms[22m[39m
 [31mâ¯[39m src/services/__tests__/phase3-integration.test.ts [2m([22m[2m13 tests[22m[2m | [22m[33m13 skipped[39m[2m)[22m[32m 6[2mms[22m[39m
       [2m[90mâ†“[39m[22m should create a custom tool
       [2m[90mâ†“[39m[22m should retrieve tool metadata
       [2m[90mâ†“[39m[22m should list user tools
       [2m[90mâ†“[39m[22m should track tool usage
       [2m[90mâ†“[39m[22m should create a composite skill
       [2m[90mâ†“[39m[22m should retrieve skill metadata
       [2m[90mâ†“[39m[22m should list user skills
       [2m[90mâ†“[39m[22m should record skill execution
       [2m[90mâ†“[39m[22m should create synthesis job
       [2m[90mâ†“[39m[22m should detect memory patterns
       [2m[90mâ†“[39m[22m should create synthesis recommendation
       [2m[90mâ†“[39m[22m should execute complete pipeline: tool â†’ skill â†’ synthesis
       [2m[90mâ†“[39m[22m should have proper RLS policies
[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mInitialization[2m > [22m[2mshould initialize Redis connection successfully
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mInitialization[2m > [22m[2mshould disable caching when not initialized
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mInitialization[2m > [22m[2mshould disable caching when not initialized
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould cache and retrieve data
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould return null for missing keys
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould support cache-aside pattern (get or fetch)
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould delete specific cache keys
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould delete multiple keys matching pattern
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould invalidate all user caches
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Operations[2m > [22m[2mshould flush all caches
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mTTL Management[2m > [22m[2mshould respect TTL expiration
[22m[39m[CacheService] Redis connected and ready

Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:75:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:75:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mErrorBoundary[2m > [22m[2mshould render default fallback on error
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:69:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:75:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:69:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:91:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:91:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mErrorBoundary[2m > [22m[2mshould render custom fallback
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:87:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:91:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:87:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:105:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:105:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mErrorBoundary[2m > [22m[2mshould render fallback function with error and reset
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:108:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:105:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:108:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:124:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:124:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mErrorBoundary[2m > [22m[2mshould call custom onError handler
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:135:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:124:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:135:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Detailed error message
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:139:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Detailed error message
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:139:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mErrorBoundary[2m > [22m[2mshould display error details in development
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:155:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Detailed error message
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:139:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:155:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:155:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:155:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mErrorBoundary[2m > [22m[2mshould include try again button in default fallback
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:173:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Test error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:155:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:173:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:188:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:188:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mSafeComponent[2m > [22m[2mshould render fallback on error
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:211:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:188:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:211:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)
[SafeComponent] TestComponent failed: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:188:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:203:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:203:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mSafeComponent[2m > [22m[2mshould use custom fallback
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:229:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:203:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:229:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)
[SafeComponent] TestComponent failed: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:203:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:220:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:220:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mSafeComponent[2m > [22m[2mshould log error with component name
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:261:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:220:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:261:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)
[SafeComponent] TestComponent failed: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:220:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:235:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:235:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould initialize tracing when enabled
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould initialize tracing when enabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould not initialize tracing when disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould not initialize tracing when disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould only initialize once
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould only initialize once
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mInitialization[2m > [22m[2mshould handle initialization errors gracefully
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mShutdown[2m > [22m[2mshould shutdown tracing gracefully
[22m[39m[OpenTelemetry] Tracing initialized successfully
[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mShutdown[2m > [22m[2mshould shutdown tracing gracefully
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mShutdown[2m > [22m[2mshould handle shutdown errors gracefully
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mShutdown[2m > [22m[2mshould handle shutdown errors gracefully
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mShutdown[2m > [22m[2mshould disable tracing after shutdown
[22m[39m[OpenTelemetry] Tracing initialized successfully
[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mShutdown[2m > [22m[2mshould disable tracing after shutdown
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracer Creation[2m > [22m[2mshould create tracer with service name
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracer Creation[2m > [22m[2mshould create tracer with version
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracer Creation[2m > [22m[2mshould use service name in tracer
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould trace async operation with success
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould trace async operation with success
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set string attributes
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set string attributes
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mSafeComponent[2m > [22m[2mshould use default component name
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:277:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:235:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:277:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)
[SafeComponent] Component failed: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:235:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set numeric attributes
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set numeric attributes
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set boolean attributes
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set boolean attributes
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould handle operation errors
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould handle operation errors
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould record exception on error
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould record exception on error
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould end span after operation
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould end span after operation
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould use no-op span when tracing disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould use no-op span when tracing disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set OK status on success
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mAsync Span Tracing[2m > [22m[2mshould set OK status on success
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould trace synchronous operation with success
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould trace synchronous operation with success
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould set attributes for sync operations
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould set attributes for sync operations
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould handle sync operation errors
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould handle sync operation errors
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould record exception on sync error
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould record exception on sync error
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould use no-op span when tracing disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSync Span Tracing[2m > [22m[2mshould use no-op span when tracing disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Extraction[2m > [22m[2mshould extract valid W3C trace context
[22m[39m[OpenTelemetry] Tracing shutdown complete

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:251:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Extraction[2m > [22m[2mshould handle missing traceparent
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Extraction[2m > [22m[2mshould handle null headers
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Extraction[2m > [22m[2mshould handle malformed traceparent
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Extraction[2m > [22m[2mshould parse complete trace format
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould inject span context into headers when enabled
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould inject span context into headers when enabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould add traceparent header when enabled
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould add traceparent header when enabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:251:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould not modify headers when tracing disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould not modify headers when tracing disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould preserve existing headers
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mSpan Context Injection[2m > [22m[2mshould preserve existing headers
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mEvent Recording[2m > [22m[2mshould add event when tracing enabled
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mEvent Recording[2m > [22m[2mshould add event when tracing enabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mEvent Recording[2m > [22m[2mshould not add event when tracing disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mEvent Recording[2m > [22m[2mshould not add event when tracing disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mEvent Recording[2m > [22m[2mshould support event attributes
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mEvent Recording[2m > [22m[2mshould support event attributes
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mSafeComponent[2m > [22m[2mshould handle multiple SafeComponents independently
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:295:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:251:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:295:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)
    at SafeComponent (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:159:3)
[SafeComponent] Component2 failed: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:251:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould trace batch of operations
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould trace batch of operations
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould set batch size attribute
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould set batch size attribute
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould record operation completion events
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould record operation completion events
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould handle batch operation errors
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould handle batch operation errors
[22m[39m[OpenTelemetry] Tracing shutdown complete

Error: Critical error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:278:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould record operation failure events
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould record operation failure events
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould support batch attributes
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mBatch Operations[2m > [22m[2mshould support batch attributes
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return false when not initialized
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return true when initialized and enabled
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return true when initialized and enabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return false when initialized but disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return false when initialized but disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return false after shutdown
[22m[39m[OpenTelemetry] Tracing initialized successfully
[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mTracing Status[2m > [22m[2mshould return false after shutdown
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould trace database query
[22m[39m[OpenTelemetry] Tracing initialized successfully

Error: Critical error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:278:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mError Boundary Integration[2m > [22m[2mshould prevent error from crashing app
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:334:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Critical error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:278:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:334:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:292:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:292:13)
    at renderWithHooks (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
    at mountIndeterminateComponent (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
    at beginWork (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (C:\Users\Specter\Desktop\Helix\web\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
    at innerInvokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:360:16)
    at invokeEventListeners (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:296:3)
    at HTMLUnknownElementImpl._dispatch (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:243:9)
    at HTMLUnknownElementImpl.dispatchEvent (C:\Users\Specter\Desktop\Helix\web\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:114:17)
[90mstderr[2m | src/components/ErrorBoundary.test.tsx[2m > [22m[2mError Boundary Integration[2m > [22m[2mshould maintain app state around error boundary
[22m[39mThe above error occurred in the <ThrowError> component:

    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:352:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

React will try to recreate this component tree from scratch using the error boundary you provided, MockErrorBoundary.
[ErrorBoundary] React error: Error: Component error
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:292:13)
    at renderWithHooks [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:20103:13[90m)[39m
    at beginWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:21626:16[90m)[39m
    at beginWork$1 [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:27465:14[90m)[39m
    at performUnitOfWork [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26599:12[90m)[39m
    at workLoopSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26505:5[90m)[39m
    at renderRootSync [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:26473:7[90m)[39m
    at recoverFromConcurrentError [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25889:20[90m)[39m
    at performConcurrentWorkOnRoot [90m(C:\Users\Specter\Desktop\Helix\web\[39mnode_modules\[4mreact-dom[24m\cjs\react-dom.development.js:25789:22[90m)[39m
[ErrorBoundary] Component stack: 
    at ThrowError (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:352:13)
    at MockErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.test.tsx:6:7)
    at ErrorBoundary (C:/Users/Specter/Desktop/Helix/web/src/components/ErrorBoundary.tsx:9:26)

 [32mâœ“[39m src/components/ErrorBoundary.test.tsx [2m([22m[2m15 tests[22m[2m)[22m[32m 179[2mms[22m[39m
[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould trace database query
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould trace API call
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould trace API call
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould trace cache operations
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould trace cache operations
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle nested span contexts
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle nested span contexts
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mError Handling[2m > [22m[2mshould not throw on initialization with error
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mError Handling[2m > [22m[2mshould not throw on initialization with error
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mError Handling[2m > [22m[2mshould gracefully handle null attributes
[22m[39m[OpenTelemetry] Tracing initialized successfully

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mError Handling[2m > [22m[2mshould gracefully handle null attributes
[22m[39m[OpenTelemetry] Tracing shutdown complete

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mError Handling[2m > [22m[2mshould gracefully handle tracing when disabled
[22m[39m[OpenTelemetry] Tracing disabled in configuration

[90mstdout[2m | src/lib/tracing/otel-init.test.ts[2m > [22m[2mOpenTelemetry Tracing[2m > [22m[2mError Handling[2m > [22m[2mshould gracefully handle tracing when disabled
[22m[39m[OpenTelemetry] Tracing shutdown complete

 [32mâœ“[39m src/lib/tracing/otel-init.test.ts [2m([22m[2m53 tests[22m[2m)[22m[32m 44[2mms[22m[39m
 [32mâœ“[39m src/__tests__/Phase3-RPC.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 439[2mms[22m[39m
       [33m[2mâœ“[22m[39m throws after max retries exceeded [33m 320[2mms[22m[39m
 [32mâœ“[39m src/components/secrets/__tests__/CopyButton.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 277[2mms[22m[39m
 [32mâœ“[39m src/services/__tests__/phase8-e2e.test.ts [2m([22m[2m28 tests[22m[2m)[22m[33m 598[2mms[22m[39m
 [32mâœ“[39m src/components/secrets/modals/__tests__/RotateSecretModal.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 419[2mms[22m[39m
 [32mâœ“[39m src/hooks/__tests__/useSecretsSubscription.test.ts [2m([22m[2m4 tests[22m[2m)[22m[33m 320[2mms[22m[39m
 [32mâœ“[39m src/pages/__tests__/SecretsPage.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 233[2mms[22m[39m
 [32mâœ“[39m src/__tests__/MobileComponents.test.tsx [2m([22m[2m22 tests[22m[2m)[22m[33m 480[2mms[22m[39m
 [32mâœ“[39m src/components/secrets/__tests__/SecretListItem.test.tsx [2m([22m[2m16 tests[22m[2m)[22m[33m 410[2mms[22m[39m
[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mTTL Management[2m > [22m[2mshould set long TTL for analytics data (1 hour)
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mTTL Management[2m > [22m[2mshould set short TTL for preferences (15 minutes)
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mCache Statistics[2m > [22m[2mshould report cache statistics
[22m[39m[CacheService] Redis connected and ready

 [32mâœ“[39m src/pages/RealtimeMonitoringDashboard.test.tsx [2m([22m[2m16 tests[22m[2m)[22m[33m 630[2mms[22m[39m
[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mError Handling[2m > [22m[2mshould handle cache operations gracefully when Redis is down
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mError Handling[2m > [22m[2mshould handle JSON serialization errors
[22m[39m[CacheService] Redis connected and ready

[90mstderr[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mError Handling[2m > [22m[2mshould handle JSON serialization errors
[22m[39m[CacheService] Failed to set cache key circular: TypeError: Converting circular structure to JSON
    --> starting at object with constructor 'Object'
    --- property 'self' closes the circle
    at JSON.stringify (<anonymous>)
    at CacheService.set (C:/Users/Specter/Desktop/Helix/web/src/lib/cache/redis-cache.ts:60:31)
    at C:/Users/Specter/Desktop/Helix/web/src/lib/cache/redis-cache.test.ts:316:21
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mSingleton Pattern[2m > [22m[2mshould provide singleton instance
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mConcurrent Operations[2m > [22m[2mshould handle concurrent cache operations
[22m[39m[CacheService] Redis connected and ready

[90mstdout[2m | src/lib/cache/redis-cache.test.ts[2m > [22m[2mCacheService[2m > [22m[2mConcurrent Operations[2m > [22m[2mshould handle concurrent get and set operations
[22m[39m[CacheService] Redis connected and ready

 [32mâœ“[39m src/lib/cache/redis-cache.test.ts [2m([22m[2m18 tests[22m[2m)[22m[33m 1148[2mms[22m[39m
       [33m[2mâœ“[22m[39m should respect TTL expiration [33m 1116[2mms[22m[39m
 [32mâœ“[39m src/components/secrets/__tests__/SecretsList.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 43[2mms[22m[39m
 [32mâœ“[39m src/services/voice-commands.test.ts [2m([22m[2m41 tests[22m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m src/services/memory-synthesis.test.ts [2m([22m[2m59 tests[22m[2m)[22m[32m 32[2mms[22m[39m
[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendInvitationEmail[2m > [22m[2mshould send invitation email with correct template
[22m[39mðŸ“§ Email prepared: {
  to: [32m'newuser@example.com'[39m,
  subject: [32m"You're invited to join Test Team"[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendInvitationEmail[2m > [22m[2mshould send invitation email with correct template
[22m[39mâœ“ Invitation email sent to newuser@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendInvitationEmail[2m > [22m[2mshould include correct token in invitation link
[22m[39mðŸ“§ Email prepared: { to: [32m'user@example.com'[39m, subject: [32m"You're invited to join Team"[39m }

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendInvitationEmail[2m > [22m[2mshould include correct token in invitation link
[22m[39mâœ“ Invitation email sent to user@example.com

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendInvitationEmail[2m > [22m[2mshould throw on email service failure
[22m[39mFailed to send invitation email to invalid@: Error: Email service down
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.test.ts:49:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendAcceptanceEmail[2m > [22m[2mshould send acceptance confirmation to inviter
[22m[39mðŸ“§ Email prepared: {
  to: [32m'inviter@example.com'[39m,
  subject: [32m'New Member accepted your invitation'[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendAcceptanceEmail[2m > [22m[2mshould send acceptance confirmation to inviter
[22m[39mâœ“ Acceptance notification sent to inviter@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendAcceptanceEmail[2m > [22m[2mshould include invitee name in acceptance email
[22m[39mðŸ“§ Email prepared: {
  to: [32m'admin@example.com'[39m,
  subject: [32m'Jane Smith accepted your invitation'[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendAcceptanceEmail[2m > [22m[2mshould include invitee name in acceptance email
[22m[39mâœ“ Acceptance notification sent to admin@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendAcceptanceEmail[2m > [22m[2mshould handle missing invitee name
[22m[39mðŸ“§ Email prepared: {
  to: [32m'admin@example.com'[39m,
  subject: [32m'user@example.com accepted your invitation'[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendAcceptanceEmail[2m > [22m[2mshould handle missing invitee name
[22m[39mâœ“ Acceptance notification sent to admin@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendRejectionEmail[2m > [22m[2mshould send rejection notification to inviter
[22m[39mðŸ“§ Email prepared: { to: [32m'inviter@example.com'[39m, subject: [32m'User declined your invitation'[39m }

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendRejectionEmail[2m > [22m[2mshould send rejection notification to inviter
[22m[39mâœ“ Rejection notification sent to inviter@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendRejectionEmail[2m > [22m[2mshould include tenant name in rejection email
[22m[39mðŸ“§ Email prepared: {
  to: [32m'admin@example.com'[39m,
  subject: [32m'user@example.com declined your invitation'[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendRejectionEmail[2m > [22m[2mshould include tenant name in rejection email
[22m[39mâœ“ Rejection notification sent to admin@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould send reminder email for pending invitation
[22m[39mðŸ“§ Email prepared: {
  to: [32m'user@example.com'[39m,
  subject: [32m"Reminder: You're invited to join Team"[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould send reminder email for pending invitation
[22m[39mâœ“ Reminder email sent to user@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould include days old in reminder message
[22m[39mðŸ“§ Email prepared: {
  to: [32m'user@example.com'[39m,
  subject: [32m"Reminder: You're invited to join Team"[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould include days old in reminder message
[22m[39mâœ“ Reminder email sent to user@example.com

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould not throw if reminder fails
[22m[39mFailed to send reminder email: Error: Service down
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.test.ts:139:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mnotifyDiscord[2m > [22m[2mshould send invite_sent notification to Discord
[22m[39mâœ“ Discord notification sent for event: invite_sent

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mnotifyDiscord[2m > [22m[2mshould send invite_accepted notification to Discord
[22m[39mâœ“ Discord notification sent for event: invite_accepted

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mnotifyDiscord[2m > [22m[2mshould send invite_rejected notification to Discord
[22m[39mâœ“ Discord notification sent for event: invite_rejected

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mnotifyDiscord[2m > [22m[2mshould throw on Discord API failure
[22m[39mFailed to send Discord notification: Error: Discord webhook failed: Unauthorized
    at InvitationNotifierService.notifyDiscord (C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.ts:144:15)
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mnotifyDiscord[2m > [22m[2mshould throw on fetch error
[22m[39mFailed to send Discord notification: Error: Network error
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.test.ts:211:51
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould generate valid invitation email template
[22m[39mðŸ“§ Email prepared: { to: [32m'user@example.com'[39m, subject: [32m"You're invited to join Test Team"[39m }

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould generate valid invitation email template
[22m[39mâœ“ Invitation email sent to user@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould include inviter name in template
[22m[39mðŸ“§ Email prepared: { to: [32m'user@example.com'[39m, subject: [32m"You're invited to join Team"[39m }

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould include inviter name in template
[22m[39mâœ“ Invitation email sent to user@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould include 6-hour expiry in invitation email
[22m[39mðŸ“§ Email prepared: { to: [32m'user@example.com'[39m, subject: [32m"You're invited to join Team"[39m }

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould include 6-hour expiry in invitation email
[22m[39mâœ“ Invitation email sent to user@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould include team name in all templates
[22m[39mðŸ“§ Email prepared: {
  to: [32m'user@example.com'[39m,
  subject: [32m"You're invited to join My Custom Team"[39m
}

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mEmail template generation[2m > [22m[2mshould include team name in all templates
[22m[39mâœ“ Invitation email sent to user@example.com

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mDiscord embed generation[2m > [22m[2mshould create green embed for invite_sent
[22m[39mâœ“ Discord notification sent for event: invite_sent

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mDiscord embed generation[2m > [22m[2mshould create red embed for invite_rejected
[22m[39mâœ“ Discord notification sent for event: invite_rejected

[90mstdout[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mDiscord embed generation[2m > [22m[2mshould include timestamp in Discord embed
[22m[39mâœ“ Discord notification sent for event: invite_sent

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mError handling[2m > [22m[2mshould handle email service errors gracefully
[22m[39mFailed to send invitation email to user@example.com: Error: SMTP connection failed
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.test.ts:334:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mError handling[2m > [22m[2mshould not throw on reminder email failure
[22m[39mFailed to send reminder email: Error: Email service down
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.test.ts:348:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/services/tenant/invitation-notifier.test.ts[2m > [22m[2mInvitationNotifierService[2m > [22m[2mError handling[2m > [22m[2mshould handle missing webhook URL
[22m[39mFailed to send Discord notification: Error: Invalid URL
    at C:/Users/Specter/Desktop/Helix/web/src/services/tenant/invitation-notifier.test.ts:361:51
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

 [32mâœ“[39m src/services/tenant/invitation-notifier.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m src/services/voicemail.test.ts [2m([22m[2m49 tests[22m[2m)[22m[32m 32[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mSecret Loading with Fallback[2m > [22m[2mshould load DeepSeek API Key from 1Password or .env
[22m[39mâœ“ DeepSeek API Key loaded successfully

[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mSecret Loading with Fallback[2m > [22m[2mshould load Gemini API Key from 1Password or .env
[22m[39mâœ“ Gemini API Key loaded successfully

[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mSecret Loading with Fallback[2m > [22m[2mshould load Supabase credentials from 1Password or .env
[22m[39mâœ“ Supabase credentials loaded successfully

[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mSecret Loading with Fallback[2m > [22m[2mshould cache secrets after first load
[22m[39mâœ“ Secret caching works correctly

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mEmotionDetectionService with 1Password[2m > [22m[2mshould reject empty messages array
[22m[39mFailed to analyze conversation: Error: Messages array cannot be empty
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:18:15)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:173:23
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m

 [32mâœ“[39m src/services/__tests__/embedding.mock.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 25[2mms[22m[39m
[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mEmotionDetectionService with 1Password[2m > [22m[2mshould require DeepSeek API Key for emotion analysis
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:192:24
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:192:38
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mEmotionDetectionService with 1Password[2m > [22m[2mshould require DeepSeek API Key for emotion analysis
[22m[39mâš  Emotion analysis requires valid API key

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mTopicExtractionService with 1Password[2m > [22m[2mshould require DeepSeek API Key for topic extraction
[22m[39mFailed to extract topics: TypeError: Failed to parse URL from /api/topic-extraction
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:233:24
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at TopicExtractionService.extractTopics (C:/Users/Specter/Desktop/Helix/web/src/services/topic-extraction.ts:20:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:233:38
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/topic-extraction'[39m
  }
}

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mTopicExtractionService with 1Password[2m > [22m[2mshould require DeepSeek API Key for topic extraction
[22m[39mâš  Topic extraction requires valid API key

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mEmbeddingService with 1Password[2m > [22m[2mshould require Gemini API Key for embedding generation
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:301:27
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:301:41
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mEmbeddingService with 1Password[2m > [22m[2mshould require Gemini API Key for embedding generation
[22m[39mâš  Embedding generation requires valid Gemini API key

[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mServices Initialization Order[2m > [22m[2mshould initialize all services in correct order
[22m[39mâœ“ All services initialized successfully

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mAPI Key Caching Strategy[2m > [22m[2mshould cache DeepSeek API Key in memory
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:373:11
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:373:25
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mAPI Key Caching Strategy[2m > [22m[2mshould reuse cached Gemini API Key across calls
[22m[39mFailed to generate embedding: TypeError: Failed to parse URL from /api/embedding
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:391:28
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmbeddingService.generateEmbedding (C:/Users/Specter/Desktop/Helix/web/src/services/embedding.ts:16:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:391:42
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/embedding'[39m
  }
}

[90mstdout[2m | src/services/alerting/sla-tracker.test.ts[2m > [22m[2mSLATracker[2m > [22m[2mEvaluation Loop[2m > [22m[2mshould start evaluation loop
[22m[39m[SLATracker] Started evaluation loop (every 5s)
[SLATracker] Stopped evaluation loop

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mAPI Key Caching Strategy[2m > [22m[2mshould reuse cached Gemini API Key across calls
[22m[39mâš  Embedding caching test skipped (API unavailable)

[90mstdout[2m | src/services/alerting/sla-tracker.test.ts[2m > [22m[2mSLATracker[2m > [22m[2mEvaluation Loop[2m > [22m[2mshould stop evaluation loop
[22m[39m[SLATracker] Started evaluation loop (every 5s)
[SLATracker] Stopped evaluation loop

[90mstdout[2m | src/services/alerting/sla-tracker.test.ts[2m > [22m[2mSLATracker[2m > [22m[2mEvaluation Loop[2m > [22m[2mshould handle multiple users in evaluation
[22m[39m[SLATracker] Started evaluation loop (every 5s)
[SLATracker] Stopped evaluation loop

[90mstderr[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mError Handling with Missing Secrets[2m > [22m[2mshould handle API errors gracefully when secrets unavailable
[22m[39mFailed to analyze conversation: TypeError: Failed to parse URL from /api/emotion-detection
[90m    at node:internal/deps/undici/undici:16416:13[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:24)
    at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:424:9
    at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
  [cause]: TypeError: Invalid URL
  [90m    at new URL (node:internal/url:819:25)[39m
      at new URL$1 [90m(file:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4mvitest[24m/dist/chunks/index.CyBMJtT7.js:556:9[90m)[39m
  [90m    at new Request (node:internal/deps/undici/undici:10971:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:11891:25)[39m
  [90m    at fetch (node:internal/deps/undici/undici:16414:10)[39m
  [90m    at fetch (node:internal/bootstrap/web/exposed-window-or-worker:83:12)[39m
      at EmotionDetectionService.analyzeConversation (C:/Users/Specter/Desktop/Helix/web/src/services/emotion-detection.ts:22:30)
      at C:/Users/Specter/Desktop/Helix/web/src/services/__tests__/services-with-1password.test.ts:424:23
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
      at [90mfile:///C:/Users/Specter/Desktop/Helix/web/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26 {
    code: [32m'ERR_INVALID_URL'[39m,
    input: [32m'/api/emotion-detection'[39m
  }
}

[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mFull Integration Pipeline[2m > [22m[2mshould initialize all services without errors
[22m[39mâœ… Full integration pipeline initialized successfully

[90mstdout[2m | src/services/__tests__/services-with-1password.test.ts[2m > [22m[2mServices Integration with 1Password[2m > [22m[2mEnvironment Variable Fallback[2m > [22m[2mshould read from .env when 1Password CLI unavailable
[22m[39mAvailable fallback env vars: 3/4

 [32mâœ“[39m src/services/__tests__/services-with-1password.test.ts [2m([22m[2m45 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m src/services/alerting/sla-tracker.test.ts [2m([22m[2m31 tests[22m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m src/services/audit/audit-export.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 18[2mms[22m[39m
[90mstdout[2m | src/middleware/role-middleware.test.ts[2m > [22m[2mRole Middleware[2m > [22m[2mrequireRole Middleware[2m > [22m[2mshould allow user with required role
[22m[39mâœ“ Permission check passed: admin >= member for user-123

[90mstdout[2m | src/middleware/role-middleware.test.ts[2m > [22m[2mRole Middleware[2m > [22m[2mrequireRole Middleware[2m > [22m[2mshould allow user with higher role
[22m[39mâœ“ Permission check passed: owner >= member for user-123

 [32mâœ“[39m src/middleware/role-middleware.test.ts [2m([22m[2m36 tests[22m[2m)[22m[32m 15[2mms[22m[39m
 [32mâœ“[39m src/services/analytics-intelligence.test.ts [2m([22m[2m52 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m src/components/secrets/modals/__tests__/CreateSecretModal.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[33m 2681[2mms[22m[39m
     [33m[2mâœ“[22m[39m should call onCreate with form data when submitted [33m 458[2mms[22m[39m
     [33m[2mâœ“[22m[39m should reset form after successful creation [33m 458[2mms[22m[39m
     [33m[2mâœ“[22m[39m should handle expiration date selection [33m 1287[2mms[22m[39m
 [32mâœ“[39m src/services/calendar-phase5.test.ts [2m([22m[2m45 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m src/services/sandbox-security.test.ts [2m([22m[2m56 tests[22m[2m)[22m[32m 15[2mms[22m[39m
 [32mâœ“[39m src/services/task-management.test.ts [2m([22m[2m42 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/services/analytics/analytics.service.test.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32mâœ“[39m src/services/__tests__/all-phases-integration.test.ts [2m([22m[2m44 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/services/calendar-events.test.ts [2m([22m[2m32 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mâœ“[39m src/services/custom-tools.test.ts [2m([22m[2m46 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32mâœ“[39m src/services/voice-search.test.ts [2m([22m[2m40 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32mâœ“[39m src/__tests__/Phase2.e2e.test.ts [2m([22m[2m32 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/services/task-phase5.test.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mâœ“[39m src/services/calendar-accounts.test.ts [2m([22m[2m30 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mâœ“[39m src/services/composite-skills.test.ts [2m([22m[2m37 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/services/__tests__/week1-integration.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m src/services/email-phase5.test.ts [2m([22m[2m31 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mâœ“[39m src/lib/stores/__tests__/secrets-store.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m src/lib/api/secrets.test.ts [2m([22m[2m52 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m src/services/__tests__/emotion-detection.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m src/__tests__/EmailClient.test.tsx [2m([22m[2m34 tests[22m[2m)[22m[33m 5780[2mms[22m[39m
     [33m[2mâœ“[22m[39m validates email addresses [33m 1275[2mms[22m[39m
     [33m[2mâœ“[22m[39m calls onSend with correct data [33m 1660[2mms[22m[39m
     [33m[2mâœ“[22m[39m shows loading state while sending [33m 694[2mms[22m[39m
     [33m[2mâœ“[22m[39m displays error when API call fails [33m 675[2mms[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Suites 1 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase3-integration.test.ts[2m > [22mPhase 3 Integration Tests
[31m[1mTypeError[22m: supabase.auth.getUser is not a function[39m
[36m [2mâ¯[22m src/services/__tests__/phase3-integration.test.ts:[2m22:70[22m[39m
    [90m 20| [39m  [34mbeforeAll[39m([35masync[39m () [33m=>[39m {
    [90m 21| [39m    [90m// Get authenticated user[39m
    [90m 22| [39m    const { data: { user }, error: authError } = await supabase.auth.gâ€¦
    [90m   | [39m                                                                     [31m^[39m
    [90m 23| [39m    [35mif[39m (authError [33m||[39m [33m![39muser) {
    [90m 24| [39m      [35mthrow[39m [35mnew[39m [33mError[39m([32m'Authentication failed for tests'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/454]âŽ¯[22m[39m


[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 388 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m src/components/InvitationAccept.test.tsx[2m > [22mInvitationAccept[2m > [22mshould show error when no token provided
[31m[1mTypeError[22m: useSearchParams.mockReturnValue is not a function[39m
[36m [2mâ¯[22m src/components/InvitationAccept.test.tsx:[2m267:21[22m[39m
    [90m265| [39m  [34mit[39m([32m'should show error when no token provided'[39m[33m,[39m () [33m=>[39m {
    [90m266| [39m    [35mconst[39m { useSearchParams } [33m=[39m [34mrequire[39m([32m'react-router-dom'[39m)[33m;[39m
    [90m267| [39m    useSearchParams[33m.[39m[34mmockReturnValue[39m([
    [90m   | [39m                    [31m^[39m
    [90m268| [39m      [35mnew[39m [33mURLSearchParams[39m([32m''[39m)[33m,[39m
    [90m269| [39m      vi[33m.[39m[34mfn[39m()[33m,[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/InviteMembers.test.tsx[2m > [22mInviteMembers[2m > [22mshould have role selector with three options
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the display value: member.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"bg-white border border-gray-200 rounded-lg p-6 space-y-6"[31m
    [36m>[31m
      [36m<div>[31m
        [36m<h2[31m
          [33mclass[31m=[32m"text-xl font-bold text-gray-900"[31m
        [36m>[31m
          [0mInvite Team Member[0m
        [36m</h2>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600 text-sm mt-1"[31m
        [36m>[31m
          [0mSend an invitation link to add someone to your team[0m
        [36m</p>[31m
      [36m</div>[31m
      [36m<form[31m
        [33mclass[31m=[32m"space-y-4"[31m
      [36m>[31m
        [36m<div>[31m
          [36m<label[31m
            [33mclass[31m=[32m"block text-sm font-medium text-gray-900 mb-2"[31m
          [36m>[31m
            [0mEmail Address[0m
          [36m</label>[31m
          [36m<input[31m
            [33mclass[31m=[32m"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed"[31m
            [33mplaceholder[31m=[32m"user@example.com"[31m
            [33mtype[31m=[32m"email"[31m
            [33mvalue[31m=[32m""[31m
          [36m/>[31m
        [36m</div>[31m
        [36m<div>[31m
          [36m<label[31m
            [33mclass[31m=[32m"block text-sm font-medium text-gray-900 mb-2"[31m
          [36m>[31m
            [0mRole[0m
          [36m</label>[31m
          [36m<select[31m
            [33mclass[31m=[32m"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed"[31m
          [36m>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"viewer"[31m
            [36m>[31m
              [0mViewer (Read-only)[0m
            [36m</option>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"member"[31m
            [36m>[31m
              [0mMember (Can use operations)[0m
            [36m</option>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"admin"[31m
            [36m>[31m
              [0mAdmin (Can invite & manage)[0m
            [36m</option>[31m
          [36m</select>[31m
          [36m<p[31m
            [33mclass[31m=[32m"text-xs text-gray-600 mt-2"[31m
          [36m>[31m
            [0mCan use all operations and see analytics[0m
          [36m</p>[31m
        [36m</div>[31m
        [36m<button[31m
          [33mclass[31m=[32m"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"[31m
          [33mdisabled[31m=[32m""[31m
          [33mtype[31m=[32m"submit"[31m
        [36m>[31m
          [0mSend Invitation[0m
        [36m</button>[31m
      [36m</form>[31m
      [36m<div[31m
        [33mclass[31m=[32m"bg-blue-50 border border-blue-200 rounded-lg p-4"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-sm text-blue-800"[31m
        [36m>[31m
          [36m<strong>[31m
            [0mTip:[0m
          [36m</strong>[31m
          [0m Invitations expire in 6 hours. The invited user will receive a link to join your team.[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/InviteMembers.test.tsx:[2m41:31[22m[39m
    [90m 39| [39m    [34mrender[39m([33m<[39m[33mInviteMembers[39m [33mtenantId[39m[33m=[39m[33m{[39mmockTenantId[33m}[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m 40| [39m
    [90m 41| [39m    const roleSelect = screen.getByDisplayValue('member') as HTMLSelecâ€¦
    [90m   | [39m                              [31m^[39m
    [90m 42| [39m    [34mexpect[39m(roleSelect)[33m.[39m[34mtoBeInTheDocument[39m()[33m;[39m
    [90m 43| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/InviteMembers.test.tsx[2m > [22mInviteMembers[2m > [22mshould update role description when role changes
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the display value: member.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"bg-white border border-gray-200 rounded-lg p-6 space-y-6"[31m
    [36m>[31m
      [36m<div>[31m
        [36m<h2[31m
          [33mclass[31m=[32m"text-xl font-bold text-gray-900"[31m
        [36m>[31m
          [0mInvite Team Member[0m
        [36m</h2>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600 text-sm mt-1"[31m
        [36m>[31m
          [0mSend an invitation link to add someone to your team[0m
        [36m</p>[31m
      [36m</div>[31m
      [36m<form[31m
        [33mclass[31m=[32m"space-y-4"[31m
      [36m>[31m
        [36m<div>[31m
          [36m<label[31m
            [33mclass[31m=[32m"block text-sm font-medium text-gray-900 mb-2"[31m
          [36m>[31m
            [0mEmail Address[0m
          [36m</label>[31m
          [36m<input[31m
            [33mclass[31m=[32m"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed"[31m
            [33mplaceholder[31m=[32m"user@example.com"[31m
            [33mtype[31m=[32m"email"[31m
            [33mvalue[31m=[32m""[31m
          [36m/>[31m
        [36m</div>[31m
        [36m<div>[31m
          [36m<label[31m
            [33mclass[31m=[32m"block text-sm font-medium text-gray-900 mb-2"[31m
          [36m>[31m
            [0mRole[0m
          [36m</label>[31m
          [36m<select[31m
            [33mclass[31m=[32m"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed"[31m
          [36m>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"viewer"[31m
            [36m>[31m
              [0mViewer (Read-only)[0m
            [36m</option>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"member"[31m
            [36m>[31m
              [0mMember (Can use operations)[0m
            [36m</option>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"admin"[31m
            [36m>[31m
              [0mAdmin (Can invite & manage)[0m
            [36m</option>[31m
          [36m</select>[31m
          [36m<p[31m
            [33mclass[31m=[32m"text-xs text-gray-600 mt-2"[31m
          [36m>[31m
            [0mCan use all operations and see analytics[0m
          [36m</p>[31m
        [36m</div>[31m
        [36m<button[31m
          [33mclass[31m=[32m"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"[31m
          [33mdisabled[31m=[32m""[31m
          [33mtype[31m=[32m"submit"[31m
        [36m>[31m
          [0mSend Invitation[0m
        [36m</button>[31m
      [36m</form>[31m
      [36m<div[31m
        [33mclass[31m=[32m"bg-blue-50 border border-blue-200 rounded-lg p-4"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-sm text-blue-800"[31m
        [36m>[31m
          [36m<strong>[31m
            [0mTip:[0m
          [36m</strong>[31m
          [0m Invitations expire in 6 hours. The invited user will receive a link to join your team.[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/InviteMembers.test.tsx:[2m60:31[22m[39m
    [90m 58| [39m    [34mrender[39m([33m<[39m[33mInviteMembers[39m [33mtenantId[39m[33m=[39m[33m{[39mmockTenantId[33m}[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m 59| [39m
    [90m 60| [39m    const roleSelect = screen.getByDisplayValue('member') as HTMLSelecâ€¦
    [90m   | [39m                              [31m^[39m
    [90m 61| [39m    fireEvent[33m.[39m[34mchange[39m(roleSelect[33m,[39m { target[33m:[39m { value[33m:[39m [32m'viewer'[39m } })[33m;[39m
    [90m 62| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/InviteMembers.test.tsx[2m > [22mInviteMembers[2m > [22mshould submit invitation with correct data
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the display value: member.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"bg-white border border-gray-200 rounded-lg p-6 space-y-6"[31m
    [36m>[31m
      [36m<div>[31m
        [36m<h2[31m
          [33mclass[31m=[32m"text-xl font-bold text-gray-900"[31m
        [36m>[31m
          [0mInvite Team Member[0m
        [36m</h2>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600 text-sm mt-1"[31m
        [36m>[31m
          [0mSend an invitation link to add someone to your team[0m
        [36m</p>[31m
      [36m</div>[31m
      [36m<form[31m
        [33mclass[31m=[32m"space-y-4"[31m
      [36m>[31m
        [36m<div>[31m
          [36m<label[31m
            [33mclass[31m=[32m"block text-sm font-medium text-gray-900 mb-2"[31m
          [36m>[31m
            [0mEmail Address[0m
          [36m</label>[31m
          [36m<input[31m
            [33mclass[31m=[32m"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed"[31m
            [33mplaceholder[31m=[32m"user@example.com"[31m
            [33mtype[31m=[32m"email"[31m
            [33mvalue[31m=[32m"test@example.com"[31m
          [36m/>[31m
        [36m</div>[31m
        [36m<div>[31m
          [36m<label[31m
            [33mclass[31m=[32m"block text-sm font-medium text-gray-900 mb-2"[31m
          [36m>[31m
            [0mRole[0m
          [36m</label>[31m
          [36m<select[31m
            [33mclass[31m=[32m"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed"[31m
          [36m>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"viewer"[31m
            [36m>[31m
              [0mViewer (Read-only)[0m
            [36m</option>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"member"[31m
            [36m>[31m
              [0mMember (Can use operations)[0m
            [36m</option>[31m
            [36m<option[31m
              [33mvalue[31m=[32m"admin"[31m
            [36m>[31m
              [0mAdmin (Can invite & manage)[0m
            [36m</option>[31m
          [36m</select>[31m
          [36m<p[31m
            [33mclass[31m=[32m"text-xs text-gray-600 mt-2"[31m
          [36m>[31m
            [0mCan use all operations and see analytics[0m
          [36m</p>[31m
        [36m</div>[31m
        [36m<button[31m
          [33mclass[31m=[32m"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"[31m
          [33mtype[31m=[32m"submit"[31m
        [36m>[31m
          [0mSend Invitation[0m
        [36m</button>[31m
      [36m</form>[31m
      [36m<div[31m
        [33mclass[31m=[32m"bg-blue-50 border border-blue-200 rounded-lg p-4"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-sm text-blue-800"[31m
        [36m>[31m
          [36m<strong>[31m
            [0mTip:[0m
          [36m</strong>[31m
          [0m Invitations expire in 6 hours. The invited user will receive a link to join your team.[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/InviteMembers.test.tsx:[2m100:31[22m[39m
    [90m 98| [39m    fireEvent.change(emailInput, { target: { value: 'test@example.com'â€¦
    [90m 99| [39m
    [90m100| [39m    const roleSelect = screen.getByDisplayValue('member') as HTMLSelecâ€¦
    [90m   | [39m                              [31m^[39m
    [90m101| [39m    fireEvent[33m.[39m[34mchange[39m(roleSelect[33m,[39m { target[33m:[39m { value[33m:[39m [32m'admin'[39m } })[33m;[39m
    [90m102| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TeamMemberCard.test.tsx[2m > [22mTeamMemberCard[2m > [22mshould display role badges with correct colors
[31m[1mError[22m: [2mexpect([22m[31melement[31m[2m).toHaveClass([22m[32m[32m"bg-green-100 text-green-800"[32m[31m[2m)[22m

Expected the element to have class:
[32m  bg-green-100 text-green-800[31m
Received:
[31m  flex items-center gap-4 flex-1 min-w-0[31m[39m
[36m [2mâ¯[22m src/components/TeamMemberCard.test.tsx:[2m68:37[22m[39m
    [90m 66| [39m
    [90m 67| [39m    [35mlet[39m roleBadge [33m=[39m screen[33m.[39m[34mgetByText[39m([32m'Member'[39m)[33m;[39m
    [90m 68| [39m    expect(roleBadge.parentElement).toHaveClass('bg-green-100', 'text-â€¦
    [90m   | [39m                                    [31m^[39m
    [90m 69| [39m
    [90m 70| [39m    [90m// Test Admin role[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TeamMemberCard.test.tsx[2m > [22mTeamMemberCard[2m > [22mshould show role options in submenu
[31m[1mTestingLibraryElementError[22m[39m: Found multiple elements with the text: Member

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 bg-green-100 text-green-800"[39m
[36m>[39m
  [0mMember[0m
[36m</div>[39m

Ignored nodes: comments, script, style
[36m<button[39m
  [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
  [33mdisabled[39m=[32m""[39m
[36m>[39m
  [0mMember[0m
[36m</button>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"bg-white border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:border-gray-300 transition-colors"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex items-center gap-4 flex-1 min-w-0"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"flex-shrink-0"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center"[39m
          [36m>[39m
            [36m<svg[39m
              [33mclass[39m=[32m"lucide lucide-user w-5 h-5 text-white"[39m
              [33mfill[39m=[32m"none"[39m
              [33mheight[39m=[32m"24"[39m
              [33mstroke[39m=[32m"currentColor"[39m
              [33mstroke-linecap[39m=[32m"round"[39m
              [33mstroke-linejoin[39m=[32m"round"[39m
              [33mstroke-width[39m=[32m"2"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
              [33mwidth[39m=[32m"24"[39m
              [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"12"[39m
                [33mcy[39m=[32m"7"[39m
                [33mr[39m=[32m"4"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"flex-1 min-w-0"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex items-center gap-2"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"font-medium text-gray-900 truncate"[39m
            [36m>[39m
              [0mmember@example.com[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-sm text-gray-600"[39m
          [36m>[39m
            [0mJoined [0m
            [0m1/14/2024[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 bg-green-100 text-green-800"[39m
        [36m>[39m
          [0mMember[0m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"relative ml-4"[39m
      [36m>[39m
        [36m<button[39m
          [33mclass[39m=[32m"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"[39m
        [36m>[39m
          [36m<svg[39m
            [33mclass[39m=[32m"lucide lucide-more-vertical w-5 h-5"[39m
            [33mfill[39m=[32m"none"[39m
            [33mheight[39m=[32m"24"[39m
            [33mstroke[39m=[32m"currentColor"[39m
            [33mstroke-linecap[39m=[32m"round"[39m
            [33mstroke-linejoin[39m=[32m"round"[39m
            [33mstroke-width[39m=[32m"2"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
            [33mwidth[39m=[32m"24"[39m
            [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
          [36m>[39m
            [36m<circle[39m
              [33mcx[39m=[32m"12"[39m
              [33mcy[39m=[32m"12"[39m
              [33mr[39m=[32m"1"[39m
            [36m/>[39m
            [36m<circle[39m
              [33mcx[39m=[32m"12"[39m
              [33mcy[39m=[32m"5"[39m
              [33mr[39m=[32m"1"[39m
            [36m/>[39m
            [36m<circle[39m
              [33mcx[39m=[32m"12"[39m
              [33mcy[39m=[32m"19"[39m
              [33mr[39m=[32m"1"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</button>[39m
        [36m<div[39m
          [33mclass[39m=[32m"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"border-b border-gray-100"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"[39m
            [36m>[39m
              [0mChange Role[0m
            [36m</button>[39m
            [36m<div[39m
              [33mclass[39m=[32m"pl-4 bg-gray-50 border-t border-gray-100"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
              [36m>[39m
                [0mOwner[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
              [36m>[39m
                [0mAdmin[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
                [33mdisabled[39m=[32m""[39m
              [36m>[39m
                [0mMember[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
              [36m>[39m
                [0mViewer[0m
              [36m</button>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<button[39m
            [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
          [36m>[39m
            [0mRemove Member[0m
          [36m</button>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"bg-white border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:border-gray-300 transition-colors"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"flex items-center gap-4 flex-1 min-w-0"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex-shrink-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center"[39m
            [36m>[39m
              [36m<svg[39m
                [33mclass[39m=[32m"lucide lucide-user w-5 h-5 text-white"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"7"[39m
                  [33mr[39m=[32m"4"[39m
                [36m/>[39m
              [36m</svg>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex-1 min-w-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center gap-2"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"font-medium text-gray-900 truncate"[39m
              [36m>[39m
                [0mmember@example.com[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mJoined [0m
              [0m1/14/2024[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 bg-green-100 text-green-800"[39m
          [36m>[39m
            [0mMember[0m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"relative ml-4"[39m
        [36m>[39m
          [36m<button[39m
            [33mclass[39m=[32m"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"[39m
          [36m>[39m
            [36m<svg[39m
              [33mclass[39m=[32m"lucide lucide-more-vertical w-5 h-5"[39m
              [33mfill[39m=[32m"none"[39m
              [33mheight[39m=[32m"24"[39m
              [33mstroke[39m=[32m"currentColor"[39m
              [33mstroke-linecap[39m=[32m"round"[39m
              [33mstroke-linejoin[39m=[32m"round"[39m
              [33mstroke-width[39m=[32m"2"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
              [33mwidth[39m=[32m"24"[39m
              [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            [36m>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"12"[39m
                [33mcy[39m=[32m"12"[39m
                [33mr[39m=[32m"1"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"12"[39m
                [33mcy[39m=[32m"5"[39m
                [33mr[39m=[32m"1"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"12"[39m
                [33mcy[39m=[32m"19"[39m
                [33mr[39m=[32m"1"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</button>[39m
          [36m<div[39m
            [33mclass[39m=[32m"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"border-b border-gray-100"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"[39m
              [36m>[39m
                [0mChange Role[0m
              [36m</button>[39m
              [36m<div[39m
                [33mclass[39m=[32m"pl-4 bg-gray-50 border-t border-gray-100"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
                [36m>[39m
                  [0mOwner[0m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
                [36m>[39m
                  [0mAdmin[0m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
                  [33mdisabled[39m=[32m""[39m
                [36m>[39m
                  [0mMember[0m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
                [36m>[39m
                  [0mViewer[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<button[39m
              [33mclass[39m=[32m"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"[39m
            [36m>[39m
              [0mRemove Member[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
[90m [2mâ¯[22m waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/components/TeamMemberCard.test.tsx:[2m233:11[22m[39m
    [90m231| [39m
    [90m232| [39m    [90m// All role options should be visible[39m
    [90m233| [39m    [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m          [31m^[39m
    [90m234| [39m      [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m'Viewer'[39m))[33m.[39m[34mtoBeInTheDocument[39m()[33m;[39m
    [90m235| [39m      [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m'Member'[39m))[33m.[39m[34mtoBeInTheDocument[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mLoading tenants[2m > [22mshould show loading state initially
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mLoading tenants[2m > [22mshould load user tenants on mount
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mLoading tenants[2m > [22mshould create default tenant if none exist
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mLoading tenants[2m > [22mshould handle database errors gracefully
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mTenant switching[2m > [22mshould switch to different tenant
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mTenant switching[2m > [22mshould deny access to unauthorized tenant
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mCreating tenants[2m > [22mshould create new tenant
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mCreating tenants[2m > [22mshould throw if user not authenticated
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mTenant preference persistence[2m > [22mshould persist tenant selection in localStorage
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mTenant preference persistence[2m > [22mshould restore previous tenant on reload
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mError handling[2m > [22mshould display error message on load failure
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mError handling[2m > [22mshould handle missing user gracefully
[41m[1m FAIL [22m[49m src/components/TenantProvider.test.tsx[2m > [22mTenantProvider[2m > [22mContext availability[2m > [22mshould throw when useTenant used outside TenantProvider
[31m[1mTypeError[22m: localStorage.clear is not a function[39m
[36m [2mâ¯[22m src/components/TenantProvider.test.tsx:[2m49:18[22m[39m
    [90m 47| [39m[34mdescribe[39m([32m'TenantProvider'[39m[33m,[39m () [33m=>[39m {
    [90m 48| [39m  [34mbeforeEach[39m(() [33m=>[39m {
    [90m 49| [39m    localStorage[33m.[39m[34mclear[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 50| [39m    vi[33m.[39m[34mclearAllMocks[39m()[33m;[39m
    [90m 51| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould render tenant settings page
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: Test Team Settings. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m62:19[22m[39m
    [90m 60| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m 61| [39m
    [90m 62| [39m    [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m'Test Team Settings'[39m))[33m.[39m[34mtoBeInTheDocument[39m()[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m 63| [39m    expect(screen.getByText('Manage team members and invitations')).toâ€¦
    [90m 64| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould display tabs for members and invite
[31m[1mTestingLibraryElementError[22m: Unable to find an accessible element with the role "button" and name `/team members/i`

Here are the accessible roles:

  paragraph:

  Name "":
  [36m<p[31m
    [33mclass[31m=[32m"text-gray-600"[31m
  [36m/>[31m

  --------------------------------------------------

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m69:19[22m[39m
    [90m 67| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m 68| [39m
    [90m 69| [39m    expect(screen.getByRole('button', { name: /team members/i })).toBeâ€¦
    [90m   | [39m                  [31m^[39m
    [90m 70| [39m    expect(screen.getByRole('button', { name: /invite/i })).toBeInTheDâ€¦
    [90m 71| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[10/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould load and display members
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: owner@example.com. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m

Ignored nodes: comments, script, style
[36m<html>[31m
  [36m<head />[31m
  [36m<body>[31m
    [36m<div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"p-8 text-center"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600"[31m
        [36m>[31m
          [0mSelect a tenant to manage settings[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</body>[31m
[36m</html>[31m[39m
[90m [2mâ¯[22m Proxy.waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m76:11[22m[39m
    [90m 74| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m 75| [39m
    [90m 76| [39m    [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m          [31m^[39m
    [90m 77| [39m      expect(screen.getByText('owner@example.com')).toBeInTheDocument(â€¦
    [90m 78| [39m      expect(screen.getByText('member@example.com')).toBeInTheDocumentâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[11/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould switch to invite tab
[31m[1mTestingLibraryElementError[22m: Unable to find an accessible element with the role "button" and name `/invite/i`

Here are the accessible roles:

  paragraph:

  Name "":
  [36m<p[31m
    [33mclass[31m=[32m"text-gray-600"[31m
  [36m/>[31m

  --------------------------------------------------

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m85:30[22m[39m
    [90m 83| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m 84| [39m
    [90m 85| [39m    [35mconst[39m inviteTab [33m=[39m screen[33m.[39m[34mgetByRole[39m([32m'button'[39m[33m,[39m { name[33m:[39m [36m/invite/i[39m })[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m 86| [39m    fireEvent[33m.[39m[34mclick[39m(inviteTab)[33m;[39m
    [90m 87| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[12/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould show no members message when empty
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: No members yet. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m

Ignored nodes: comments, script, style
[36m<html>[31m
  [36m<head />[31m
  [36m<body>[31m
    [36m<div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"p-8 text-center"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600"[31m
        [36m>[31m
          [0mSelect a tenant to manage settings[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</body>[31m
[36m</html>[31m[39m
[90m [2mâ¯[22m Proxy.waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m113:11[22m[39m
    [90m111| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m112| [39m
    [90m113| [39m    [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m          [31m^[39m
    [90m114| [39m      [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([32m'No members yet'[39m))[33m.[39m[34mtoBeInTheDocument[39m()[33m;[39m
    [90m115| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[13/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould handle remove member
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: member@example.com. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m

Ignored nodes: comments, script, style
[36m<html>[31m
  [36m<head />[31m
  [36m<body>[31m
    [36m<div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"p-8 text-center"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600"[31m
        [36m>[31m
          [0mSelect a tenant to manage settings[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</body>[31m
[36m</html>[31m[39m
[90m [2mâ¯[22m Proxy.waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m127:11[22m[39m
    [90m125| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m126| [39m
    [90m127| [39m    [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m          [31m^[39m
    [90m128| [39m      expect(screen.getByText('member@example.com')).toBeInTheDocumentâ€¦
    [90m129| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[14/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould handle invite success
[31m[1mTestingLibraryElementError[22m: Unable to find an accessible element with the role "button" and name `/invite/i`

Here are the accessible roles:

  paragraph:

  Name "":
  [36m<p[31m
    [33mclass[31m=[32m"text-gray-600"[31m
  [36m/>[31m

  --------------------------------------------------

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mâ¯[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m152:30[22m[39m
    [90m150| [39m
    [90m151| [39m    [90m// Switch to invite tab[39m
    [90m152| [39m    [35mconst[39m inviteTab [33m=[39m screen[33m.[39m[34mgetByRole[39m([32m'button'[39m[33m,[39m { name[33m:[39m [36m/invite/i[39m })[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m153| [39m    fireEvent[33m.[39m[34mclick[39m(inviteTab)[33m;[39m
    [90m154| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[15/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/TenantSettings.test.tsx[2m > [22mTenantSettings[2m > [22mshould display error message on load failure
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: Failed to load members. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"p-8 text-center"[31m
    [36m>[31m
      [36m<p[31m
        [33mclass[31m=[32m"text-gray-600"[31m
      [36m>[31m
        [0mSelect a tenant to manage settings[0m
      [36m</p>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m

Ignored nodes: comments, script, style
[36m<html>[31m
  [36m<head />[31m
  [36m<body>[31m
    [36m<div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"p-8 text-center"[31m
      [36m>[31m
        [36m<p[31m
          [33mclass[31m=[32m"text-gray-600"[31m
        [36m>[31m
          [0mSelect a tenant to manage settings[0m
        [36m</p>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</body>[31m
[36m</html>[31m[39m
[90m [2mâ¯[22m Proxy.waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/components/TenantSettings.test.tsx:[2m179:11[22m[39m
    [90m177| [39m    [34mrender[39m([33m<[39m[33mTenantSettings[39m [33m/[39m[33m>[39m)[33m;[39m
    [90m178| [39m
    [90m179| [39m    [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m          [31m^[39m
    [90m180| [39m      expect(screen.getByText('Failed to load members')).toBeInTheDocuâ€¦
    [90m181| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[16/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/ai-provider-client.test.ts[2m > [22mAIProviderClient[2m > [22mAnalytics Summary[2m > [22mshould estimate cost for weekly analytics
[31m[1mAssertionError[22m: expected 69 to be greater than 100[39m
[36m [2mâ¯[22m src/lib/ai-provider-client.test.ts:[2m107:22[22m[39m
    [90m105| [39m      [35mconst[39m tokens [33m=[39m [33mAIProviderClient[39m[33m.[39m[34mestimateTokens[39m(prompt)[33m;[39m
    [90m106| [39m      [90m// Analytics is more complex, may require more tokens[39m
    [90m107| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeGreaterThan[39m([34m100[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m108| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeLessThan[39m([34m1000[39m)[33m;[39m
    [90m109| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[17/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/sentry-init.test.ts[2m > [22mSentry Integration[2m > [22mbeforeSend Hook[2m > [22mshould filter third-party network errors
[31m[1mAssertionError[22m: expected { message: 'Failed to fetch', â€¦(1) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "message": "Failed to fetch",
  "request": {
    "url": "https://external-api.com/endpoint",
  },
}

[36m [2mâ¯[22m src/lib/sentry-init.test.ts:[2m368:22[22m[39m
    [90m366| [39m      })[33m;[39m
    [90m367| [39m
    [90m368| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m369| [39m    })[33m;[39m
    [90m370| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[18/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/middleware/tenant-middleware.test.ts[2m > [22mTenant Middleware[2m > [22mtenantMiddleware[2m > [22mshould return 500 on unexpected error
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 500 ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   500,[90m
[31m+   403,[90m
[2m  ][22m
[31m[90m

Number of calls: [1m1[22m
[31m[39m
[36m [2mâ¯[22m src/middleware/tenant-middleware.test.ts:[2m315:26[22m[39m
    [90m313| [39m      [35mawait[39m [34mtenantMiddleware[39m(req[33m,[39m res[33m,[39m next)[33m;[39m
    [90m314| [39m
    [90m315| [39m      [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoHaveBeenCalledWith[39m([34m500[39m)[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m316| [39m    })[33m;[39m
    [90m317| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[19/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22mcreateAgent[2m > [22mshould create an agent with default personality
[31m[1mAssertionError[22m: expected undefined to be 'Test Agent' // Object.is equality[39m

[32m- Expected:[39m 
"Test Agent"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/agent.test.ts:[2m95:26[22m[39m
    [90m 93| [39m
    [90m 94| [39m      [34mexpect[39m(agent)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 95| [39m      [34mexpect[39m(agent[33m.[39mname)[33m.[39m[34mtoBe[39m([32m'Test Agent'[39m)[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m 96| [39m      [34mexpect[39m(agent[33m.[39mrole)[33m.[39m[34mtoBe[39m([32m'Test Role'[39m)[33m;[39m
    [90m 97| [39m      [34mexpect[39m(agent[33m.[39mpersonality)[33m.[39m[34mtoEqual[39m({

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[20/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22mcreateAgent[2m > [22mshould create an agent with custom personality
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'verbosity')[39m
[36m [2mâ¯[22m src/services/agent.test.ts:[2m122:32[22m[39m
    [90m120| [39m
    [90m121| [39m      [34mexpect[39m(agent)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m122| [39m      [34mexpect[39m(agent[33m.[39mpersonality[33m.[39mverbosity)[33m.[39m[34mtoBe[39m([34m0.8[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m123| [39m      [34mexpect[39m(agent[33m.[39mpersonality[33m.[39mcreativity)[33m.[39m[34mtoBe[39m([34m0.6[39m)[33m;[39m
    [90m124| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[21/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22mcreateAgent[2m > [22mshould have autonomy level 0 by default
[31m[1mAssertionError[22m: expected undefined to be +0 // Object.is equality[39m

[32m- Expected:[39m 
0

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/agent.test.ts:[2m135:36[22m[39m
    [90m133| [39m      )[33m;[39m
    [90m134| [39m
    [90m135| [39m      [34mexpect[39m(agent[33m.[39mautonomy_level)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m136| [39m    })[33m;[39m
    [90m137| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22mcreateAgent[2m > [22mshould have system creation origin
[31m[1mAssertionError[22m: expected undefined to be 'system' // Object.is equality[39m

[32m- Expected:[39m 
"system"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/agent.test.ts:[2m147:32[22m[39m
    [90m145| [39m      )[33m;[39m
    [90m146| [39m
    [90m147| [39m      [34mexpect[39m(agent[33m.[39mcreated_by)[33m.[39m[34mtoBe[39m([32m'system'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m148| [39m    })[33m;[39m
    [90m149| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[23/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22mgetAgent[2m > [22mshould return agent by ID
[31m[1mAssertionError[22m: expected 'test-id' to be 'agent-123' // Object.is equality[39m

Expected: [32m"agent-123"[39m
Received: [31m"test-id"[39m

[36m [2mâ¯[22m src/services/agent.test.ts:[2m156:25[22m[39m
    [90m154| [39m
    [90m155| [39m      [34mexpect[39m(agent)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m156| [39m      [34mexpect[39m(agent[33m?.[39mid)[33m.[39m[34mtoBe[39m([32m'agent-123'[39m)[33m;[39m
    [90m   | [39m                        [31m^[39m
    [90m157| [39m      [34mexpect[39m(agent[33m?.[39mname)[33m.[39m[34mtoBe[39m([32m'Test Agent'[39m)[33m;[39m
    [90m158| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[24/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22msetAgentAutonomy[2m > [22mshould update agent autonomy level
[31m[1mAssertionError[22m: expected undefined to be +0 // Object.is equality[39m

[32m- Expected:[39m 
0

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/agent.test.ts:[2m178:36[22m[39m
    [90m176| [39m
    [90m177| [39m      [34mexpect[39m(agent)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m178| [39m      expect(agent.autonomy_level).toBe(0); // Mock returns 0, but theâ€¦
    [90m   | [39m                                   [31m^[39m
    [90m179| [39m    })[33m;[39m
    [90m180| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[25/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/agent.test.ts[2m > [22mAgentService[2m > [22mupdateAgentPersonality[2m > [22mshould preserve unmodified personality dimensions
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/agent.test.ts:[2m217:33[22m[39m
    [90m215| [39m
    [90m216| [39m      // Mock returns default personality, but the merge logic was calâ€¦
    [90m217| [39m      [34mexpect[39m(agent[33m.[39mpersonality)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m218| [39m    })[33m;[39m
    [90m219| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[26/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mRule Creation[2m > [22mcreates email-to-task rule with email from filter
[31m[1mAssertionError[22m: expected undefined to be 'email_received' // Object.is equality[39m

[32m- Expected:[39m 
"email_received"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m82:32[22m[39m
    [90m 80| [39m
    [90m 81| [39m      [34mexpect[39m(rule[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 82| [39m      [34mexpect[39m(rule[33m.[39mtriggerType)[33m.[39m[34mtoBe[39m([32m'email_received'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m 83| [39m      [34mexpect[39m(rule[33m.[39menabled)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m 84| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[27/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mRule Creation[2m > [22mcreates rule with subject keyword filter
[31m[1mAssertionError[22m: expected undefined to be 'email_received' // Object.is equality[39m

[32m- Expected:[39m 
"email_received"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m97:32[22m[39m
    [90m 95| [39m
    [90m 96| [39m      [34mexpect[39m(rule[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 97| [39m      [34mexpect[39m(rule[33m.[39mtriggerType)[33m.[39m[34mtoBe[39m([32m'email_received'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m 98| [39m    })[33m;[39m
    [90m 99| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[28/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mRule Creation[2m > [22mcreates disabled rule
[31m[1mAssertionError[22m: expected undefined to be false // Object.is equality[39m

[32m- Expected:[39m 
false

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m131:28[22m[39m
    [90m129| [39m      })[33m;[39m
    [90m130| [39m
    [90m131| [39m      [34mexpect[39m(rule[33m.[39menabled)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m132| [39m    })[33m;[39m
    [90m133| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[29/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mEmail Processing[2m > [22mprocesses incoming email and checks triggers
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m245:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[30/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mEmail Processing[2m > [22mreturns task ID on successful execution
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m251:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[31/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mEmail Processing[2m > [22mhandles multiple triggers for same email
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m260:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[32/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mEmail Processing[2m > [22mlogs trigger execution to Discord
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m266:33[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[33/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mEmail Processing[2m > [22madds execution record to hash chain
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m273:33[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[34/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mError Handling[2m > [22mcontinues on trigger execution failure
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m326:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[35/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mType Safety[2m > [22menforces trigger type
[31m[1mAssertionError[22m: expected undefined to be 'email_received' // Object.is equality[39m

[32m- Expected:[39m 
"email_received"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m378:32[22m[39m
    [90m376| [39m      })[33m;[39m
    [90m377| [39m
    [90m378| [39m      [34mexpect[39m(rule[33m.[39mtriggerType)[33m.[39m[34mtoBe[39m([32m'email_received'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m379| [39m    })[33m;[39m
    [90m380| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[36/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-email-trigger.test.ts[2m > [22mAutomationEmailTriggerService[2m > [22mType Safety[2m > [22menforces action type
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '0')[39m
[36m [2mâ¯[22m src/services/automation-email-trigger.test.ts:[2m387:19[22m[39m
    [90m385| [39m      })[33m;[39m
    [90m386| [39m
    [90m387| [39m      [34mexpect[39m(rule[33m.[39mactions[[34m0[39m][33m?.[39mactionType)[33m.[39m[34mtoBe[39m([32m'create_task'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m388| [39m    })[33m;[39m
    [90m389| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[37/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-learning.test.ts[2m > [22mAutomationLearningEngine[2m > [22mPattern Extraction[2m > [22muses trigger ID and status for pattern
[31m[1mAssertionError[22m: expected 'test:success' to contain 'test-trigger'[39m

Expected: [32m"test[7m-trigger[27m"[39m
Received: [31m"test[7m:success[27m"[39m

[36m [2mâ¯[22m src/services/automation-learning.test.ts:[2m177:23[22m[39m
    [90m175| [39m      [35mconst[39m pattern [33m=[39m [35mawait[39m learningEngine[33m.[39m[34mextractPattern[39m(execution)[33m;[39m
    [90m176| [39m
    [90m177| [39m      [34mexpect[39m(pattern)[33m.[39m[34mtoContain[39m([32m'test-trigger'[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m178| [39m      [34mexpect[39m(pattern)[33m.[39m[34mtoContain[39m([32m'success'[39m)[33m;[39m
    [90m179| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[38/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-meeting-prep.test.ts[2m > [22mMeetingPrepService[2m > [22mMeeting Preparation[2m > [22mprepares meeting for user
[31m[1mTypeError[22m: Cannot read properties of null (reading 'id')[39m
[36m [2mâ¯[22m src/services/automation-meeting-prep.test.ts:[2m64:22[22m[39m
    [90m 62| [39m
    [90m 63| [39m      [34mexpect[39m(context)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 64| [39m      [34mexpect[39m(context[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 65| [39m      [34mexpect[39m(context[33m.[39muserId)[33m.[39m[34mtoBe[39m([32m'user-123'[39m)[33m;[39m
    [90m 66| [39m      [34mexpect[39m(context[33m.[39meventId)[33m.[39m[34mtoBe[39m([32m'event-123'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-meeting-prep.test.ts[2m > [22mMeetingPrepService[2m > [22mMeeting Preparation[2m > [22mincludes relevant emails in context
[31m[1mTypeError[22m: Cannot read properties of null (reading 'relevantEmails')[39m
[36m [2mâ¯[22m src/services/automation-meeting-prep.test.ts:[2m75:36[22m[39m
    [90m 73| [39m      )[33m;[39m
    [90m 74| [39m
    [90m 75| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(context[33m.[39mrelevantEmails))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m 76| [39m    })[33m;[39m
    [90m 77| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[40/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-meeting-prep.test.ts[2m > [22mMeetingPrepService[2m > [22mMeeting Preparation[2m > [22mincludes action items in context
[31m[1mTypeError[22m: Cannot read properties of null (reading 'actionItems')[39m
[36m [2mâ¯[22m src/services/automation-meeting-prep.test.ts:[2m84:36[22m[39m
    [90m 82| [39m      )[33m;[39m
    [90m 83| [39m
    [90m 84| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(context[33m.[39mactionItems))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m 85| [39m    })[33m;[39m
    [90m 86| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[41/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-meeting-prep.test.ts[2m > [22mMeetingPrepService[2m > [22mMeeting Preparation[2m > [22mcreates prep task
[31m[1mTypeError[22m: Cannot read properties of null (reading 'prepTaskId')[39m
[36m [2mâ¯[22m src/services/automation-meeting-prep.test.ts:[2m93:22[22m[39m
    [90m 91| [39m      )[33m;[39m
    [90m 92| [39m
    [90m 93| [39m      [34mexpect[39m(context[33m.[39mprepTaskId)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 94| [39m    })[33m;[39m
    [90m 95| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[42/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-meeting-prep.test.ts[2m > [22mMeetingPrepService[2m > [22mMeeting Context Storage[2m > [22msaves meeting context
[31m[1mAssertionError[22m: expected undefined to be true // Object.is equality[39m

[32m- Expected:[39m 
true

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/automation-meeting-prep.test.ts:[2m294:21[22m[39m
    [90m292| [39m      const saved = await meetingPrepService.saveMeetingContext(mockCoâ€¦
    [90m293| [39m
    [90m294| [39m      [34mexpect[39m(saved)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m295| [39m    })[33m;[39m
    [90m296| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[43/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-meeting-prep.test.ts[2m > [22mMeetingPrepService[2m > [22mType Safety[2m > [22mreturns MeetingContext with correct structure
[31m[1mTypeError[22m: Cannot read properties of null (reading 'id')[39m
[36m [2mâ¯[22m src/services/automation-meeting-prep.test.ts:[2m380:22[22m[39m
    [90m378| [39m      )[33m;[39m
    [90m379| [39m
    [90m380| [39m      [34mexpect[39m(context[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m381| [39m      [34mexpect[39m(context[33m.[39muserId)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m382| [39m      [34mexpect[39m(context[33m.[39meventId)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[44/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-post-meeting.test.ts[2m > [22mPostMeetingFollowupService[2m > [22mDue Date Extraction[2m > [22mparses explicit dates
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-post-meeting.test.ts:[2m196:59[22m[39m
    [90m194| [39m      )[33m;[39m
    [90m195| [39m
    [90m196| [39m      [34mexpect[39m(dueDate [33m===[39m [35mnull[39m [33m||[39m dueDate [35minstanceof[39m [33mDate[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                          [31m^[39m
    [90m197| [39m    })[33m;[39m
    [90m198| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[45/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-post-meeting.test.ts[2m > [22mPostMeetingFollowupService[2m > [22mDue Date Extraction[2m > [22mreturns null for no due date
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-post-meeting.test.ts:[2m204:59[22m[39m
    [90m202| [39m      )[33m;[39m
    [90m203| [39m
    [90m204| [39m      [34mexpect[39m(dueDate [33m===[39m [35mnull[39m [33m||[39m dueDate [35minstanceof[39m [33mDate[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                          [31m^[39m
    [90m205| [39m    })[33m;[39m
    [90m206| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[46/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-post-meeting.test.ts[2m > [22mPostMeetingFollowupService[2m > [22mError Handling[2m > [22mhandles invalid dates gracefully
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-post-meeting.test.ts:[2m384:59[22m[39m
    [90m382| [39m      )[33m;[39m
    [90m383| [39m
    [90m384| [39m      [34mexpect[39m(dueDate [33m===[39m [35mnull[39m [33m||[39m dueDate [35minstanceof[39m [33mDate[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                          [31m^[39m
    [90m385| [39m    })[33m;[39m
    [90m386| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[47/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mMeeting Time Finding[2m > [22mfinds best meeting times for single attendee
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m53:56[22m[39m
    [90m 51| [39m
    [90m 52| [39m      [34mexpect[39m(suggestion)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 53| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m 54| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 55| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[48/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mMeeting Time Finding[2m > [22mfinds best meeting times for multiple attendees
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m68:56[22m[39m
    [90m 66| [39m
    [90m 67| [39m      [34mexpect[39m(suggestion)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 68| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m 69| [39m    })[33m;[39m
    [90m 70| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[49/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mMeeting Time Finding[2m > [22mrespects duration parameter
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m81:41[22m[39m
    [90m 79| [39m      })[33m;[39m
    [90m 80| [39m
    [90m 81| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m 82| [39m    })[33m;[39m
    [90m 83| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[50/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mMeeting Time Finding[2m > [22mreturns empty array when no slots available
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m95:56[22m[39m
    [90m 93| [39m      })[33m;[39m
    [90m 94| [39m
    [90m 95| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m 96| [39m    })[33m;[39m
    [90m 97| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[51/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mFree Slot Calculation[2m > [22mcalculates free slots
[31m[1mTypeError[22m: calendars is not iterable[39m
[36m [2mâ¯[22m SmartSchedulingService.calculateFreeSlots src/services/automation-smart-scheduling.ts:[2m148:30[22m[39m
    [90m146| [39m      [90m// Check if slot is free for all attendees[39m
    [90m147| [39m      [35mlet[39m isFree [33m=[39m [35mtrue[39m[33m;[39m
    [90m148| [39m      [35mfor[39m ([35mconst[39m calendar [35mof[39m calendars) {
    [90m   | [39m                             [31m^[39m
    [90m149| [39m        [35mif[39m ([35mthis[39m[33m.[39m[34mhasConflict[39m(calendar[33m,[39m current[33m,[39m slotEnd)) {
    [90m150| [39m          isFree [33m=[39m [35mfalse[39m[33m;[39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m110:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[52/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mFree Slot Calculation[2m > [22mhandles multiple calendar entries
[31m[1mTypeError[22m: calendars is not iterable[39m
[36m [2mâ¯[22m SmartSchedulingService.calculateFreeSlots src/services/automation-smart-scheduling.ts:[2m148:30[22m[39m
    [90m146| [39m      [90m// Check if slot is free for all attendees[39m
    [90m147| [39m      [35mlet[39m isFree [33m=[39m [35mtrue[39m[33m;[39m
    [90m148| [39m      [35mfor[39m ([35mconst[39m calendar [35mof[39m calendars) {
    [90m   | [39m                             [31m^[39m
    [90m149| [39m        [35mif[39m ([35mthis[39m[33m.[39m[34mhasConflict[39m(calendar[33m,[39m current[33m,[39m slotEnd)) {
    [90m150| [39m          isFree [33m=[39m [35mfalse[39m[33m;[39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m136:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[53/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mFree Slot Calculation[2m > [22mrespects duration in slot calculation
[31m[1mTypeError[22m: calendars is not iterable[39m
[36m [2mâ¯[22m SmartSchedulingService.calculateFreeSlots src/services/automation-smart-scheduling.ts:[2m148:30[22m[39m
    [90m146| [39m      [90m// Check if slot is free for all attendees[39m
    [90m147| [39m      [35mlet[39m isFree [33m=[39m [35mtrue[39m[33m;[39m
    [90m148| [39m      [35mfor[39m ([35mconst[39m calendar [35mof[39m calendars) {
    [90m   | [39m                             [31m^[39m
    [90m149| [39m        [35mif[39m ([35mthis[39m[33m.[39m[34mhasConflict[39m(calendar[33m,[39m current[33m,[39m slotEnd)) {
    [90m150| [39m          isFree [33m=[39m [35mfalse[39m[33m;[39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m149:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[54/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mTime Slot Scoring[2m > [22mscores morning slots high
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m232:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[55/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mTime Slot Scoring[2m > [22mscores lunch time low
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m245:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[56/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mTime Slot Scoring[2m > [22mincludes score breakdown
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m257:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[57/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mTime Slot Scoring[2m > [22mpenalizes high attendee counts
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m270:59[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[58/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mTime Slot Scoring[2m > [22mrespects user preferences
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m282:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[59/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mSuggestion Generation[2m > [22mgenerates scheduling suggestion
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m302:41[22m[39m
    [90m300| [39m
    [90m301| [39m      [34mexpect[39m(suggestion)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m302| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m303| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m304| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[60/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mSuggestion Generation[2m > [22mreturns sorted suggestions by score
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'length')[39m
[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m316:37[22m[39m
    [90m314| [39m      })[33m;[39m
    [90m315| [39m
    [90m316| [39m      [35mif[39m (suggestion[33m.[39msuggestedTimes[33m.[39mlength [33m>[39m [34m1[39m) {
    [90m   | [39m                                    [31m^[39m
    [90m317| [39m        for (let i = 0; i < suggestion.suggestedTimes.length - 1; i++)â€¦
    [90m318| [39m          expect(suggestion.suggestedTimes[i].score).toBeGreaterThanOrâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[61/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mSuggestion Generation[2m > [22mlimits suggestions to top 5
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'length')[39m
[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m335:40[22m[39m
    [90m333| [39m      })[33m;[39m
    [90m334| [39m
    [90m335| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes[33m.[39mlength)[33m.[39m[34mtoBeLessThanOrEqual[39m([34m5[39m)[33m;[39m
    [90m   | [39m                                       [31m^[39m
    [90m336| [39m    })[33m;[39m
    [90m337| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[62/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mSuggestion Generation[2m > [22mincludes best time separately
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m348:35[22m[39m
    [90m346| [39m      })[33m;[39m
    [90m347| [39m
    [90m348| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m349| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime[33m.[39mstart)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m350| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime[33m.[39mend)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[63/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mError Handling[2m > [22mhandles invalid date range
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m451:56[22m[39m
    [90m449| [39m      })[33m;[39m
    [90m450| [39m
    [90m451| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m452| [39m    })[33m;[39m
    [90m453| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[64/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mType Safety[2m > [22mreturns SchedulingSuggestion with correct structure
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m492:56[22m[39m
    [90m490| [39m      })[33m;[39m
    [90m491| [39m
    [90m492| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m493| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m494| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[65/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/automation-smart-scheduling.test.ts[2m > [22mSmartSchedulingService[2m > [22mType Safety[2m > [22mtime slots have required fields
[31m[1mTypeError[22m: suggestion.suggestedTimes is not iterable[39m
[36m [2mâ¯[22m src/services/automation-smart-scheduling.test.ts:[2m506:37[22m[39m
    [90m504| [39m      })[33m;[39m
    [90m505| [39m
    [90m506| [39m      [35mfor[39m ([35mconst[39m slot [35mof[39m suggestion[33m.[39msuggestedTimes) {
    [90m   | [39m                                    [31m^[39m
    [90m507| [39m        [34mexpect[39m(slot[33m.[39mstart [35minstanceof[39m [33mDate[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m508| [39m        [34mexpect[39m(slot[33m.[39mend [35minstanceof[39m [33mDate[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[66/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/autonomy-manager.test.ts[2m > [22mAutonomyManagerService[2m > [22mgetAutonomySettings[2m > [22mshould return autonomy settings for user
[31m[1mAssertionError[22m: expected undefined to be 'user-123' // Object.is equality[39m

[32m- Expected:[39m 
"user-123"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/autonomy-manager.test.ts:[2m70:32[22m[39m
    [90m 68| [39m
    [90m 69| [39m      [34mexpect[39m(settings)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 70| [39m      [34mexpect[39m(settings[33m.[39muser_id)[33m.[39m[34mtoBe[39m([32m'user-123'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m 71| [39m      [34mexpect[39m(settings[33m.[39mhelix_autonomy_level)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m 72| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[67/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/autonomy-manager.test.ts[2m > [22mAutonomyManagerService[2m > [22mgetAutonomySettings[2m > [22mshould have default values
[31m[1mAssertionError[22m: expected undefined to be true // Object.is equality[39m

[32m- Expected:[39m 
true

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/autonomy-manager.test.ts:[2m77:44[22m[39m
    [90m 75| [39m      [35mconst[39m settings [33m=[39m [35mawait[39m service[33m.[39m[34mgetAutonomySettings[39m([32m'user-123'[39m)[33m;[39m
    [90m 76| [39m
    [90m 77| [39m      [34mexpect[39m(settings[33m.[39mauto_agent_creation)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m 78| [39m      [34mexpect[39m(settings[33m.[39magent_proposals_require_approval)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m 79| [39m      [34mexpect[39m(settings[33m.[39mdiscord_approval_enabled)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[68/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/autonomy-manager.test.ts[2m > [22mAutonomyManagerService[2m > [22mproposeAction[2m > [22mshould create pending action when approval needed
[31m[1mAssertionError[22m: expected undefined to be 'user-123' // Object.is equality[39m

[32m- Expected:[39m 
"user-123"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/autonomy-manager.test.ts:[2m112:30[22m[39m
    [90m110| [39m
    [90m111| [39m      [34mexpect[39m(action)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m112| [39m      [34mexpect[39m(action[33m.[39muser_id)[33m.[39m[34mtoBe[39m([32m'user-123'[39m)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m113| [39m      [34mexpect[39m(action[33m.[39maction_type)[33m.[39m[34mtoBe[39m([32m'agent_creation'[39m)[33m;[39m
    [90m114| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[69/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/calendar-task-intelligence.test.ts[2m > [22mCalendar & Task Intelligence[2m > [22mTask Intelligence Service[2m > [22mTask Breakdown[2m > [22msubtask hours total approximately original estimate
[31m[1mAssertionError[22m: expected 11 to be less than 4[39m
[36m [2mâ¯[22m src/services/calendar-task-intelligence.test.ts:[2m440:80[22m[39m
    [90m438| [39m        const totalHours = result.subtasks.reduce((sum, st) => sum + sâ€¦
    [90m439| [39m        const tolerance = (breakdownRequest.estimatedHours || 10) * 0.â€¦
    [90m440| [39m        expect(Math.abs(totalHours - (breakdownRequest.estimatedHours â€¦
    [90m   | [39m                                                                               [31m^[39m
    [90m441| [39m      })[33m;[39m
    [90m442| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[70/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/email-intelligence.test.ts[2m > [22mEmail Intelligence Service[2m > [22mEmail Classify Operation[2m > [22mPriority Classification[2m > [22mclassifies urgent emails as high priority
[31m[1mAssertionError[22m: expected 'medium' to be 'high' // Object.is equality[39m

Expected: [32m"high"[39m
Received: [31m"medium"[39m

[36m [2mâ¯[22m src/services/email-intelligence.test.ts:[2m312:33[22m[39m
    [90m310| [39m          emailBody[33m:[39m [32m'Production is down. Immediate action required.'[39m[33m,[39m
    [90m311| [39m        })[33m;[39m
    [90m312| [39m        [34mexpect[39m(result[33m.[39mpriority)[33m.[39m[34mtoBe[39m([32m'high'[39m)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m313| [39m      })[33m;[39m
    [90m314| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[71/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/email-intelligence.test.ts[2m > [22mEmail Intelligence Service[2m > [22mEmail Classify Operation[2m > [22mPriority Classification[2m > [22mclassifies promotional emails as low priority
[31m[1mAssertionError[22m: expected 'medium' to be 'low' // Object.is equality[39m

Expected: [32m"low"[39m
Received: [31m"medium"[39m

[36m [2mâ¯[22m src/services/email-intelligence.test.ts:[2m329:33[22m[39m
    [90m327| [39m          emailBody[33m:[39m [32m'Limited time promotion'[39m[33m,[39m
    [90m328| [39m        })[33m;[39m
    [90m329| [39m        [34mexpect[39m(result[33m.[39mpriority)[33m.[39m[34mtoBe[39m([32m'low'[39m)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m330| [39m      })[33m;[39m
    [90m331| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[72/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/email-intelligence.test.ts[2m > [22mEmail Intelligence Service[2m > [22mEmail Respond Operation[2m > [22mResponse Types[2m > [22macknowledge response confirms receipt
[31m[1mAssertionError[22m: expected 'email draft response' to contain 'thank'[39m

Expected: [32m"thank"[39m
Received: [31m"email draft response"[39m

[36m [2mâ¯[22m src/services/email-intelligence.test.ts:[2m525:52[22m[39m
    [90m523| [39m          responseType[33m:[39m [32m'acknowledge'[39m[33m,[39m
    [90m524| [39m        })[33m;[39m
    [90m525| [39m        [34mexpect[39m(result[33m.[39mresponseDraft[33m.[39m[34mtoLowerCase[39m())[33m.[39m[34mtoContain[39m([32m'thank'[39m)[33m;[39m
    [90m   | [39m                                                   [31m^[39m
    [90m526| [39m      })[33m;[39m
    [90m527| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[73/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/pattern-detection.test.ts[2m > [22mPatternDetectionService[2m > [22mpattern analysis[2m > [22mshould identify topic clusters from conversations
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m src/services/pattern-detection.test.ts:[2m112:32[22m[39m
    [90m110| [39m      // With test data: 'coding' appears 2x (67%), others appear 1x (â€¦
    [90m111| [39m      [90m// 'coding' should be above 15% threshold and proposed[39m
    [90m112| [39m      [34mexpect[39m(proposals[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m113| [39m    })[33m;[39m
    [90m114| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[74/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/voice-phase4.test.ts[2m > [22mPhase 4.2: Voice Features[2m > [22mVoice Analytics Service[2m > [22mtrend analysis[2m > [22mshould identify emotional volatility
[31m[1mAssertionError[22m: expected 0.2899683304312063 to be greater than 0.3[39m
[36m [2mâ¯[22m src/services/voice-phase4.test.ts:[2m417:24[22m[39m
    [90m415| [39m        [35mconst[39m stdDev [33m=[39m [33mMath[39m[33m.[39m[34msqrt[39m(variance)[33m;[39m
    [90m416| [39m
    [90m417| [39m        [34mexpect[39m(stdDev)[33m.[39m[34mtoBeGreaterThan[39m([34m0.3[39m)[33m;[39m [90m// High volatility[39m
    [90m   | [39m                       [31m^[39m
    [90m418| [39m      })[33m;[39m
    [90m419| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[75/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/CalendarView.test.tsx[2m > [22mCalendar Components[2m > [22mCalendarGrid[2m > [22mrenders month view by default
[31m[1mTypeError[22m: screen.getByText is not a function[39m
[36m [2mâ¯[22m src/__tests__/CalendarView.test.tsx:[2m55:30[22m[39m
    [90m 53| [39m      )[33m;[39m
    [90m 54| [39m
    [90m 55| [39m      [34mexpect[39m((screen [35mas[39m any)[33m.[39m[34mgetByText[39m([32m'February 2026'[39m))[33m.[39m[34mtoBeTruthy[39m()[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m 56| [39m      [34mexpect[39m((screen [35mas[39m any)[33m.[39m[34mgetByText[39m([32m'Mon'[39m))[33m.[39m[34mtoBeTruthy[39m()[33m;[39m
    [90m 57| [39m      [34mexpect[39m((screen [35mas[39m any)[33m.[39m[34mgetByText[39m([32m'Sun'[39m))[33m.[39m[34mtoBeTruthy[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[76/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/Phase3-E2E.test.ts[2m > [22mPhase 3 E2E Integration Tests[2m > [22mCross-Feature Workflows[2m > [22mexecutes complete user journey: create tool â†’ use in skill â†’ run synthesis
[31m[1mTypeError[22m: [Function fetch] is not a spy or a call to a spy![39m
[36m [2mâ¯[22m src/__tests__/Phase3-E2E.test.ts:[2m424:25[22m[39m
    [90m422| [39m
    [90m423| [39m      [90m// Complete journey verified[39m
    [90m424| [39m      [34mexpect[39m(mockFetch)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m2[39m)[33m;[39m
    [90m   | [39m                        [31m^[39m
    [90m425| [39m    })[33m;[39m
    [90m426| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[77/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/Phase3-E2E.test.ts[2m > [22mPhase 3 E2E Integration Tests[2m > [22mPerformance & Reliability[2m > [22menforces execution timeouts
[31m[1mError[22m: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2mâ¯[22m src/__tests__/Phase3-E2E.test.ts:[2m533:5[22m[39m
    [90m531| [39m    })[33m;[39m
    [90m532| [39m
    [90m533| [39m    [34mit[39m([32m'enforces execution timeouts'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m    [31m^[39m
    [90m534| [39m      (global[33m.[39mfetch [35mas[39m any)[33m.[39m[34mmockImplementation[39m(
    [90m535| [39m        () [33m=>[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[78/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/Phase3-Integration.test.ts[2m > [22mPhase 3 RPC Integration Tests[2m > [22mCustom Tools Execution Pipeline[2m > [22mexecutes simple arithmetic tool and logs usage
[31m[1mAssertionError[22m: expected +0 to be 150 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 150[39m
[31m+ 0[39m

[36m [2mâ¯[22m src/__tests__/Phase3-Integration.test.ts:[2m53:38[22m[39m
    [90m 51| [39m      [34mexpect[39m(result[33m.[39msuccess)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m 52| [39m      [34mexpect[39m(result[33m.[39moutput[33m.[39mresult)[33m.[39m[34mtoBe[39m([34m42[39m)[33m;[39m
    [90m 53| [39m      [34mexpect[39m(result[33m.[39mexecutionTimeMs)[33m.[39m[34mtoBe[39m([34m150[39m)[33m;[39m
    [90m   | [39m                                     [31m^[39m
    [90m 54| [39m      [34mexpect[39m(mockFetch)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m 55| [39m        expect[33m.[39m[34mstringContaining[39m([32m'rpc'[39m)[33m,[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[79/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/Phase3-Integration.test.ts[2m > [22mPhase 3 RPC Integration Tests[2m > [22mComposite Skills Execution Pipeline[2m > [22mexecutes multi-step composite skill
[31m[1mAssertionError[22m: expected +0 to be 450 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 450[39m
[31m+ 0[39m

[36m [2mâ¯[22m src/__tests__/Phase3-Integration.test.ts:[2m140:38[22m[39m
    [90m138| [39m      [34mexpect[39m(result[33m.[39msuccess)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m139| [39m      [34mexpect[39m(result[33m.[39moutput[33m.[39mtotal)[33m.[39m[34mtoBe[39m([34m150[39m)[33m;[39m
    [90m140| [39m      [34mexpect[39m(result[33m.[39mexecutionTimeMs)[33m.[39m[34mtoBe[39m([34m450[39m)[33m;[39m
    [90m   | [39m                                     [31m^[39m
    [90m141| [39m    })[33m;[39m
    [90m142| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[80/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/Phase3-Integration.test.ts[2m > [22mPhase 3 RPC Integration Tests[2m > [22mError Recovery and Resilience[2m > [22mhandles execution timeout gracefully
[31m[1mError[22m: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2mâ¯[22m src/__tests__/Phase3-Integration.test.ts:[2m385:5[22m[39m
    [90m383| [39m    })[33m;[39m
    [90m384| [39m
    [90m385| [39m    [34mit[39m([32m'handles execution timeout gracefully'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m    [31m^[39m
    [90m386| [39m      mockFetch[33m.[39m[34mmockImplementation[39m(() [33m=>[39m {
    [90m387| [39m        [35mreturn[39m [35mnew[39m [33mPromise[39m(() [33m=>[39m {

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[81/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/Phase3-Integration.test.ts[2m > [22mPhase 3 RPC Integration Tests[2m > [22mError Recovery and Resilience[2m > [22mreports partial execution failure in composite skills
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/__tests__/Phase3-Integration.test.ts:[2m421:28[22m[39m
    [90m419| [39m
    [90m420| [39m      [34mexpect[39m(result[33m.[39msuccess)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m421| [39m      [34mexpect[39m(result[33m.[39merror)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m422| [39m    })[33m;[39m
    [90m423| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[82/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/VoiceRecorder.test.tsx[2m > [22mVoice Recorder[2m > [22museVoiceRecorder Hook[2m > [22mformats duration correctly
[31m[1mAssertionError[22m: expected '1:01:01' to be '61:01' // Object.is equality[39m

Expected: [32m"[7m6[27m1:01"[39m
Received: [31m"[7m1:0[27m1:01"[39m

[36m [2mâ¯[22m src/__tests__/VoiceRecorder.test.tsx:[2m170:51[22m[39m
    [90m168| [39m      [34mexpect[39m(result[33m.[39mcurrent[33m.[39m[34mformatDuration[39m([34m60[39m))[33m.[39m[34mtoBe[39m([32m'01:00'[39m)[33m;[39m
    [90m169| [39m      [34mexpect[39m(result[33m.[39mcurrent[33m.[39m[34mformatDuration[39m([34m125[39m))[33m.[39m[34mtoBe[39m([32m'02:05'[39m)[33m;[39m
    [90m170| [39m      [34mexpect[39m(result[33m.[39mcurrent[33m.[39m[34mformatDuration[39m([34m3661[39m))[33m.[39m[34mtoBe[39m([32m'61:01'[39m)[33m;[39m
    [90m   | [39m                                                  [31m^[39m
    [90m171| [39m    })[33m;[39m
    [90m172| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[83/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/VoiceRecorder.test.tsx[2m > [22mVoice Recorder[2m > [22mVoiceRecorder Component[2m > [22mdisplays error messages
[31m[1mTestingLibraryElementError[22m: Unable to find an element with the text: /Failed to start recording/. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"bg-slate-900 border border-slate-700 rounded-lg p-6 max-w-md w-full mx-4"[31m
    [36m>[31m
      [36m<div[31m
        [33mclass[31m=[32m"flex justify-between items-center mb-6"[31m
      [36m>[31m
        [36m<h2[31m
          [33mclass[31m=[32m"text-xl font-bold text-slate-100"[31m
        [36m>[31m
          [0mVoice Recording[0m
        [36m</h2>[31m
      [36m</div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"mb-6 p-4 bg-slate-800 rounded-lg"[31m
      [36m>[31m
        [36m<div[31m
          [33mclass[31m=[32m"text-3xl font-bold text-blue-400 text-center mb-4"[31m
        [36m>[31m
          [0m00:00[0m
        [36m</div>[31m
        [36m<canvas[31m
          [33mclass[31m=[32m"w-full rounded-lg border border-slate-700 bg-slate-900"[31m
          [33mstyle[31m=[32m"height: 80px;"[31m
        [36m/>[31m
        [36m<div[31m
          [33mclass[31m=[32m"text-center text-sm text-slate-400 mt-4"[31m
        [36m>[31m
          [0mReady to record[0m
        [36m</div>[31m
      [36m</div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"mb-6 p-3 bg-red-900/50 border border-red-700 rounded-lg text-red-100 text-sm"[31m
      [36m>[31m
        [0mMic not available[0m
      [36m</div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"flex gap-2 mb-6"[31m
      [36m>[31m
        [36m<button[31m
          [33mclass[31m=[32m"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-medium transition-colors text-white"[31m
        [36m>[31m
          [0mStart Recording[0m
        [36m</button>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m

Ignored nodes: comments, script, style
[36m<html>[31m
  [36m<head />[31m
  [36m<body>[31m
    [36m<div>[31m
      [36m<div[31m
        [33mclass[31m=[32m"bg-slate-900 border border-slate-700 rounded-lg p-6 max-w-md w-full mx-4"[31m
      [36m>[31m
        [36m<div[31m
          [33mclass[31m=[32m"flex justify-between items-center mb-6"[31m
        [36m>[31m
          [36m<h2[31m
            [33mclass[31m=[32m"text-xl font-bold text-slate-100"[31m
          [36m>[31m
            [0mVoice Recording[0m
          [36m</h2>[31m
        [36m</div>[31m
        [36m<div[31m
          [33mclass[31m=[32m"mb-6 p-4 bg-slate-800 rounded-lg"[31m
        [36m>[31m
          [36m<div[31m
            [33mclass[31m=[32m"text-3xl font-bold text-blue-400 text-center mb-4"[31m
          [36m>[31m
            [0m00:00[0m
          [36m</div>[31m
          [36m<canvas[31m
            [33mclass[31m=[32m"w-full rounded-lg border border-slate-700 bg-slate-900"[31m
            [33mstyle[31m=[32m"height: 80px;"[31m
          [36m/>[31m
          [36m<div[31m
            [33mclass[31m=[32m"text-center text-sm text-slate-400 mt-4"[31m
          [36m>[31m
            [0mReady to record[0m
          [36m</div>[31m
        [36m</div>[31m
        [36m<div[31m
          [33mclass[31m=[32m"mb-6 p-3 bg-red-900/50 border border-red-700 rounded-lg text-red-100 text-sm"[31m
        [36m>[31m
          [0mMic not available[0m
        [36m</div>[31m
        [36m<div[31m
          [33mclass[31m=[32m"flex gap-2 mb-6"[31m
        [36m>[31m
          [36m<button[31m
            [33mclass[31m=[32m"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-medium transition-colors text-white"[31m
          [36m>[31m
            [0mStart Recording[0m
          [36m</button>[31m
        [36m</div>[31m
      [36m</div>[31m
    [36m</div>[31m
  [36m</body>[31m
[36m</html>[31m[39m
[90m [2mâ¯[22m waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/__tests__/VoiceRecorder.test.tsx:[2m276:13[22m[39m
    [90m274| [39m      })[33m;[39m
    [90m275| [39m
    [90m276| [39m      [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m            [31m^[39m
    [90m277| [39m        [34mexpect[39m([34mgetByText[39m([36m/Failed to start recording/[39m))[33m.[39m[34mtoBeTruthy[39m()[33m;[39m
    [90m278| [39m      })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[84/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/settings/IntelligenceSettings.test.tsx[2m > [22mIntelligenceSettings[2m > [22mModels Tab[2m > [22mdisplays model options
[31m[1mTestingLibraryElementError[22m[39m: Found multiple elements with the text: /Claude Opus 4\.5/

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
[36m</option>[39m

Ignored nodes: comments, script, style
[36m<option>[39m
  [0mClaude Opus 4.5[0m
[36m</option>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"w-full max-w-4xl bg-white rounded-lg shadow-lg"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"border-b border-gray-200 px-6 py-4"[39m
      [36m>[39m
        [36m<h2[39m
          [33mclass[39m=[32m"text-2xl font-bold text-gray-900"[39m
        [36m>[39m
          [0mIntelligence Settings[0m
        [36m</h2>[39m
        [36m<p[39m
          [33mclass[39m=[32m"text-sm text-gray-600 mt-1"[39m
        [36m>[39m
          [0mConfigure AI operations, models, and budget limits[0m
        [36m</p>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"flex border-b border-gray-200"[39m
      [36m>[39m
        [36m<button[39m
          [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-transparent text-gray-600 hover:text-gray-900"[39m
        [36m>[39m
          [0mOperations[0m
        [36m</button>[39m
        [36m<button[39m
          [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-transparent text-gray-600 hover:text-gray-900"[39m
        [36m>[39m
          [0mBudget[0m
        [36m</button>[39m
        [36m<button[39m
          [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-blue-500 text-blue-600"[39m
        [36m>[39m
          [0mModels[0m
        [36m</button>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"p-6"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-6"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-semibold text-gray-900 mb-3"[39m
            [36m>[39m
              [0mModel Configuration[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600 mb-4"[39m
            [36m>[39m
              [0mSelect primary and fallback models for each operation category[0m
            [36m</p>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-2 gap-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
              [36m>[39m
                [36m<h4[39m
                  [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                [36m>[39m
                  [0mEmail[0m
                [36m</h4>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-3"[39m
                [36m>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mPrimary[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mFallback[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
              [36m>[39m
                [36m<h4[39m
                  [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                [36m>[39m
                  [0mCalendar[0m
                [36m</h4>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-3"[39m
                [36m>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mPrimary[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mFallback[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
              [36m>[39m
                [36m<h4[39m
                  [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                [36m>[39m
                  [0mTask[0m
                [36m</h4>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-3"[39m
                [36m>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mPrimary[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mFallback[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
              [36m>[39m
                [36m<h4[39m
                  [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                [36m>[39m
                  [0mAnalytics[0m
                [36m</h4>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-3"[39m
                [36m>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mPrimary[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                  [36m<div>[39m
                    [36m<label[39m
                      [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                    [36m>[39m
                      [0mFallback[0m
                    [36m</label>[39m
                    [36m<select[39m
                      [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                    [36m>[39m
                      [36m<option>[39m
                        [0mDeepSeek v3.2[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mGemini 2.0 Flash[0m
                      [36m</option>[39m
                      [36m<option>[39m
                        [0mClaude Opus 4.5[0m
                      [36m</option>[39m
                    [36m</select>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"mt-6 p-4 bg-amber-50 border border-amber-200 rounded-lg"[39m
          [36m>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-amber-900"[39m
            [36m>[39m
              [0mâš ï¸ [0m
              [36m<strong>[39m
                [0mNote:[0m
              [36m</strong>[39m
              [0m Model selection is automatic based on cost and availability. Manual overrides available for advanced users.[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"border-t border-gray-200 px-6 py-4 flex justify-between items-center"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"text-sm text-gray-600"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"flex gap-3"[39m
        [36m>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"[39m
          [36m>[39m
            [0mReset[0m
          [36m</button>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors"[39m
          [36m>[39m
            [0mSave Settings[0m
          [36m</button>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"w-full max-w-4xl bg-white rounded-lg shadow-lg"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"border-b border-gray-200 px-6 py-4"[39m
        [36m>[39m
          [36m<h2[39m
            [33mclass[39m=[32m"text-2xl font-bold text-gray-900"[39m
          [36m>[39m
            [0mIntelligence Settings[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-sm text-gray-600 mt-1"[39m
          [36m>[39m
            [0mConfigure AI operations, models, and budget limits[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"flex border-b border-gray-200"[39m
        [36m>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-transparent text-gray-600 hover:text-gray-900"[39m
          [36m>[39m
            [0mOperations[0m
          [36m</button>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-transparent text-gray-600 hover:text-gray-900"[39m
          [36m>[39m
            [0mBudget[0m
          [36m</button>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-blue-500 text-blue-600"[39m
          [36m>[39m
            [0mModels[0m
          [36m</button>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-6"[39m
          [36m>[39m
            [36m<div>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-semibold text-gray-900 mb-3"[39m
              [36m>[39m
                [0mModel Configuration[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600 mb-4"[39m
              [36m>[39m
                [0mSelect primary and fallback models for each operation category[0m
              [36m</p>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-2 gap-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
                [36m>[39m
                  [36m<h4[39m
                    [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                  [36m>[39m
                    [0mEmail[0m
                  [36m</h4>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"space-y-3"[39m
                  [36m>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mPrimary[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mFallback[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
                [36m>[39m
                  [36m<h4[39m
                    [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                  [36m>[39m
                    [0mCalendar[0m
                  [36m</h4>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"space-y-3"[39m
                  [36m>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mPrimary[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mFallback[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
                [36m>[39m
                  [36m<h4[39m
                    [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                  [36m>[39m
                    [0mTask[0m
                  [36m</h4>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"space-y-3"[39m
                  [36m>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mPrimary[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mFallback[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"border border-gray-300 rounded-lg p-4"[39m
                [36m>[39m
                  [36m<h4[39m
                    [33mclass[39m=[32m"font-semibold text-gray-900 mb-3"[39m
                  [36m>[39m
                    [0mAnalytics[0m
                  [36m</h4>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"space-y-3"[39m
                  [36m>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mPrimary[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5 ($3/$15 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2 ($0.60/$2 per MTok)[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash ($0.05/$0.20 per MTok)[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                    [36m<div>[39m
                      [36m<label[39m
                        [33mclass[39m=[32m"block text-xs font-medium text-gray-700 mb-1"[39m
                      [36m>[39m
                        [0mFallback[0m
                      [36m</label>[39m
                      [36m<select[39m
                        [33mclass[39m=[32m"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"[39m
                      [36m>[39m
                        [36m<option>[39m
                          [0mDeepSeek v3.2[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mGemini 2.0 Flash[0m
                        [36m</option>[39m
                        [36m<option>[39m
                          [0mClaude Opus 4.5[0m
                        [36m</option>[39m
                      [36m</select>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mt-6 p-4 bg-amber-50 border border-amber-200 rounded-lg"[39m
            [36m>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-amber-900"[39m
              [36m>[39m
                [0mâš ï¸ [0m
                [36m<strong>[39m
                  [0mNote:[0m
                [36m</strong>[39m
                [0m Model selection is automatic based on cost and availability. Manual overrides available for advanced users.[0m
              [36m</p>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"border-t border-gray-200 px-6 py-4 flex justify-between items-center"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"text-sm text-gray-600"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex gap-3"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"[39m
            [36m>[39m
              [0mReset[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors"[39m
            [36m>[39m
              [0mSave Settings[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
[90m [2mâ¯[22m waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:[2m163:27[22m[39m
[36m [2mâ¯[22m src/components/settings/IntelligenceSettings.test.tsx:[2m288:13[22m[39m
    [90m286| [39m      [35mawait[39m user[33m.[39m[34mclick[39m(modelsTab)[33m;[39m
    [90m287| [39m
    [90m288| [39m      [35mawait[39m [34mwaitFor[39m(() [33m=>[39m {
    [90m   | [39m            [31m^[39m
    [90m289| [39m        expect(screen.getByText(/Claude Opus 4\.5/)).toBeInTheDocumentâ€¦
    [90m290| [39m        [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([36m/DeepSeek v3\.2/[39m))[33m.[39m[34mtoBeInTheDocument[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[85/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/components/settings/IntelligenceSettings.test.tsx[2m > [22mIntelligenceSettings[2m > [22mSave Functionality[2m > [22mdisables save button while saving
[31m[1mError[22m[39m: [2mexpect([22m[31melement[39m[2m).toBeDisabled()[22m

Received element is not disabled:
  [31m<button
  class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors"
/>[39m

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"w-full max-w-4xl bg-white rounded-lg shadow-lg"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"border-b border-gray-200 px-6 py-4"[39m
        [36m>[39m
          [36m<h2[39m
            [33mclass[39m=[32m"text-2xl font-bold text-gray-900"[39m
          [36m>[39m
            [0mIntelligence Settings[0m
          [36m</h2>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-sm text-gray-600 mt-1"[39m
          [36m>[39m
            [0mConfigure AI operations, models, and budget limits[0m
          [36m</p>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"flex border-b border-gray-200"[39m
        [36m>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-blue-500 text-blue-600"[39m
          [36m>[39m
            [0mOperations[0m
          [36m</button>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-transparent text-gray-600 hover:text-gray-900"[39m
          [36m>[39m
            [0mBudget[0m
          [36m</button>[39m
          [36m<button[39m
            [33mclass[39m=[32m"px-6 py-3 font-medium border-b-2 transition-colors border-transparent text-gray-600 hover:text-gray-900"[39m
          [36m>[39m
            [0mModels[0m
          [36m</button>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"p-6"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-6"[39m
          [36m>[39m
            [36m<div>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-semibold text-gray-900 mb-3"[39m
              [36m>[39m
                [0mEmail Intelligence[0m
              [36m</h3>[39m
              [36m<div[39m
                [33mclass[39m=[32m"space-y-2"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between p-4 border border-gray-300 rounded-lg bg-white hover:shadow-md transition-shadow"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex-1"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-3"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mchecked[39m=[32m""[39m
                        [33mclass[39m=[32m"w-5 h-5"[39m
                        [33mtype[39m=[32m"checkbox"[39m
                      [36m/>[39m
                      [36m<div>[39m
                        [36m<h4[39m
                          [33mclass[39m=[32m"font-semibold text-gray-900"[39m
                        [36m>[39m
                          [0mEmail Compose[0m
                        [36m</h4>[39m
                        [36m<p[39m
                          [33mclass[39m=[32m"text-sm text-gray-600"[39m
                        [36m>[39m
                          [0mAI-powered email composition[0m
                        [36m</p>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex gap-4 mt-2 text-sm"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-gray-600"[39m
                      [36m>[39m
                        [0mCost: $[0m
                        [0m0.0015[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-gray-600"[39m
                      [36m>[39m
                        [0mCriticality:[0m
                        [0m [0m
                        [36m<span[39m
                          [33mclass[39m=[32m"font-medium text-green-600"[39m
                        [36m>[39m
                          [0mLOW[0m
                        [36m</span>[39m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-semibold text-gray-900 mb-3"[39m
              [36m>[39m
                [0mCalendar Intelligence[0m
              [36m</h3>[39m
              [36m<div[39m
                [33mclass[39m=[32m"space-y-2"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between p-4 border border-gray-300 rounded-lg bg-white hover:shadow-md transition-shadow"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex-1"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-3"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mchecked[39m=[32m""[39m
                        [33mclass[39m=[32m"w-5 h-5"[39m
                        [33mtype[39m=[32m"checkbox"[39m
                      [36m/>[39m
                      [36m<div>[39m
                        [36m<h4[39m
                          [33mclass[39m=[32m"font-semibold text-gray-900"[39m
                        [36m>[39m
                          [0mCalendar Prep[0m
                        [36m</h4>[39m
                        [36m<p[39m
                          [33mclass[39m=[32m"text-sm text-gray-600"[39m
                        [36m>[39m
                          [0mMeeting preparation assistance[0m
                        [36m</p>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex gap-4 mt-2 text-sm"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-gray-600"[39m
                      [36m>[39m
                        [0mCost: $[0m
                        [0m0.0025[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-gray-600"[39m
                      [36m>[39m
                        [0mCriticality:[0m
                        [0m [0m
                        [36m<span[39m
                          [33mclass[39m=[32m"font-medium text-yellow-600"[39m
                        [36m>[39m
                          [0mMEDIUM[0m
                        [36m</span>[39m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-semibold text-gray-900 mb-3"[39m
              [36m>[39m
                [0mTask Intelligence[0m
              [36m</h3>[39m
              [36m<div[39m
                [33mclass[39m=[32m"space-y-2"[39m
              [36m/>[39m
            [36m</div>[39m
            [36m<div>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-semibold text-gray-900 mb-3"[39m
              [36m>[39m
                [0mAnalytics Intelligence[0m
              [36m</h3>[39m
              [36m<div[39m
                [33mclass[39m=[32m"space-y-2"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"border-t border-gray-200 px-6 py-4 flex justify-between items-center"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"text-sm text-gray-600"[39m
          [36m>[39m
            [36m<span>[39m
              [0mLast saved: [0m
              [0m10:58:55 AM[0m
            [36m</span>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex gap-3"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"[39m
            [36m>[39m
              [0mReset[0m
            [36m</button>[39m
            [36m<button[39m
              [33mclass[39m=[32m"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors"[39m
            [36m>[39m
              [0mSave Settings[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
[36m [2mâ¯[22m timeout src/components/settings/IntelligenceSettings.test.tsx:[2m340:30[22m[39m
    [90m338| [39m      [35mawait[39m [34mwaitFor[39m(
    [90m339| [39m        () [33m=>[39m {
    [90m340| [39m          [34mexpect[39m(saveButton)[33m.[39m[34mtoBeDisabled[39m()[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m341| [39m        }[33m,[39m
    [90m342| [39m        { timeout[33m:[39m [34m100[39m }
[90m [2mâ¯[22m runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:[2m47:12[22m[39m
[90m [2mâ¯[22m checkCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m124:77[22m[39m
[90m [2mâ¯[22m Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m118:16[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[86/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetCurrentTenantId[2m > [22mshould return null when no tenant set
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetCurrentTenantId[2m > [22mshould return tenant ID from storage
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetCurrentTenantId[2m > [22mshould handle storage errors gracefully
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22msetCurrentTenantId[2m > [22mshould set tenant ID in storage
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22msetCurrentTenantId[2m > [22mshould dispatch tenant-changed event
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22msetCurrentTenantId[2m > [22mshould handle storage errors gracefully
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould throw when no tenant set
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould return tenant ID and headers
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould include Base64-encoded tenant context in headers
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould create valid Base64 encoded context
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould call callback when tenant changes
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould return unsubscribe function
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould support multiple listeners
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould pass correct tenant ID to callback
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mMulti-tab synchronization[2m > [22mshould synchronize tenant changes across tabs
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mMulti-tab synchronization[2m > [22mshould handle rapid tenant switches
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle empty tenant ID
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle special characters in tenant ID
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle very long tenant IDs
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle UUIDs as tenant IDs
[31m[1mTypeError[22m: localStorage.clear is not a function[39m
[36m [2mâ¯[22m src/lib/tenant/tenant-context.test.ts:[2m15:18[22m[39m
    [90m 13| [39m[34mdescribe[39m([32m'Tenant Context'[39m[33m,[39m () [33m=>[39m {
    [90m 14| [39m  [34mbeforeEach[39m(() [33m=>[39m {
    [90m 15| [39m    localStorage[33m.[39m[34mclear[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 16| [39m    vi[33m.[39m[34mclearAllMocks[39m()[33m;[39m
    [90m 17| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[87/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetCurrentTenantId[2m > [22mshould return null when no tenant set
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetCurrentTenantId[2m > [22mshould return tenant ID from storage
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetCurrentTenantId[2m > [22mshould handle storage errors gracefully
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22msetCurrentTenantId[2m > [22mshould set tenant ID in storage
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22msetCurrentTenantId[2m > [22mshould dispatch tenant-changed event
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22msetCurrentTenantId[2m > [22mshould handle storage errors gracefully
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould throw when no tenant set
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould return tenant ID and headers
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould include Base64-encoded tenant context in headers
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mgetTenantContext[2m > [22mshould create valid Base64 encoded context
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould call callback when tenant changes
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould return unsubscribe function
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould support multiple listeners
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22monTenantChanged[2m > [22mshould pass correct tenant ID to callback
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mMulti-tab synchronization[2m > [22mshould synchronize tenant changes across tabs
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mMulti-tab synchronization[2m > [22mshould handle rapid tenant switches
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle empty tenant ID
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle special characters in tenant ID
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle very long tenant IDs
[41m[1m FAIL [22m[49m src/lib/tenant/tenant-context.test.ts[2m > [22mTenant Context[2m > [22mEdge cases[2m > [22mshould handle UUIDs as tenant IDs
[31m[1mTypeError[22m: localStorage.clear is not a function[39m
[36m [2mâ¯[22m src/lib/tenant/tenant-context.test.ts:[2m20:18[22m[39m
    [90m 18| [39m
    [90m 19| [39m  [34mafterEach[39m(() [33m=>[39m {
    [90m 20| [39m    localStorage[33m.[39m[34mclear[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 21| [39m  })[33m;[39m
    [90m 22| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[88/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Creation and Management[2m > [22mshould create a new alert rule
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m62:33[22m[39m
    [90m 60| [39m      }[33m;[39m
    [90m 61| [39m
    [90m 62| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m 63| [39m
    [90m 64| [39m      [34mexpect[39m(rule[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[89/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Creation and Management[2m > [22mshould create a new alert rule
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Creation and Management[2m > [22mshould support multiple alert channels
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mCondition Evaluation[2m > [22mshould evaluate greater than operator
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mCondition Evaluation[2m > [22mshould evaluate less than operator
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mCondition Evaluation[2m > [22mshould evaluate between operator
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mCondition Evaluation[2m > [22mshould evaluate equals operator
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mCondition Evaluation[2m > [22mshould evaluate not equals operator
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mMetrics Collection[2m > [22mshould add metrics snapshot
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mMetrics Collection[2m > [22mshould buffer multiple snapshots
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mMetrics Collection[2m > [22mshould clean up old snapshots beyond 24 hours
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mTime Windows[2m > [22mshould parse 5 minute window
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mTime Windows[2m > [22mshould parse 15 minute window
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mTime Windows[2m > [22mshould parse 1 hour window
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mTime Windows[2m > [22mshould parse 24 hour window
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Cooldown[2m > [22mshould respect cooldown period
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Cooldown[2m > [22mshould allow alert after cooldown expires
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Severity Levels[2m > [22mshould support info severity
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Severity Levels[2m > [22mshould support warning severity
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Severity Levels[2m > [22mshould support critical severity
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support Discord channel
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support email channel
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support SMS channel
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support in-app channel
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Metrics[2m > [22mshould support error_rate metric
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Metrics[2m > [22mshould support latency_p95 metric
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Metrics[2m > [22mshould support cost_spike metric
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Metrics[2m > [22mshould support sla_violation metric
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Metrics[2m > [22mshould support budget_exceeded metric
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Metrics[2m > [22mshould support operation_failure_rate metric
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mEvaluation Loop[2m > [22mshould start evaluation loop
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mEvaluation Loop[2m > [22mshould stop evaluation loop
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mEvaluation Loop[2m > [22mshould not double-start evaluation loop
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Acknowledgment[2m > [22mshould acknowledge an alert
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Resolution[2m > [22mshould resolve an alert
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRules Retrieval[2m > [22mshould get rules for a user
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Updates[2m > [22mshould update an alert rule
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Deletion[2m > [22mshould delete an alert rule
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mSingleton Pattern[2m > [22mshould provide singleton instance
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create high error rate alert (> 5% in 5 min)
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create high latency alert (> 2000ms in 15 min)
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create cost spike alert (> 120% in 1h)
[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create budget exceeded alert
[31m[1mTypeError[22m: engine.stopEvaluation is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m42:12[22m[39m
    [90m 40| [39m
    [90m 41| [39m  [34mafterEach[39m(() [33m=>[39m {
    [90m 42| [39m    engine[33m.[39m[34mstopEvaluation[39m()[33m;[39m
    [90m   | [39m           [31m^[39m
    [90m 43| [39m  })[33m;[39m
    [90m 44| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[90/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Creation and Management[2m > [22mshould support multiple alert channels
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m86:33[22m[39m
    [90m 84| [39m      }[33m;[39m
    [90m 85| [39m
    [90m 86| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m 87| [39m
    [90m 88| [39m      [34mexpect[39m(rule[33m.[39mchannels)[33m.[39m[34mtoHaveLength[39m([34m3[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[91/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mCondition Evaluation[2m > [22mshould evaluate greater than operator
[31m[1mTypeError[22m: engine.addMetricsSnapshot is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m109:14[22m[39m
    [90m107| [39m      ][33m;[39m
    [90m108| [39m
    [90m109| [39m      engine[33m.[39m[34maddMetricsSnapshot[39m(userId[33m,[39m snapshots[[34m0[39m])[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m110| [39m
    [90m111| [39m      [35mconst[39m condition[33m:[39m [33mAlertCondition[39m [33m=[39m {

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[92/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mMetrics Collection[2m > [22mshould add metrics snapshot
[31m[1mTypeError[22m: engine.addMetricsSnapshot is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m185:14[22m[39m
    [90m183| [39m      }[33m;[39m
    [90m184| [39m
    [90m185| [39m      engine[33m.[39m[34maddMetricsSnapshot[39m(userId[33m,[39m snapshot)[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m186| [39m
    [90m187| [39m      [90m// Snapshot should be added to buffer[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[93/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mMetrics Collection[2m > [22mshould buffer multiple snapshots
[31m[1mTypeError[22m: engine.addMetricsSnapshot is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m205:16[22m[39m
    [90m203| [39m        }[33m;[39m
    [90m204| [39m
    [90m205| [39m        engine[33m.[39m[34maddMetricsSnapshot[39m(userId[33m,[39m snapshot)[33m;[39m
    [90m   | [39m               [31m^[39m
    [90m206| [39m      }
    [90m207| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[94/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mMetrics Collection[2m > [22mshould clean up old snapshots beyond 24 hours
[31m[1mTypeError[22m: engine.addMetricsSnapshot is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m238:14[22m[39m
    [90m236| [39m      }[33m;[39m
    [90m237| [39m
    [90m238| [39m      engine[33m.[39m[34maddMetricsSnapshot[39m(userId[33m,[39m oldSnapshot)[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m239| [39m      engine[33m.[39m[34maddMetricsSnapshot[39m(userId[33m,[39m recentSnapshot)[33m;[39m
    [90m240| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[95/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mTime Windows[2m > [22mshould parse 5 minute window
[31m[1mTypeError[22m: engine.addMetricsSnapshot is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m258:14[22m[39m
    [90m256| [39m      }[33m;[39m
    [90m257| [39m
    [90m258| [39m      engine[33m.[39m[34maddMetricsSnapshot[39m(userId[33m,[39m snapshot)[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m259| [39m
    [90m260| [39m      [90m// Window parsing verified[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[96/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Cooldown[2m > [22mshould respect cooldown period
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m294:33[22m[39m
    [90m292| [39m      }[33m;[39m
    [90m293| [39m
    [90m294| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m295| [39m
    [90m296| [39m      [90m// First alert should trigger[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[97/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Severity Levels[2m > [22mshould support info severity
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m329:33[22m[39m
    [90m327| [39m      }[33m;[39m
    [90m328| [39m
    [90m329| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m330| [39m      [34mexpect[39m(rule[33m.[39mseverity)[33m.[39m[34mtoBe[39m([32m'info'[39m)[33m;[39m
    [90m331| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[98/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Severity Levels[2m > [22mshould support warning severity
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m349:33[22m[39m
    [90m347| [39m      }[33m;[39m
    [90m348| [39m
    [90m349| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m350| [39m      [34mexpect[39m(rule[33m.[39mseverity)[33m.[39m[34mtoBe[39m([32m'warning'[39m)[33m;[39m
    [90m351| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[99/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Severity Levels[2m > [22mshould support critical severity
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m369:33[22m[39m
    [90m367| [39m      }[33m;[39m
    [90m368| [39m
    [90m369| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m370| [39m      [34mexpect[39m(rule[33m.[39mseverity)[33m.[39m[34mtoBe[39m([32m'critical'[39m)[33m;[39m
    [90m371| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[100/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support Discord channel
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m391:33[22m[39m
    [90m389| [39m      }[33m;[39m
    [90m390| [39m
    [90m391| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m392| [39m      [34mexpect[39m(rule[33m.[39mchannels)[33m.[39m[34mtoContain[39m([32m'discord'[39m)[33m;[39m
    [90m393| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[101/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support email channel
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m411:33[22m[39m
    [90m409| [39m      }[33m;[39m
    [90m410| [39m
    [90m411| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m412| [39m      [34mexpect[39m(rule[33m.[39mchannels)[33m.[39m[34mtoContain[39m([32m'email'[39m)[33m;[39m
    [90m413| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[102/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support SMS channel
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m431:33[22m[39m
    [90m429| [39m      }[33m;[39m
    [90m430| [39m
    [90m431| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m432| [39m      [34mexpect[39m(rule[33m.[39mchannels)[33m.[39m[34mtoContain[39m([32m'sms'[39m)[33m;[39m
    [90m433| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[103/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Channels[2m > [22mshould support in-app channel
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m451:33[22m[39m
    [90m449| [39m      }[33m;[39m
    [90m450| [39m
    [90m451| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m452| [39m      [34mexpect[39m(rule[33m.[39mchannels)[33m.[39m[34mtoContain[39m([32m'in_app'[39m)[33m;[39m
    [90m453| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[104/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mEvaluation Loop[2m > [22mshould stop evaluation loop
[31m[1mTypeError[22m: engine.stopEvaluation is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m491:14[22m[39m
    [90m489| [39m    [34mit[39m([32m'should stop evaluation loop'[39m[33m,[39m () [33m=>[39m {
    [90m490| [39m      engine[33m.[39m[34mstartEvaluation[39m([34m5000[39m)[33m;[39m
    [90m491| [39m      engine[33m.[39m[34mstopEvaluation[39m()[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m492| [39m      [90m// Loop stopped successfully[39m
    [90m493| [39m      [34mexpect[39m([35mtrue[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[105/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mEvaluation Loop[2m > [22mshould not double-start evaluation loop
[31m[1mTypeError[22m: engine.stopEvaluation is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m499:14[22m[39m
    [90m497| [39m      engine[33m.[39m[34mstartEvaluation[39m([34m5000[39m)[33m;[39m
    [90m498| [39m      engine[33m.[39m[34mstartEvaluation[39m([34m5000[39m)[33m;[39m [90m// Should replace previous[39m
    [90m499| [39m      engine[33m.[39m[34mstopEvaluation[39m()[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m500| [39m      [90m// No error on double start[39m
    [90m501| [39m      [34mexpect[39m([35mtrue[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[106/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Acknowledgment[2m > [22mshould acknowledge an alert
[31m[1mTypeError[22m: engine.acknowledgeAlert is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m507:20[22m[39m
    [90m505| [39m  [34mdescribe[39m([32m'Alert Acknowledgment'[39m[33m,[39m () [33m=>[39m {
    [90m506| [39m    [34mit[39m([32m'should acknowledge an alert'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m507| [39m      [35mawait[39m engine[33m.[39m[34macknowledgeAlert[39m([32m'alert-123'[39m)[33m;[39m
    [90m   | [39m                   [31m^[39m
    [90m508| [39m      [90m// Alert acknowledged (database operation)[39m
    [90m509| [39m      [34mexpect[39m([35mtrue[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[107/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mAlert Resolution[2m > [22mshould resolve an alert
[31m[1mTypeError[22m: engine.resolveAlert is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m515:20[22m[39m
    [90m513| [39m  [34mdescribe[39m([32m'Alert Resolution'[39m[33m,[39m () [33m=>[39m {
    [90m514| [39m    [34mit[39m([32m'should resolve an alert'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m515| [39m      [35mawait[39m engine[33m.[39m[34mresolveAlert[39m([32m'alert-456'[39m)[33m;[39m
    [90m   | [39m                   [31m^[39m
    [90m516| [39m      [90m// Alert resolved (database operation)[39m
    [90m517| [39m      [34mexpect[39m([35mtrue[39m)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[108/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRules Retrieval[2m > [22mshould get rules for a user
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m538:20[22m[39m
    [90m536| [39m      }[33m;[39m
    [90m537| [39m
    [90m538| [39m      [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                   [31m^[39m
    [90m539| [39m
    [90m540| [39m      [35mconst[39m rules [33m=[39m [35mawait[39m engine[33m.[39m[34mgetRules[39m(userId)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[109/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Updates[2m > [22mshould update an alert rule
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m562:33[22m[39m
    [90m560| [39m      }[33m;[39m
    [90m561| [39m
    [90m562| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m563| [39m
    [90m564| [39m      [35mconst[39m updated [33m=[39m [35mawait[39m engine[33m.[39m[34mupdateRule[39m(rule[33m.[39mid[33m,[39m {

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[110/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mRule Deletion[2m > [22mshould delete an alert rule
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m589:33[22m[39m
    [90m587| [39m      }[33m;[39m
    [90m588| [39m
    [90m589| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m590| [39m      [35mconst[39m deleted [33m=[39m [35mawait[39m engine[33m.[39m[34mdeleteRule[39m(rule[33m.[39mid)[33m;[39m
    [90m591| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[111/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create high error rate alert (> 5% in 5 min)
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m624:33[22m[39m
    [90m622| [39m      }[33m;[39m
    [90m623| [39m
    [90m624| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m625| [39m      [34mexpect[39m(rule[33m.[39mseverity)[33m.[39m[34mtoBe[39m([32m'critical'[39m)[33m;[39m
    [90m626| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[112/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create high latency alert (> 2000ms in 15 min)
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m644:33[22m[39m
    [90m642| [39m      }[33m;[39m
    [90m643| [39m
    [90m644| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m645| [39m      [34mexpect[39m(rule[33m.[39mseverity)[33m.[39m[34mtoBe[39m([32m'warning'[39m)[33m;[39m
    [90m646| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[113/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create cost spike alert (> 120% in 1h)
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m664:33[22m[39m
    [90m662| [39m      }[33m;[39m
    [90m663| [39m
    [90m664| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m665| [39m      [34mexpect[39m(rule[33m.[39mcondition[33m.[39mthreshold)[33m.[39m[34mtoBe[39m([34m120[39m)[33m;[39m
    [90m666| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[114/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/alerting/alert-engine.test.ts[2m > [22mAlertEngine[2m > [22mDefault Alert Rules[2m > [22mshould create budget exceeded alert
[31m[1mTypeError[22m: engine.createRule is not a function[39m
[36m [2mâ¯[22m src/services/alerting/alert-engine.test.ts:[2m684:33[22m[39m
    [90m682| [39m      }[33m;[39m
    [90m683| [39m
    [90m684| [39m      [35mconst[39m rule [33m=[39m [35mawait[39m engine[33m.[39m[34mcreateRule[39m(userId[33m,[39m ruleData)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m685| [39m      [34mexpect[39m(rule[33m.[39mseverity)[33m.[39m[34mtoBe[39m([32m'critical'[39m)[33m;[39m
    [90m686| [39m      [34mexpect[39m(rule[33m.[39mchannels[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m2[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[115/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/batching/batch-executor.test.ts[2m > [22mBatchExecutor[2m > [22mBatch Execution[2m > [22mshould execute a batch successfully
[31m[1mAssertionError[22m: promise rejected "Error: Failed to load batch operations: uâ€¦" instead of resolving[39m
[36m [2mâ¯[22m src/services/batching/batch-executor.test.ts:[2m187:50[22m[39m
    [90m185| [39m
    [90m186| [39m      [35mconst[39m batchId [33m=[39m [35mawait[39m executor[33m.[39m[34mcreateBatch[39m(config)[33m;[39m
    [90m187| [39m      await expect(executor.executeBatch(batchId)).resolves.not.toThroâ€¦
    [90m   | [39m                                                 [31m^[39m
    [90m188| [39m    })[33m;[39m
    [90m189| [39m

[31m[1mCaused by: Error[22m: Failed to load batch operations: undefined[39m
[36m [2mâ¯[22m BatchExecutor.executeBatch src/services/batching/batch-executor.ts:[2m184:15[22m[39m
[90m [2mâ¯[22m src/services/batching/batch-executor.test.ts:[2m187:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[116/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/batching/batch-executor.test.ts[2m > [22mBatchExecutor[2m > [22mBatch Execution[2m > [22mshould handle batch execution failure gracefully
[31m[1mAssertionError[22m: promise rejected "Error: Failed to load batch operations: uâ€¦" instead of resolving[39m
[36m [2mâ¯[22m src/services/batching/batch-executor.test.ts:[2m225:50[22m[39m
    [90m223| [39m      [35mconst[39m batchId [33m=[39m [35mawait[39m executor[33m.[39m[34mcreateBatch[39m(config)[33m;[39m
    [90m224| [39m      [90m// Execution may fail but should be handled gracefully[39m
    [90m225| [39m      await expect(executor.executeBatch(batchId)).resolves.not.toThroâ€¦
    [90m   | [39m                                                 [31m^[39m
    [90m226| [39m    })[33m;[39m
    [90m227| [39m  })[33m;[39m

[31m[1mCaused by: Error[22m: Failed to load batch operations: undefined[39m
[36m [2mâ¯[22m BatchExecutor.executeBatch src/services/batching/batch-executor.ts:[2m184:15[22m[39m
[90m [2mâ¯[22m src/services/batching/batch-executor.test.ts:[2m225:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[117/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/batching/batch-executor.test.ts[2m > [22mBatchExecutor[2m > [22mError Handling[2m > [22mshould handle invalid batch type gracefully
[31m[1mAssertionError[22m: promise rejected "Error: Failed to load batch operations: uâ€¦" instead of resolving[39m
[36m [2mâ¯[22m src/services/batching/batch-executor.test.ts:[2m403:55[22m[39m
    [90m401| [39m
    [90m402| [39m      [90m// Execution should fail gracefully[39m
    [90m403| [39m      await expect(executor.executeBatch('invalid-id')).resolves.not.tâ€¦
    [90m   | [39m                                                      [31m^[39m
    [90m404| [39m    })[33m;[39m
    [90m405| [39m

[31m[1mCaused by: Error[22m: Failed to load batch operations: undefined[39m
[36m [2mâ¯[22m BatchExecutor.executeBatch src/services/batching/batch-executor.ts:[2m184:15[22m[39m
[90m [2mâ¯[22m src/services/batching/batch-executor.test.ts:[2m403:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[118/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/intelligence/analytics-intelligence.test.ts[2m > [22mAnalytics Intelligence Service[2m > [22mToken Estimation for Analytics[2m > [22mshould estimate tokens for weekly summary prompt
[31m[1mAssertionError[22m: expected 69 to be greater than 100[39m
[36m [2mâ¯[22m src/services/intelligence/analytics-intelligence.test.ts:[2m264:22[22m[39m
    [90m262| [39m      [35mconst[39m tokens [33m=[39m [33mMath[39m[33m.[39m[34mceil[39m(prompt[33m.[39mlength [33m/[39m [34m4[39m)[33m;[39m
    [90m263| [39m
    [90m264| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeGreaterThan[39m([34m100[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m265| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeLessThan[39m([34m500[39m)[33m;[39m
    [90m266| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[119/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/intelligence/analytics-intelligence.test.ts[2m > [22mAnalytics Intelligence Service[2m > [22mToken Estimation for Analytics[2m > [22mshould estimate tokens for anomaly detection prompt
[31m[1mAssertionError[22m: expected 45 to be greater than 50[39m
[36m [2mâ¯[22m src/services/intelligence/analytics-intelligence.test.ts:[2m276:22[22m[39m
    [90m274| [39m      [35mconst[39m tokens [33m=[39m [33mMath[39m[33m.[39m[34mceil[39m(prompt[33m.[39mlength [33m/[39m [34m4[39m)[33m;[39m
    [90m275| [39m
    [90m276| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeGreaterThan[39m([34m50[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m277| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeLessThan[39m([34m500[39m)[33m;[39m
    [90m278| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[120/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/intelligence/analytics-intelligence.test.ts[2m > [22mAnalytics Intelligence Service[2m > [22mScheduler Integration[2m > [22mshould calculate next Sunday at 6pm
[31m[1mAssertionError[22m: expected 6 to be +0 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 0[39m
[31m+ 6[39m

[36m [2mâ¯[22m src/services/intelligence/analytics-intelligence.test.ts:[2m383:35[22m[39m
    [90m381| [39m      nextSunday[33m.[39m[34msetHours[39m([34m18[39m[33m,[39m [34m0[39m[33m,[39m [34m0[39m[33m,[39m [34m0[39m)[33m;[39m
    [90m382| [39m
    [90m383| [39m      [34mexpect[39m(nextSunday[33m.[39m[34mgetDay[39m())[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m384| [39m      [34mexpect[39m(nextSunday[33m.[39m[34mgetHours[39m())[33m.[39m[34mtoBe[39m([34m18[39m)[33m;[39m
    [90m385| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[121/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/intelligence/calendar-intelligence.test.ts[2m > [22mCalendar Intelligence Service[2m > [22mCost Calculation[2m > [22mshould combine to ~$0.0105 per day if called twice each
[31m[1mAssertionError[22m: expected 0.036500000000000005 to be close to 0.0245, received difference is 0.012000000000000004, but expected 0.0005[39m
[36m [2mâ¯[22m src/services/intelligence/calendar-intelligence.test.ts:[2m270:30[22m[39m
    [90m268| [39m      [35mconst[39m totalDailyCost [33m=[39m prepCost [33m+[39m timeCost[33m;[39m
    [90m269| [39m
    [90m270| [39m      [34mexpect[39m(totalDailyCost)[33m.[39m[34mtoBeCloseTo[39m([34m0.0245[39m[33m,[39m [34m3[39m)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m271| [39m    })[33m;[39m
    [90m272| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[122/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/intelligence/integration.test.ts[2m > [22mPhase 8: Intelligence Services Integration[2m > [22mService Layer Token Estimation[2m > [22mshould estimate tokens for analytics summary
[31m[1mAssertionError[22m: expected 27 to be greater than 50[39m
[36m [2mâ¯[22m src/services/intelligence/integration.test.ts:[2m252:31[22m[39m
    [90m250| [39m      [35mconst[39m estimatedTokens [33m=[39m [33mMath[39m[33m.[39m[34mceil[39m(metricsContent[33m.[39mlength [33m/[39m [34m4[39m)[33m;[39m
    [90m251| [39m
    [90m252| [39m      [34mexpect[39m(estimatedTokens)[33m.[39m[34mtoBeGreaterThan[39m([34m50[39m)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m253| [39m    })[33m;[39m
    [90m254| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[123/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/intelligence/task-intelligence.test.ts[2m > [22mTask Intelligence Service[2m > [22mToken Estimation for Tasks[2m > [22mshould estimate tokens for breakdown prompt
[31m[1mAssertionError[22m: expected 25 to be greater than 30[39m
[36m [2mâ¯[22m src/services/intelligence/task-intelligence.test.ts:[2m263:22[22m[39m
    [90m261| [39m      [35mconst[39m tokens [33m=[39m [33mMath[39m[33m.[39m[34mceil[39m(prompt[33m.[39mlength [33m/[39m [34m4[39m)[33m;[39m
    [90m262| [39m
    [90m263| [39m      [34mexpect[39m(tokens)[33m.[39m[34mtoBeGreaterThan[39m([34m30[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m264| [39m    })[33m;[39m
    [90m265| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[124/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mCostTracker Tests[2m > [22mCost Calculation[2m > [22mcalculates Gemini 2.0 Flash cost correctly
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m src/services/llm-router/llm-router.test.ts:[2m88:22[22m[39m
    [90m 86| [39m      [34mit[39m([32m'calculates Gemini 2.0 Flash cost correctly'[39m[33m,[39m () [33m=>[39m {
    [90m 87| [39m        const cost = tracker.calculateOperationCost('gemini-2.0-flash'â€¦
    [90m 88| [39m        [34mexpect[39m(cost)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 89| [39m        [34mexpect[39m(cost)[33m.[39m[34mtoBeLessThan[39m([34m0.001[39m)[33m;[39m [90m// Cheapest option[39m
    [90m 90| [39m      })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[125/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mCostTracker Tests[2m > [22mModel Pricing[2m > [22mreturns correct pricing for Claude Opus 4.5
[31m[1mAssertionError[22m: expected 0.003 to be 3 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 3[39m
[31m+ 0.003[39m

[36m [2mâ¯[22m src/services/llm-router/llm-router.test.ts:[2m200:44[22m[39m
    [90m198| [39m      [34mit[39m([32m'returns correct pricing for Claude Opus 4.5'[39m[33m,[39m () [33m=>[39m {
    [90m199| [39m        [35mconst[39m pricing [33m=[39m tracker[33m.[39m[34mgetModelPricing[39m([32m'claude-opus-4.5'[39m)[33m;[39m
    [90m200| [39m        [34mexpect[39m(pricing[33m.[39minputCostPerMToken)[33m.[39m[34mtoBe[39m([34m3.0[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m201| [39m        [34mexpect[39m(pricing[33m.[39moutputCostPerMToken)[33m.[39m[34mtoBe[39m([34m15.0[39m)[33m;[39m
    [90m202| [39m      })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[126/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mCostTracker Tests[2m > [22mModel Pricing[2m > [22mreturns correct pricing for DeepSeek v3.2
[31m[1mAssertionError[22m: expected 0.0006 to be 0.6 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 0.6[39m
[31m+ 0.0006[39m

[36m [2mâ¯[22m src/services/llm-router/llm-router.test.ts:[2m206:44[22m[39m
    [90m204| [39m      [34mit[39m([32m'returns correct pricing for DeepSeek v3.2'[39m[33m,[39m () [33m=>[39m {
    [90m205| [39m        [35mconst[39m pricing [33m=[39m tracker[33m.[39m[34mgetModelPricing[39m([32m'deepseek-v3.2'[39m)[33m;[39m
    [90m206| [39m        [34mexpect[39m(pricing[33m.[39minputCostPerMToken)[33m.[39m[34mtoBe[39m([34m0.6[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m207| [39m        [34mexpect[39m(pricing[33m.[39moutputCostPerMToken)[33m.[39m[34mtoBe[39m([34m2.0[39m)[33m;[39m
    [90m208| [39m      })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[127/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mCostTracker Tests[2m > [22mModel Pricing[2m > [22mreturns correct pricing for Gemini 2.0 Flash
[31m[1mAssertionError[22m: expected 0.00005 to be 0.05 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 0.05[39m
[31m+ 0.00005[39m

[36m [2mâ¯[22m src/services/llm-router/llm-router.test.ts:[2m212:44[22m[39m
    [90m210| [39m      [34mit[39m([32m'returns correct pricing for Gemini 2.0 Flash'[39m[33m,[39m () [33m=>[39m {
    [90m211| [39m        [35mconst[39m pricing [33m=[39m tracker[33m.[39m[34mgetModelPricing[39m([32m'gemini-2.0-flash'[39m)[33m;[39m
    [90m212| [39m        [34mexpect[39m(pricing[33m.[39minputCostPerMToken)[33m.[39m[34mtoBe[39m([34m0.05[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m213| [39m        [34mexpect[39m(pricing[33m.[39moutputCostPerMToken)[33m.[39m[34mtoBe[39m([34m0.2[39m)[33m;[39m
    [90m214| [39m      })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[128/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mOperation Loading[2m > [22minitializes with operations loaded
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mOperation Loading[2m > [22mcaches operations for performance
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mOperation Loading[2m > [22mclears operation cache on demand
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mRouting Decisions[2m > [22mreturns routing decision for email-compose operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mRouting Decisions[2m > [22muses primary model when available
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mRouting Decisions[2m > [22mmarks operation as not requiring approval when in budget
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mRouting Decisions[2m > [22mindicates budget status in routing decision
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mRouting Decisions[2m > [22msets isFeatureEnabled to true by default
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mOperation Execution[2m > [22mexecutes operation successfully
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mOperation Execution[2m > [22mhandles execution errors gracefully
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mOperation Execution[2m > [22mtracks execution latency
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mEmail Intelligence Operations[2m > [22mroutes email-compose operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mEmail Intelligence Operations[2m > [22mroutes email-classify operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mEmail Intelligence Operations[2m > [22mroutes email-respond operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mCalendar Intelligence Operations[2m > [22mroutes calendar-prep operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mCalendar Intelligence Operations[2m > [22mroutes calendar-time operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mTask Intelligence Operations[2m > [22mroutes task-prioritize operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mTask Intelligence Operations[2m > [22mroutes task-breakdown operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mAnalytics Intelligence Operations[2m > [22mroutes analytics-summary operation
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mLLMRouter Tests[2m > [22mAnalytics Intelligence Operations[2m > [22mroutes analytics-anomaly operation
[31m[1mError[22m: [vitest] No "logToHashChain" export is defined on the "@/services/logging" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("@/services/logging"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m LLMRouter.initialize src/services/llm-router/router.ts:[2m72:11[22m[39m
    [90m 70| [39m    } [35mas[39m any)[33m;[39m
    [90m 71| [39m
    [90m 72| [39m    [35mawait[39m [34mlogToHashChain[39m({
    [90m   | [39m          [31m^[39m
    [90m 73| [39m      type[33m:[39m [32m'llm_router_initialized'[39m[33m,[39m
    [90m 74| [39m      data: JSON.stringify({ operationsCount: this.operationsCache.sizâ€¦
[90m [2mâ¯[22m src/services/llm-router/llm-router.test.ts:[2m267:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[129/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mIntegration Tests[2m > [22mcoordinates between router and cost tracker
[41m[1m FAIL [22m[49m src/services/llm-router/llm-router.test.ts[2m > [22mPhase 8: LLM Router Tests[2m > [22mIntegration Tests[2m > [22mprocesses complete operation workflow
[31m[1mError[22m: [vitest] No "logToHashChain" export is defined on the "@/services/logging" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("@/services/logging"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m LLMRouter.initialize src/services/llm-router/router.ts:[2m72:11[22m[39m
    [90m 70| [39m    } [35mas[39m any)[33m;[39m
    [90m 71| [39m
    [90m 72| [39m    [35mawait[39m [34mlogToHashChain[39m({
    [90m   | [39m          [31m^[39m
    [90m 73| [39m      type[33m:[39m [32m'llm_router_initialized'[39m[33m,[39m
    [90m 74| [39m      data: JSON.stringify({ operationsCount: this.operationsCache.sizâ€¦
[90m [2mâ¯[22m src/services/llm-router/llm-router.test.ts:[2m559:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[130/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/preferences/preferences.service.test.ts[2m > [22mPreferencesService[2m > [22mOperation Preferences[2m > [22mshould bulk update operation preferences
[31m[1mAssertionError[22m: expected +0 to be 2 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 0[39m

[36m [2mâ¯[22m src/services/preferences/preferences.service.test.ts:[2m95:30[22m[39m
    [90m 93| [39m
    [90m 94| [39m      const results = await service.bulkUpdateOperationPreferences(useâ€¦
    [90m 95| [39m      [34mexpect[39m(results[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m2[39m)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m 96| [39m    })[33m;[39m
    [90m 97| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[131/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConnection Management[2m > [22mshould connect to WebSocket server
[31m[1mAssertionError[22m: promise rejected "Event{ isTrusted: true, â€¦(1) }" instead of resolving[39m
[36m [2mâ¯[22m src/services/monitoring/metrics-stream.test.ts:[2m68:46[22m[39m
    [90m 66| [39m  [34mdescribe[39m([32m'Connection Management'[39m[33m,[39m () [33m=>[39m {
    [90m 67| [39m    [34mit[39m([32m'should connect to WebSocket server'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m 68| [39m      await expect(service.connect('user123')).resolves.toBeUndefined(â€¦
    [90m   | [39m                                             [31m^[39m
    [90m 69| [39m      [34mexpect[39m(service[33m.[39m[34misConnected[39m())[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m 70| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[132/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConnection Management[2m > [22mshould disconnect from WebSocket server
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932854,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[133/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConnection Management[2m > [22mshould support reconnection with exponential backoff
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932869,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[134/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Subscription[2m > [22mshould subscribe to specific event type
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932884,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[135/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Subscription[2m > [22mshould support multiple subscribers for same event
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932898,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[136/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Subscription[2m > [22mshould return unsubscribe function
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932918,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[137/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Subscription[2m > [22mshould subscribe to multiple event types at once
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932934,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[138/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Handling[2m > [22mshould deliver operation_complete event to subscribers
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932947,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[139/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Handling[2m > [22mshould deliver operation_failed event to subscribers
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932966,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[140/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Handling[2m > [22mshould deliver cost_update event to subscribers
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932981,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[141/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Handling[2m > [22mshould deliver sla_update event to subscribers
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299932997,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[142/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mEvent Handling[2m > [22mshould handle errors in event listeners gracefully
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933021,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[143/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mBatch Progress Events[2m > [22mshould track batch operation progress
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933056,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[144/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mBatch Progress Events[2m > [22mshould handle progress from 0 to 100
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933120,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[145/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConnection Status[2m > [22mshould report connected status
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933163,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[146/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConnection Status[2m > [22mshould handle token from localStorage
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933209,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[147/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConnection Status[2m > [22mshould prefer explicit token over localStorage
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933290,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[148/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mListener Management[2m > [22mshould return listener counts
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933332,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[149/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mListener Management[2m > [22mshould clear all listeners on disconnect
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933367,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[150/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConcurrent Event Handling[2m > [22mshould handle rapid successive events
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933429,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[151/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/monitoring/metrics-stream.test.ts[2m > [22mMetricsStreamService[2m > [22mConcurrent Event Handling[2m > [22mshould handle mixed event types concurrently
{
  isTrusted: true,
  constructor: 'Function<Event>',
  composedPath: 'Function<composedPath>',
  stopPropagation: 'Function<stopPropagation>',
  stopImmediatePropagation: 'Function<stopImmediatePropagation>',
  preventDefault: 'Function<preventDefault>',
  initEvent: 'Function<initEvent>',
  type: 'error',
  target: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  srcElement: {
    constructor: 'Function<WebSocket>',
    close: 'Function<close>',
    send: 'Function<send>',
    url: 'ws://localhost:3000/metrics',
    readyState: 3,
    bufferedAmount: 0,
    onopen: 'Function<anonymous>',
    onerror: 'Function<anonymous>',
    onclose: 'Function<anonymous>',
    extensions: '',
    protocol: '',
    onmessage: 'Function<anonymous>',
    binaryType: 'blob',
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: 'Function<addEventListener>',
    removeEventListener: 'Function<removeEventListener>',
    dispatchEvent: 'Function<dispatchEvent>',
    __defineGetter__: 'Function<__defineGetter__>',
    __defineSetter__: 'Function<__defineSetter__>',
    hasOwnProperty: 'Function<hasOwnProperty>',
    __lookupGetter__: 'Function<__lookupGetter__>',
    __lookupSetter__: 'Function<__lookupSetter__>',
    isPrototypeOf: 'Function<isPrototypeOf>',
    propertyIsEnumerable: 'Function<propertyIsEnumerable>',
    toString: 'Function<toString>',
    valueOf: 'Function<valueOf>',
    ['__proto__']: {
      constructor: 'Function<WebSocket>',
      close: 'Function<close>',
      send: 'Function<send>',
      url: '<unserializable>',
      readyState: '<unserializable>',
      bufferedAmount: '<unserializable>',
      onopen: '<unserializable>',
      onerror: '<unserializable>',
      onclose: '<unserializable>',
      extensions: '<unserializable>',
      protocol: '<unserializable>',
      onmessage: '<unserializable>',
      binaryType: '<unserializable>',
      CONNECTING: 0,
      OPEN: 1,
      CLOSING: 2,
      CLOSED: 3,
      addEventListener: 'Function<addEventListener>',
      removeEventListener: 'Function<removeEventListener>',
      dispatchEvent: 'Function<dispatchEvent>',
      __defineGetter__: 'Function<__defineGetter__>',
      __defineSetter__: 'Function<__defineSetter__>',
      hasOwnProperty: 'Function<hasOwnProperty>',
      __lookupGetter__: 'Function<__lookupGetter__>',
      __lookupSetter__: 'Function<__lookupSetter__>',
      isPrototypeOf: 'Function<isPrototypeOf>',
      propertyIsEnumerable: 'Function<propertyIsEnumerable>',
      toString: 'Function<toString>',
      valueOf: 'Function<valueOf>',
      ['__proto__']: [Object],
      toLocaleString: 'Function<toLocaleString>'
    },
    toLocaleString: 'Function<toLocaleString>'
  },
  currentTarget: null,
  eventPhase: 0,
  cancelBubble: false,
  bubbles: false,
  cancelable: false,
  returnValue: true,
  defaultPrevented: false,
  composed: false,
  timeStamp: 1770299933483,
  NONE: 0,
  CAPTURING_PHASE: 1,
  AT_TARGET: 2,
  BUBBLING_PHASE: 3,
  stacks: []
}
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[152/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mInitialization[2m > [22mshould initialize with default Redis URL
[31m[1mTypeError[22m: newLimiter.close is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m60:18[22m[39m
    [90m 58| [39m      [35mconst[39m newLimiter [33m=[39m [35mnew[39m [33mRedisRateLimiter[39m()[33m;[39m
    [90m 59| [39m      [34mexpect[39m(newLimiter)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 60| [39m      newLimiter[33m.[39m[34mclose[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 61| [39m    })[33m;[39m
    [90m 62| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[153/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mInitialization[2m > [22mshould initialize with default Redis URL
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mInitialization[2m > [22mshould initialize with custom Redis URL
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mInitialization[2m > [22mshould load Lua script on initialization
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould allow request within limit
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould deny request when limit exceeded
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould decrement remaining tokens on each request
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould use custom limit value
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould use custom window value
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mToken Bucket Algorithm[2m > [22mshould reset bucket after window expires
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mToken Bucket Algorithm[2m > [22mshould not allow overfilling bucket
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mQuota Management[2m > [22mshould get current quota
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mQuota Management[2m > [22mshould return default quota when key missing
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mQuota Management[2m > [22mshould reset rate limit for user
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mMonitoring[2m > [22mshould get all active rate limit keys
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mMonitoring[2m > [22mshould support custom key patterns
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConcurrent Requests[2m > [22mshould handle multiple concurrent requests
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConcurrent Requests[2m > [22mshould handle concurrent requests for different users
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mError Handling[2m > [22mshould fail open when Redis is unavailable
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mError Handling[2m > [22mshould reload script on NOSCRIPT error
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mError Handling[2m > [22mshould handle get quota errors gracefully
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mError Handling[2m > [22mshould handle reset limit errors gracefully
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mResponse Headers[2m > [22mshould include reset time in response
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mResponse Headers[2m > [22mshould include retry-after for denied requests
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mResponse Headers[2m > [22mshould not include retry-after for allowed requests
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConnection Lifecycle[2m > [22mshould close Redis connection
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConnection Lifecycle[2m > [22mshould handle close errors gracefully
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mSingleton Pattern[2m > [22mshould provide singleton instance
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mSingleton Pattern[2m > [22mshould allow custom config on first initialization
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mHigh Volume Load[2m > [22mshould handle 1000 requests efficiently
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mIntegration Scenarios[2m > [22mshould support API rate limiting workflow
[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mIntegration Scenarios[2m > [22mshould support per-operation rate limiting
[31m[1mTypeError[22m: limiter.close is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m53:19[22m[39m
    [90m 51| [39m
    [90m 52| [39m  [34mafterEach[39m([35masync[39m () [33m=>[39m {
    [90m 53| [39m    [35mawait[39m limiter[33m.[39m[34mclose[39m()[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m 54| [39m  })[33m;[39m
    [90m 55| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[154/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mInitialization[2m > [22mshould initialize with custom Redis URL
[31m[1mTypeError[22m: newLimiter.close is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m68:18[22m[39m
    [90m 66| [39m      })[33m;[39m
    [90m 67| [39m      [34mexpect[39m(newLimiter)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 68| [39m      newLimiter[33m.[39m[34mclose[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 69| [39m    })[33m;[39m
    [90m 70| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[155/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mInitialization[2m > [22mshould load Lua script on initialization
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'LOAD', Any<String> ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m77:38[22m[39m
    [90m 75| [39m      [35mawait[39m [35mnew[39m [33mPromise[39m(resolve [33m=>[39m [34msetTimeout[39m(resolve[33m,[39m [34m100[39m))[33m;[39m
    [90m 76| [39m
    [90m 77| [39m      expect(mockRedisClient.script).toHaveBeenCalledWith('LOAD', expeâ€¦
    [90m   | [39m                                     [31m^[39m
    [90m 78| [39m      newLimiter[33m.[39m[34mclose[39m()[33m;[39m
    [90m 79| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[156/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould deny request when limit exceeded
[31m[1mAssertionError[22m: expected true to be false // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- false[39m
[31m+ true[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m99:30[22m[39m
    [90m 97| [39m      [35mconst[39m result [33m=[39m [35mawait[39m limiter[33m.[39m[34mcheckLimit[39m(userId[33m,[39m [34m60[39m[33m,[39m [34m60[39m)[33m;[39m
    [90m 98| [39m
    [90m 99| [39m      [34mexpect[39m(result[33m.[39mallowed)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m100| [39m      [34mexpect[39m(result[33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m101| [39m      [34mexpect[39m(result[33m.[39mretryAfter)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[157/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mRate Limiting[2m > [22mshould decrement remaining tokens on each request
[31m[1mAssertionError[22m: expected 59 to be 55 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 55[39m
[31m+ 59[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m110:32[22m[39m
    [90m108| [39m      [35mconst[39m result [33m=[39m [35mawait[39m limiter[33m.[39m[34mcheckLimit[39m(userId[33m,[39m [34m60[39m[33m,[39m [34m60[39m)[33m;[39m
    [90m109| [39m
    [90m110| [39m      [34mexpect[39m(result[33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m55[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m111| [39m      [34mexpect[39m(mockRedisClient[33m.[39mevalsha)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m112| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[158/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mQuota Management[2m > [22mshould get current quota
[31m[1mAssertionError[22m: expected 60 to be 45 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 45[39m
[31m+ 60[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m162:31[22m[39m
    [90m160| [39m      [35mconst[39m quota [33m=[39m [35mawait[39m limiter[33m.[39m[34mgetQuota[39m(userId)[33m;[39m
    [90m161| [39m
    [90m162| [39m      [34mexpect[39m(quota[33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m45[39m)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m163| [39m      [34mexpect[39m(quota[33m.[39mreset)[33m.[39m[34mtoBeGreaterThan[39m([33mDate[39m[33m.[39m[34mnow[39m())[33m;[39m
    [90m164| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[159/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mQuota Management[2m > [22mshould reset rate limit for user
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'rate_limit:test-user-123' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m179:35[22m[39m
    [90m177| [39m      [35mawait[39m limiter[33m.[39m[34mresetLimit[39m(userId)[33m;[39m
    [90m178| [39m
    [90m179| [39m      expect(mockRedisClient.del).toHaveBeenCalledWith(`rate_limit:${uâ€¦
    [90m   | [39m                                  [31m^[39m
    [90m180| [39m    })[33m;[39m
    [90m181| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[160/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mMonitoring[2m > [22mshould get all active rate limit keys
[31m[1mTypeError[22m: limiter.getActiveKeys is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m188:34[22m[39m
    [90m186| [39m      mockRedisClient[33m.[39mkeys[33m.[39m[34mmockResolvedValue[39m(activeKeys)[33m;[39m
    [90m187| [39m
    [90m188| [39m      [35mconst[39m keys [33m=[39m [35mawait[39m limiter[33m.[39m[34mgetActiveKeys[39m()[33m;[39m
    [90m   | [39m                                 [31m^[39m
    [90m189| [39m
    [90m190| [39m      [34mexpect[39m(keys)[33m.[39m[34mtoEqual[39m(activeKeys)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[161/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mMonitoring[2m > [22mshould support custom key patterns
[31m[1mTypeError[22m: limiter.getActiveKeys is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m197:21[22m[39m
    [90m195| [39m      mockRedisClient[33m.[39mkeys[33m.[39m[34mmockResolvedValue[39m([])[33m;[39m
    [90m196| [39m
    [90m197| [39m      [35mawait[39m limiter[33m.[39m[34mgetActiveKeys[39m([32m'custom_pattern:*'[39m)[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m198| [39m
    [90m199| [39m      expect(mockRedisClient.keys).toHaveBeenCalledWith('custom_patterâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[162/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConcurrent Requests[2m > [22mshould handle multiple concurrent requests
[31m[1mAssertionError[22m: expected 59 to be 58 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 58[39m
[31m+ 59[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m217:36[22m[39m
    [90m215| [39m
    [90m216| [39m      [34mexpect[39m(results[[34m0[39m][33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m59[39m)[33m;[39m
    [90m217| [39m      [34mexpect[39m(results[[34m1[39m][33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m58[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m218| [39m      [34mexpect[39m(results[[34m2[39m][33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m57[39m)[33m;[39m
    [90m219| [39m      [34mexpect[39m(results[33m.[39m[34mevery[39m(r [33m=>[39m r[33m.[39mallowed))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[163/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mError Handling[2m > [22mshould fail open when Redis is unavailable
[31m[1mAssertionError[22m: expected 59 to be +0 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 0[39m
[31m+ 59[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m245:32[22m[39m
    [90m243| [39m
    [90m244| [39m      [34mexpect[39m(result[33m.[39mallowed)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m245| [39m      [34mexpect[39m(result[33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m246| [39m    })[33m;[39m
    [90m247| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[164/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mError Handling[2m > [22mshould reload script on NOSCRIPT error
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'LOAD', Any<String> ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m257:38[22m[39m
    [90m255| [39m
    [90m256| [39m      [34mexpect[39m(result[33m.[39mallowed)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m257| [39m      expect(mockRedisClient.script).toHaveBeenCalledWith('LOAD', expeâ€¦
    [90m   | [39m                                     [31m^[39m
    [90m258| [39m    })[33m;[39m
    [90m259| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[165/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mResponse Headers[2m > [22mshould include reset time in response
[31m[1mAssertionError[22m: expected 1770299992915 to be 1770299977915 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1770299977915[39m
[31m+ 1770299992915[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m283:28[22m[39m
    [90m281| [39m      [35mconst[39m result [33m=[39m [35mawait[39m limiter[33m.[39m[34mcheckLimit[39m(userId[33m,[39m [34m60[39m[33m,[39m [34m60[39m)[33m;[39m
    [90m282| [39m
    [90m283| [39m      [34mexpect[39m(result[33m.[39mreset)[33m.[39m[34mtoBe[39m(resetTime)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m284| [39m    })[33m;[39m
    [90m285| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[166/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mResponse Headers[2m > [22mshould include retry-after for denied requests
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m292:33[22m[39m
    [90m290| [39m      [35mconst[39m result [33m=[39m [35mawait[39m limiter[33m.[39m[34mcheckLimit[39m(userId[33m,[39m [34m60[39m[33m,[39m [34m60[39m)[33m;[39m
    [90m291| [39m
    [90m292| [39m      [34mexpect[39m(result[33m.[39mretryAfter)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m293| [39m      [34mexpect[39m(result[33m.[39mretryAfter)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m294| [39m      [34mexpect[39m(result[33m.[39mretryAfter)[33m.[39m[34mtoBeLessThanOrEqual[39m([34m60[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[167/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConnection Lifecycle[2m > [22mshould close Redis connection
[31m[1mTypeError[22m: limiter.close is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m308:21[22m[39m
    [90m306| [39m  [34mdescribe[39m([32m'Connection Lifecycle'[39m[33m,[39m () [33m=>[39m {
    [90m307| [39m    [34mit[39m([32m'should close Redis connection'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m308| [39m      [35mawait[39m limiter[33m.[39m[34mclose[39m()[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m309| [39m
    [90m310| [39m      [34mexpect[39m(mockRedisClient[33m.[39mquit)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[168/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mConnection Lifecycle[2m > [22mshould handle close errors gracefully
[31m[1mTypeError[22m: limiter.close is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m316:28[22m[39m
    [90m314| [39m      mockRedisClient.quit.mockRejectedValue(new Error('Close failed')â€¦
    [90m315| [39m
    [90m316| [39m      [35mawait[39m [34mexpect[39m(limiter[33m.[39m[34mclose[39m())[33m.[39mresolves[33m.[39mnot[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m317| [39m    })[33m;[39m
    [90m318| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[169/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mSingleton Pattern[2m > [22mshould allow custom config on first initialization
[31m[1mTypeError[22m: customLimiter.close is not a function[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m334:21[22m[39m
    [90m332| [39m
    [90m333| [39m      [34mexpect[39m(customLimiter)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m334| [39m      customLimiter[33m.[39m[34mclose[39m()[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m335| [39m    })[33m;[39m
    [90m336| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[170/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mIntegration Scenarios[2m > [22mshould support API rate limiting workflow
[31m[1mAssertionError[22m: expected 60 to be 99 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 99[39m
[31m+ 60[39m

[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m372:31[22m[39m
    [90m370| [39m      mockRedisClient[33m.[39m[35mget[39m[33m.[39m[34mmockResolvedValue[39m([32m'99'[39m)[33m;[39m
    [90m371| [39m      [35mconst[39m quota [33m=[39m [35mawait[39m limiter[33m.[39m[34mgetQuota[39m(userId)[33m;[39m
    [90m372| [39m      [34mexpect[39m(quota[33m.[39mremaining)[33m.[39m[34mtoBe[39m([34m99[39m)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m373| [39m
    [90m374| [39m      [90m// Subsequent request[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[171/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/rate-limiting/redis-rate-limiter.test.ts[2m > [22mRedisRateLimiter[2m > [22mIntegration Scenarios[2m > [22mshould support per-operation rate limiting
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 3 times, but got 0 times[39m
[36m [2mâ¯[22m src/services/rate-limiting/redis-rate-limiter.test.ts:[2m397:39[22m[39m
    [90m395| [39m      }
    [90m396| [39m
    [90m397| [39m      [34mexpect[39m(mockRedisClient[33m.[39mevalsha)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m3[39m)[33m;[39m
    [90m   | [39m                                      [31m^[39m
    [90m398| [39m    })[33m;[39m
    [90m399| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[172/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/cron-scheduler.test.ts[2m > [22mCronScheduler[2m > [22mNext Execution Calculation[2m > [22mshould calculate next execution for daily schedule
[31m[1mAssertionError[22m: expected null not to be null[39m
[36m [2mâ¯[22m src/services/scheduling/cron-scheduler.test.ts:[2m82:28[22m[39m
    [90m 80| [39m
    [90m 81| [39m      [90m// Should be today at 18:00[39m
    [90m 82| [39m      [34mexpect[39m(nextExec)[33m.[39mnot[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 83| [39m      [35mif[39m (nextExec) {
    [90m 84| [39m        [34mexpect[39m(nextExec[33m.[39m[34mgetUTCHours[39m())[33m.[39m[34mtoBe[39m([34m18[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[173/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/cron-scheduler.test.ts[2m > [22mCronScheduler[2m > [22mNext Execution Calculation[2m > [22mshould schedule for next day if time passed
[31m[1mAssertionError[22m: expected null not to be null[39m
[36m [2mâ¯[22m src/services/scheduling/cron-scheduler.test.ts:[2m106:28[22m[39m
    [90m104| [39m
    [90m105| [39m      [90m// Should be tomorrow at 9am[39m
    [90m106| [39m      [34mexpect[39m(nextExec)[33m.[39mnot[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m107| [39m      [35mif[39m (nextExec) {
    [90m108| [39m        [34mexpect[39m(nextExec[33m.[39m[34mgetUTCHours[39m())[33m.[39m[34mtoBe[39m([34m9[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[174/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/cron-scheduler.test.ts[2m > [22mCronScheduler[2m > [22mNext Execution Calculation[2m > [22mshould handle minute-based schedules
[31m[1mAssertionError[22m: expected null not to be null[39m
[36m [2mâ¯[22m src/services/scheduling/cron-scheduler.test.ts:[2m129:28[22m[39m
    [90m127| [39m
    [90m128| [39m      [90m// Should be in ~3 minutes[39m
    [90m129| [39m      [34mexpect[39m(nextExec)[33m.[39mnot[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m130| [39m    })[33m;[39m
    [90m131| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[175/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/pg-cron-manager.test.ts[2m > [22mPgCronManager[2m > [22mSchedule Registration[2m > [22mshould register a cron schedule
[31m[1mError[22m: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("cron-parser"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m PgCronManager.scheduleOperation src/services/scheduling/pg-cron-manager.ts:[2m47:27[22m[39m
    [90m 45| [39m    [35mtry[39m {
    [90m 46| [39m      [90m// Validate cron expression[39m
    [90m 47| [39m      const cronParser = (parseExpression as any)(schedule.cron_expresâ€¦
    [90m   | [39m                          [31m^[39m
    [90m 48| [39m        tz[33m:[39m schedule[33m.[39mtimezone[33m,[39m
    [90m 49| [39m      })[33m;[39m
[90m [2mâ¯[22m src/services/scheduling/pg-cron-manager.test.ts:[2m105:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[176/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/pg-cron-manager.test.ts[2m > [22mPgCronManager[2m > [22mSchedule Registration[2m > [22mshould validate cron expression
[31m[1mError[22m: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("cron-parser"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m PgCronManager.scheduleOperation src/services/scheduling/pg-cron-manager.ts:[2m47:27[22m[39m
    [90m 45| [39m    [35mtry[39m {
    [90m 46| [39m      [90m// Validate cron expression[39m
    [90m 47| [39m      const cronParser = (parseExpression as any)(schedule.cron_expresâ€¦
    [90m   | [39m                          [31m^[39m
    [90m 48| [39m        tz[33m:[39m schedule[33m.[39mtimezone[33m,[39m
    [90m 49| [39m      })[33m;[39m
[90m [2mâ¯[22m src/services/scheduling/pg-cron-manager.test.ts:[2m122:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[177/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/pg-cron-manager.test.ts[2m > [22mPgCronManager[2m > [22mSchedule Updates[2m > [22mshould update schedule with new cron expression
[31m[1mError[22m: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("cron-parser"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m PgCronManager.scheduleOperation src/services/scheduling/pg-cron-manager.ts:[2m47:27[22m[39m
    [90m 45| [39m    [35mtry[39m {
    [90m 46| [39m      [90m// Validate cron expression[39m
    [90m 47| [39m      const cronParser = (parseExpression as any)(schedule.cron_expresâ€¦
    [90m   | [39m                          [31m^[39m
    [90m 48| [39m        tz[33m:[39m schedule[33m.[39mtimezone[33m,[39m
    [90m 49| [39m      })[33m;[39m
[90m [2mâ¯[22m PgCronManager.updateSchedule src/services/scheduling/pg-cron-manager.ts:[2m116:16[22m[39m
[90m [2mâ¯[22m src/services/scheduling/pg-cron-manager.test.ts:[2m174:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[178/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/pg-cron-manager.test.ts[2m > [22mPgCronManager[2m > [22mSchedule Enable/Disable[2m > [22mshould disable schedule
[31m[1mError[22m: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("cron-parser"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m PgCronManager.scheduleOperation src/services/scheduling/pg-cron-manager.ts:[2m47:27[22m[39m
    [90m 45| [39m    [35mtry[39m {
    [90m 46| [39m      [90m// Validate cron expression[39m
    [90m 47| [39m      const cronParser = (parseExpression as any)(schedule.cron_expresâ€¦
    [90m   | [39m                          [31m^[39m
    [90m 48| [39m        tz[33m:[39m schedule[33m.[39mtimezone[33m,[39m
    [90m 49| [39m      })[33m;[39m
[90m [2mâ¯[22m src/services/scheduling/pg-cron-manager.test.ts:[2m199:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[179/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/pg-cron-manager.test.ts[2m > [22mPgCronManager[2m > [22mSchedule Enable/Disable[2m > [22mshould enable disabled schedule
[31m[1mError[22m: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("cron-parser"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m PgCronManager.scheduleOperation src/services/scheduling/pg-cron-manager.ts:[2m47:27[22m[39m
    [90m 45| [39m    [35mtry[39m {
    [90m 46| [39m      [90m// Validate cron expression[39m
    [90m 47| [39m      const cronParser = (parseExpression as any)(schedule.cron_expresâ€¦
    [90m   | [39m                          [31m^[39m
    [90m 48| [39m        tz[33m:[39m schedule[33m.[39mtimezone[33m,[39m
    [90m 49| [39m      })[33m;[39m
[90m [2mâ¯[22m PgCronManager.enableSchedule src/services/scheduling/pg-cron-manager.ts:[2m190:16[22m[39m
[90m [2mâ¯[22m src/services/scheduling/pg-cron-manager.test.ts:[2m217:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[180/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/pg-cron-manager.test.ts[2m > [22mPgCronManager[2m > [22mTimezone Handling[2m > [22mshould handle various timezones
[31m[1mError[22m: [vitest] No "default" export is defined on the "cron-parser" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
[39m
vi.mock(import("cron-parser"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

[36m [2mâ¯[22m PgCronManager.scheduleOperation src/services/scheduling/pg-cron-manager.ts:[2m47:27[22m[39m
    [90m 45| [39m    [35mtry[39m {
    [90m 46| [39m      [90m// Validate cron expression[39m
    [90m 47| [39m      const cronParser = (parseExpression as any)(schedule.cron_expresâ€¦
    [90m   | [39m                          [31m^[39m
    [90m 48| [39m        tz[33m:[39m schedule[33m.[39mtimezone[33m,[39m
    [90m 49| [39m      })[33m;[39m
[90m [2mâ¯[22m src/services/scheduling/pg-cron-manager.test.ts:[2m263:23[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[181/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/schedule-manager.test.ts[2m > [22mScheduleManager[2m > [22mWebhook Handling[2m > [22mshould return 202 Accepted immediately
[31m[1mTypeError[22m: db.from is not a function[39m
[36m [2mâ¯[22m ScheduleManager.handleWebhook src/services/scheduling/schedule-manager.ts:[2m317:16[22m[39m
    [90m315| [39m    } [35mcatch[39m (error) {
    [90m316| [39m      [90m// Log webhook error[39m
    [90m317| [39m      [35mawait[39m db[33m.[39m[35mfrom[39m([32m'webhook_events'[39m)[33m.[39m[34minsert[39m({
    [90m   | [39m               [31m^[39m
    [90m318| [39m        schedule_id[33m:[39m scheduleId[33m,[39m
    [90m319| [39m        event_type[33m:[39m [32m'webhook_error'[39m[33m,[39m
[90m [2mâ¯[22m src/services/scheduling/schedule-manager.test.ts:[2m239:36[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[182/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/scheduling/schedule-manager.test.ts[2m > [22mScheduleManager[2m > [22mWebhook Handling[2m > [22mshould execute webhook async without blocking
[31m[1mTypeError[22m: db.from is not a function[39m
[36m [2mâ¯[22m ScheduleManager.handleWebhook src/services/scheduling/schedule-manager.ts:[2m317:16[22m[39m
    [90m315| [39m    } [35mcatch[39m (error) {
    [90m316| [39m      [90m// Log webhook error[39m
    [90m317| [39m      [35mawait[39m db[33m.[39m[35mfrom[39m([32m'webhook_events'[39m)[33m.[39m[34minsert[39m({
    [90m   | [39m               [31m^[39m
    [90m318| [39m        schedule_id[33m:[39m scheduleId[33m,[39m
    [90m319| [39m        event_type[33m:[39m [32m'webhook_error'[39m[33m,[39m
[90m [2mâ¯[22m src/services/scheduling/schedule-manager.test.ts:[2m252:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[183/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mOverall Status Calculation[2m > [22mshould return operational when all components are operational
[31m[1mAssertionError[22m: expected 'degraded' to be 'operational' // Object.is equality[39m

Expected: [32m"operational"[39m
Received: [31m"degraded"[39m

[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m89:30[22m[39m
    [90m 87| [39m      [35mconst[39m status [33m=[39m [35mawait[39m service[33m.[39m[34mgetStatus[39m()[33m;[39m
    [90m 88| [39m
    [90m 89| [39m      [34mexpect[39m(status[33m.[39moverall)[33m.[39m[34mtoBe[39m([32m'operational'[39m)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m 90| [39m    })[33m;[39m
    [90m 91| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[184/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus Caching[2m > [22mshould cache status
[31m[1mAssertionError[22m: expected { overall: 'degraded', â€¦(4) } to deeply equal { overall: 'degraded', â€¦(4) }[39m

[32m- Expected[39m
[31m+ Received[39m

[2m  {[22m
[2m    "components": {[22m
[2m      "api_gateway": {[22m
[32m-       "lastChecked": "2026-02-05T13:58:55.351Z",[39m
[31m+       "lastChecked": "2026-02-05T13:58:55.350Z",[39m
[2m        "latency": 1,[22m
[2m        "status": "operational",[22m
[2m      },[22m
[2m      "background_jobs": {[22m
[32m-       "lastChecked": "2026-02-05T13:58:55.351Z",[39m
[31m+       "lastChecked": "2026-02-05T13:58:55.349Z",[39m
[2m        "status": "degraded",[22m
[2m      },[22m
[2m      "database": {[22m
[32m-       "lastChecked": "2026-02-05T13:58:55.351Z",[39m
[31m+       "lastChecked": "2026-02-05T13:58:55.350Z",[39m
[2m        "latency": 1,[22m
[2m        "status": "operational",[22m
[2m      },[22m
[2m      "webhooks": {[22m
[32m-       "lastChecked": "2026-02-05T13:58:55.350Z",[39m
[31m+       "lastChecked": "2026-02-05T13:58:55.349Z",[39m
[2m        "status": "degraded",[22m
[2m      },[22m
[2m    },[22m
[2m    "incidents": [],[22m
[32m-   "lastUpdated": "2026-02-05T13:58:55.351Z",[39m
[31m+   "lastUpdated": "2026-02-05T13:58:55.350Z",[39m
[2m    "overall": "degraded",[22m
[2m    "uptime_90d": 99.99,[22m
[2m  }[22m

[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m150:23[22m[39m
    [90m148| [39m      [35mconst[39m status2 [33m=[39m [35mawait[39m service[33m.[39m[34mgetStatus[39m()[33m;[39m
    [90m149| [39m
    [90m150| [39m      [34mexpect[39m(status1)[33m.[39m[34mtoEqual[39m(status2)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m151| [39m    })[33m;[39m
    [90m152| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[185/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mMonthly Uptime[2m > [22mshould return 30-day uptime breakdown
[31m[1mTypeError[22m: service.getMonthlyUptime is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m202:37[22m[39m
    [90m200| [39m  [34mdescribe[39m([32m'Monthly Uptime'[39m[33m,[39m () [33m=>[39m {
    [90m201| [39m    [34mit[39m([32m'should return 30-day uptime breakdown'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m202| [39m      [35mconst[39m monthly [33m=[39m [35mawait[39m service[33m.[39m[34mgetMonthlyUptime[39m()[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m203| [39m
    [90m204| [39m      [34mexpect[39m(monthly[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m30[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[186/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mMonthly Uptime[2m > [22mshould have uptime in valid range
[31m[1mTypeError[22m: service.getMonthlyUptime is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m211:37[22m[39m
    [90m209| [39m
    [90m210| [39m    [34mit[39m([32m'should have uptime in valid range'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m211| [39m      [35mconst[39m monthly [33m=[39m [35mawait[39m service[33m.[39m[34mgetMonthlyUptime[39m()[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m212| [39m
    [90m213| [39m      [35mfor[39m ([35mconst[39m day [35mof[39m monthly) {

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[187/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mMonthly Uptime[2m > [22mshould have incident counts
[31m[1mTypeError[22m: service.getMonthlyUptime is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m220:37[22m[39m
    [90m218| [39m
    [90m219| [39m    [34mit[39m([32m'should have incident counts'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m220| [39m      [35mconst[39m monthly [33m=[39m [35mawait[39m service[33m.[39m[34mgetMonthlyUptime[39m()[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m221| [39m
    [90m222| [39m      [35mfor[39m ([35mconst[39m day [35mof[39m monthly) {

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[188/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus Subscriptions[2m > [22mshould return unsubscribe function
[31m[1mTypeError[22m: service.subscribeToUpdates is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m238:35[22m[39m
    [90m236| [39m      (global[33m.[39mfetch [35mas[39m any)[33m.[39m[34mmockResolvedValue[39m(mockResponse)[33m;[39m
    [90m237| [39m
    [90m238| [39m      [35mconst[39m unsubscribe [33m=[39m service[33m.[39m[34msubscribeToUpdates[39m(callback)[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m239| [39m
    [90m240| [39m      [34mexpect[39m([35mtypeof[39m unsubscribe)[33m.[39m[34mtoBe[39m([32m'function'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[189/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus History[2m > [22mshould return status history for specified days
[31m[1mTypeError[22m: service.getStatusHistory is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m247:37[22m[39m
    [90m245| [39m  [34mdescribe[39m([32m'Status History'[39m[33m,[39m () [33m=>[39m {
    [90m246| [39m    [34mit[39m([32m'should return status history for specified days'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m247| [39m      [35mconst[39m history [33m=[39m [35mawait[39m service[33m.[39m[34mgetStatusHistory[39m([34m30[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m248| [39m
    [90m249| [39m      [34mexpect[39m(history[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m30[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[190/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus History[2m > [22mshould return valid status values
[31m[1mTypeError[22m: service.getStatusHistory is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m255:37[22m[39m
    [90m253| [39m
    [90m254| [39m    [34mit[39m([32m'should return valid status values'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m255| [39m      [35mconst[39m history [33m=[39m [35mawait[39m service[33m.[39m[34mgetStatusHistory[39m([34m30[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m256| [39m
    [90m257| [39m      [35mfor[39m ([35mconst[39m entry [35mof[39m history) {

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[191/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus History[2m > [22mshould default to 90 days
[31m[1mTypeError[22m: service.getStatusHistory is not a function[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m263:37[22m[39m
    [90m261| [39m
    [90m262| [39m    [34mit[39m([32m'should default to 90 days'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m263| [39m      [35mconst[39m history [33m=[39m [35mawait[39m service[33m.[39m[34mgetStatusHistory[39m()[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m264| [39m
    [90m265| [39m      [34mexpect[39m(history[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m90[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[192/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mComponent Status Properties[2m > [22mshould include last check timestamp
[31m[1mAssertionError[22m: expected 'string' to be 'number' // Object.is equality[39m

Expected: [32m"number"[39m
Received: [31m"string"[39m

[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m280:64[22m[39m
    [90m278| [39m
    [90m279| [39m      [34mexpect[39m(status[33m.[39mcomponents[33m.[39mapi_gateway[33m.[39mlastChecked)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m280| [39m      expect(typeof status.components.api_gateway.lastChecked).toBe('nâ€¦
    [90m   | [39m                                                               [31m^[39m
    [90m281| [39m    })[33m;[39m
    [90m282| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[193/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mComponent Status Properties[2m > [22mshould include latency for all components
[31m[1mAssertionError[22m: expected 'undefined' to be 'number' // Object.is equality[39m

Expected: [32m"number"[39m
Received: [31m"undefined"[39m

[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m294:42[22m[39m
    [90m292| [39m      [90m// All components should have latency[39m
    [90m293| [39m      [35mfor[39m ([35mconst[39m component [35mof[39m [33mObject[39m[33m.[39m[34mvalues[39m(status[33m.[39mcomponents)) {
    [90m294| [39m        [34mexpect[39m([35mtypeof[39m component[33m.[39mlatency)[33m.[39m[34mtoBe[39m([32m'number'[39m)[33m;[39m
    [90m   | [39m                                         [31m^[39m
    [90m295| [39m      }
    [90m296| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[194/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus Response Structure[2m > [22mshould include required fields
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m314:36[22m[39m
    [90m312| [39m      [34mexpect[39m(status[33m.[39muptime_90d)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m313| [39m      [34mexpect[39m(status[33m.[39mincidents)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m314| [39m      [34mexpect[39m(status[33m.[39mstatusPageUrl)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m315| [39m    })[33m;[39m
    [90m316| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[195/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/status/status-service.test.ts[2m > [22mStatusService[2m > [22mStatus Response Structure[2m > [22mshould have all component checks
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/status/status-service.test.ts:[2m330:47[22m[39m
    [90m328| [39m      [34mexpect[39m(status[33m.[39mcomponents[33m.[39mwebhooks)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m329| [39m      [34mexpect[39m(status[33m.[39mcomponents[33m.[39mbackground_jobs)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m330| [39m      [34mexpect[39m(status[33m.[39mcomponents[33m.[39mrate_limiting)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                              [31m^[39m
    [90m331| [39m    })[33m;[39m
    [90m332| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[196/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/tenant/invite-service.test.ts[2m > [22mTenantInviteService[2m > [22minviteUser[2m > [22mshould reject if user is already a member
[31m[1mAssertionError[22m: promise resolved "{ id: 'mem-123', â€¦(7) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "createdAt": Date { NaN },[39m
[31m+   "email": undefined,[39m
[31m+   "expiresAt": Date { NaN },[39m
[31m+   "id": "mem-123",[39m
[31m+   "role": undefined,[39m
[31m+   "status": undefined,[39m
[31m+   "tenantId": undefined,[39m
[31m+   "token": undefined,[39m
[2m  }[22m

[36m [2mâ¯[22m src/services/tenant/invite-service.test.ts:[2m184:7[22m[39m
    [90m182| [39m      [35mawait[39m [34mexpect[39m(
    [90m183| [39m        service[33m.[39m[34minviteUser[39m(tenantId[33m,[39m email)
    [90m184| [39m      ).rejects.toThrow(`User ${email} is already a member of this tenâ€¦
    [90m   | [39m      [31m^[39m
    [90m185| [39m    })[33m;[39m
    [90m186| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[197/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/tenant/invite-service.test.ts[2m > [22mTenantInviteService[2m > [22macceptInvitation[2m > [22mshould successfully accept valid pending invitation
[31m[1mAssertionError[22m: promise rejected "Error: User not found" instead of resolving[39m
[36m [2mâ¯[22m src/services/tenant/invite-service.test.ts:[2m330:59[22m[39m
    [90m328| [39m      mockQuery.single.mockResolvedValueOnce({ data: { updated: 1 }, eâ€¦
    [90m329| [39m
    [90m330| [39m      await expect(service.acceptInvitation(token, userId)).resolves.nâ€¦
    [90m   | [39m                                                          [31m^[39m
    [90m331| [39m
    [90m332| [39m      expect(hashChainModule.getHashChainForTenant).toHaveBeenCalledWiâ€¦

[31m[1mCaused by: Error[22m: User not found[39m
[36m [2mâ¯[22m TenantInviteService.acceptInvitation src/services/tenant/invite-service.ts:[2m155:15[22m[39m
[90m [2mâ¯[22m src/services/tenant/invite-service.test.ts:[2m330:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[198/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/tenant/invite-service.test.ts[2m > [22mTenantInviteService[2m > [22macceptInvitation[2m > [22mshould preserve role from invitation
[31m[1mError[22m: User not found[39m
[36m [2mâ¯[22m TenantInviteService.acceptInvitation src/services/tenant/invite-service.ts:[2m155:15[22m[39m
    [90m153| [39m
    [90m154| [39m      [35mif[39m (userError [33m||[39m [33m![39mdata[33m?.[39muser) {
    [90m155| [39m        [35mthrow[39m [35mnew[39m [33mError[39m([32m'User not found'[39m)[33m;[39m
    [90m   | [39m              [31m^[39m
    [90m156| [39m      }
    [90m157| [39m
[90m [2mâ¯[22m src/services/tenant/invite-service.test.ts:[2m461:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[199/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/utils/__tests__/pwa-setup.test.ts[2m > [22mPWA Setup[2m > [22mService Worker Registration[2m > [22mshould register service worker successfully
[31m[1mAssertionError[22m: expected { registration: { â€¦(4) }, â€¦(1) } to be { Object (installing, active, ...) } // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[2m  {[22m
[31m+   "cleanup": [Function cleanup],[39m
[31m+   "registration": {[39m
[2m      "active": null,[22m
[2m      "addEventListener": [Function Mock],[22m
[2m      "installing": null,[22m
[2m      "scope": "/",[22m
[31m+   },[39m
[2m  }[22m

[36m [2mâ¯[22m src/utils/__tests__/pwa-setup.test.ts:[2m70:22[22m[39m
    [90m 68| [39m        { scope[33m:[39m [32m'/'[39m }
    [90m 69| [39m      )[33m;[39m
    [90m 70| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBe[39m(mockRegistration)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 71| [39m    })[33m;[39m
    [90m 72| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[200/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/utils/__tests__/pwa-setup.test.ts[2m > [22mPWA Setup[2m > [22mService Worker Registration[2m > [22mshould handle service worker registration failure
[31m[1mAssertionError[22m: expected { registration: null, â€¦(1) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "cleanup": [Function cleanup],
  "registration": null,
}

[36m [2mâ¯[22m src/utils/__tests__/pwa-setup.test.ts:[2m79:22[22m[39m
    [90m 77| [39m      [35mconst[39m result [33m=[39m [35mawait[39m [34msetupPWA[39m()[33m;[39m
    [90m 78| [39m
    [90m 79| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 80| [39m    })[33m;[39m
    [90m 81| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[201/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/utils/__tests__/pwa-setup.test.ts[2m > [22mPWA Setup[2m > [22mService Worker Registration[2m > [22mshould return null if service workers not supported
[31m[1mAssertionError[22m: expected { registration: null, â€¦(1) } to be null[39m

[32m- Expected:[39m 
null

[31m+ Received:[39m 
{
  "cleanup": [Function cleanup],
  "registration": null,
}

[36m [2mâ¯[22m src/utils/__tests__/pwa-setup.test.ts:[2m90:22[22m[39m
    [90m 88| [39m      [35mconst[39m result [33m=[39m [35mawait[39m [34msetupPWA[39m()[33m;[39m
    [90m 89| [39m
    [90m 90| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 91| [39m    })[33m;[39m
    [90m 92| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[202/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/e2e-memory-flow.test.ts[2m > [22mEnd-to-End Memory Flow[2m > [22mSingle Conversation Processing[2m > [22mshould capture a full conversation end-to-end
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m55:24[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m55:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[203/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/e2e-memory-flow.test.ts[2m > [22mEnd-to-End Memory Flow[2m > [22mSingle Conversation Processing[2m > [22mshould handle multiple distinct conversations
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m177:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m177:47[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[204/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/e2e-memory-flow.test.ts[2m > [22mEnd-to-End Memory Flow[2m > [22mSemantic Search Accuracy[2m > [22mshould find semantically similar conversations
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m259:24[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m259:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[205/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/e2e-memory-flow.test.ts[2m > [22mEnd-to-End Memory Flow[2m > [22mEmotion Analysis Quality[2m > [22mshould detect distinct emotions correctly
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m347:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m347:47[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[206/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/e2e-memory-flow.test.ts[2m > [22mEnd-to-End Memory Flow[2m > [22mPerformance Benchmarks[2m > [22mshould complete memory capture pipeline in reasonable time
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m389:24[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/e2e-memory-flow.test.ts:[2m389:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[207/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mDraft Management[2m > [22mshould save draft with partial updates (upsert)
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m19:35[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[208/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mDraft Management[2m > [22mshould get draft by ID
[31m[1mAssertionError[22m: expected 'test-id' to be 'draft-1' // Object.is equality[39m

Expected: [32m"draft-1"[39m
Received: [31m"test-id"[39m

[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m35:24[22m[39m
    [90m 33| [39m      [35mconst[39m draft [33m=[39m [35mawait[39m service[33m.[39m[34mgetDraft[39m([32m'draft-1'[39m)[33m;[39m
    [90m 34| [39m      [34mexpect[39m(draft)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 35| [39m      [34mexpect[39m(draft[33m.[39mid)[33m.[39m[34mtoBe[39m([32m'draft-1'[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m 36| [39m    })[33m;[39m
    [90m 37| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[209/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mTemplate Management[2m > [22mshould create template
[31m[1mAssertionError[22m: expected undefined to be 'Professional Response' // Object.is equality[39m

[32m- Expected:[39m 
"Professional Response"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m62:29[22m[39m
    [90m 60| [39m      })[33m;[39m
    [90m 61| [39m
    [90m 62| [39m      [34mexpect[39m(template[33m.[39mname)[33m.[39m[34mtoBe[39m([32m'Professional Response'[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m 63| [39m      [34mexpect[39m(template[33m.[39musage_count)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m 64| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[210/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mTemplate Management[2m > [22mshould apply template to draft
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m EmailComposeService.applyTemplate src/services/email-compose.ts:[2m298:31[22m[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m67:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[211/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mTemplate Management[2m > [22mshould track template usage
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m EmailComposeService.applyTemplate src/services/email-compose.ts:[2m298:31[22m[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m77:7[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[212/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mSignature Management[2m > [22mshould get default signature
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m92:31[22m[39m
    [90m 90| [39m      [35mconst[39m sig [33m=[39m [35mawait[39m service[33m.[39m[34mgetDefaultSignature[39m([32m'account-123'[39m)[33m;[39m
    [90m 91| [39m      [34mexpect[39m(sig)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 92| [39m      [34mexpect[39m(sig[33m?.[39mis_default)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m 93| [39m    })[33m;[39m
    [90m 94| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[213/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mSignature Management[2m > [22mshould create signature
[31m[1mAssertionError[22m: expected undefined to be 'Work Signature' // Object.is equality[39m

[32m- Expected:[39m 
"Work Signature"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m102:24[22m[39m
    [90m100| [39m      })[33m;[39m
    [90m101| [39m
    [90m102| [39m      [34mexpect[39m(sig[33m.[39mname)[33m.[39m[34mtoBe[39m([32m'Work Signature'[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m103| [39m    })[33m;[39m
    [90m104| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[214/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mSignature Management[2m > [22mshould insert signature into draft
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m EmailComposeService.insertSignature src/services/email-compose.ts:[2m430:32[22m[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m106:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[215/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mValidation[2m > [22mshould validate email format
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m121:28[22m[39m
    [90m119| [39m        to[33m:[39m [[32m'valid@example.com'[39m][33m,[39m
    [90m120| [39m      })[33m;[39m
    [90m121| [39m      [34mexpect[39m(result[33m.[39mvalid)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m122| [39m    })[33m;[39m
    [90m123| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[216/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mValidation[2m > [22mshould validate required fields
[31m[1mAssertionError[22m: expected [ â€¦(3) ] to include StringContaining "subject"[39m
[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m139:29[22m[39m
    [90m137| [39m      })[33m;[39m
    [90m138| [39m      [34mexpect[39m(result[33m.[39mvalid)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m139| [39m      expect(result.errors).toContain(expect.stringContaining('subjectâ€¦
    [90m   | [39m                            [31m^[39m
    [90m140| [39m    })[33m;[39m
    [90m141| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[217/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mValidation[2m > [22mshould allow multiple recipients
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m154:28[22m[39m
    [90m152| [39m        to[33m:[39m [[32m'user1@example.com'[39m[33m,[39m [32m'user2@example.com'[39m][33m,[39m
    [90m153| [39m      })[33m;[39m
    [90m154| [39m      [34mexpect[39m(result[33m.[39mvalid)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m155| [39m    })[33m;[39m
    [90m156| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[218/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mScheduled Send[2m > [22mshould schedule send with future time
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m EmailComposeService.scheduleSend src/services/email-compose.ts:[2m489:32[22m[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m161:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[219/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mScheduled Send[2m > [22mshould cancel scheduled send
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m EmailComposeService.cancelScheduledSend src/services/email-compose.ts:[2m502:32[22m[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m171:21[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[220/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mScheduled Send[2m > [22mshould handle timezone
[31m[1mError[22m: Scheduled time must be in the future[39m
[36m [2mâ¯[22m EmailComposeService.scheduleSend src/services/email-compose.ts:[2m484:13[22m[39m
    [90m482| [39m    [90m// Validate send time is in future[39m
    [90m483| [39m    [35mif[39m (sendTime [33m<=[39m [35mnew[39m [33mDate[39m()) {
    [90m484| [39m      [35mthrow[39m [35mnew[39m [33mError[39m([32m'Scheduled time must be in the future'[39m)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m485| [39m    }
    [90m486| [39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m177:35[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[221/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mAuto-Save Integration[2m > [22mshould support partial draft updates
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m184:36[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[222/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-compose.test.ts[2m > [22mEmailComposeService[2m > [22mAuto-Save Integration[2m > [22mshould not lose data on rapid saves
[31m[1mTypeError[22m: supabase.from(...).upsert is not a function[39m
[36m [2mâ¯[22m EmailComposeService.saveDraft src/services/email-compose.ts:[2m147:8[22m[39m
    [90m145| [39m    [35mconst[39m { data[33m,[39m error } [33m=[39m [35mawait[39m (supabase [35mas[39m any)
    [90m146| [39m      [33m.[39m[35mfrom[39m([32m'email_drafts'[39m)
    [90m147| [39m      [33m.[39m[34mupsert[39m(payload[33m,[39m { onConflict[33m:[39m [32m'id'[39m })
    [90m   | [39m       [31m^[39m
    [90m148| [39m      [33m.[39m[34mselect[39m()
    [90m149| [39m      [33m.[39m[34msingle[39m()[33m;[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m202:17[22m[39m
[90m [2mâ¯[22m src/services/__tests__/email-compose.test.ts:[2m201:47[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[223/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mComplete Workflow[2m > [22mexecutes emailâ†’ruleâ†’task workflow
[31m[1mAssertionError[22m: expected undefined to be 'email_received' // Object.is equality[39m

[32m- Expected:[39m 
"email_received"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m68:32[22m[39m
    [90m 66| [39m
    [90m 67| [39m      [34mexpect[39m(rule[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 68| [39m      [34mexpect[39m(rule[33m.[39mtriggerType)[33m.[39m[34mtoBe[39m([32m'email_received'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m 69| [39m
    [90m 70| [39m      [90m// 2. Simulate email arrival[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[224/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mComplete Workflow[2m > [22mmatches multiple email conditions
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'type')[39m
[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m94:29[22m[39m
    [90m 92| [39m      })[33m;[39m
    [90m 93| [39m
    [90m 94| [39m      [34mexpect[39m(rule[33m.[39mcondition[33m.[39mtype)[33m.[39m[34mtoBe[39m([32m'email'[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m 95| [39m
    [90m 96| [39m      [35mconst[39m mockEmail [33m=[39m [34mcreateMockEmail[39m({

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[225/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mComplete Workflow[2m > [22mskips email if conditions not met
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m119:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[226/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mTemplate Variable Substitution[2m > [22msubstitutes emailSubject variable
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m138:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[227/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mTemplate Variable Substitution[2m > [22msubstitutes emailFrom variable
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m154:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[228/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mTask Priority Mapping[2m > [22mcreates task with high priority
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '0')[39m
[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m169:19[22m[39m
    [90m167| [39m      })[33m;[39m
    [90m168| [39m
    [90m169| [39m      [34mexpect[39m(rule[33m.[39mactions[[34m0[39m][33m?.[39mactionConfig[33m.[39mpriority)[33m.[39m[34mtoBe[39m([32m'high'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m170| [39m    })[33m;[39m
    [90m171| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[229/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mTask Priority Mapping[2m > [22mcreates task with normal priority
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '0')[39m
[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m181:19[22m[39m
    [90m179| [39m      })[33m;[39m
    [90m180| [39m
    [90m181| [39m      [34mexpect[39m(rule[33m.[39mactions[[34m0[39m][33m?.[39mactionConfig[33m.[39mpriority)[33m.[39m[34mtoBe[39m([32m'normal'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m182| [39m    })[33m;[39m
    [90m183| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[230/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mTask Priority Mapping[2m > [22mcreates task with low priority
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '0')[39m
[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m193:19[22m[39m
    [90m191| [39m      })[33m;[39m
    [90m192| [39m
    [90m193| [39m      [34mexpect[39m(rule[33m.[39mactions[[34m0[39m][33m?.[39mactionConfig[33m.[39mpriority)[33m.[39m[34mtoBe[39m([32m'low'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m194| [39m    })[33m;[39m
    [90m195| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[231/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mDiscord Logging[2m > [22mlogs email trigger execution to Discord
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m213:33[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[232/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mHash Chain Integrity[2m > [22mrecords execution in hash chain
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m221:33[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[233/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mMulti-Rule Handling[2m > [22mexecutes first matching rule
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m249:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[234/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mPerformance[2m > [22mprocesses email within timeout
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m131:10[22m[39m
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m   | [39m         [31m^[39m
    [90m132| [39m
    [90m133| [39m      [35mif[39m (loadError) {
[90m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m285:33[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[235/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mType Safety[2m > [22menforces email trigger type
[31m[1mAssertionError[22m: expected undefined to be 'email_received' // Object.is equality[39m

[32m- Expected:[39m 
"email_received"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m338:32[22m[39m
    [90m336| [39m      })[33m;[39m
    [90m337| [39m
    [90m338| [39m      [34mexpect[39m(rule[33m.[39mtriggerType)[33m.[39m[34mtoBe[39m([32m'email_received'[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m339| [39m    })[33m;[39m
    [90m340| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[236/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/email-to-task.integration.test.ts[2m > [22mEmail-to-Task Integration[2m > [22mType Safety[2m > [22menforces create_task action type
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '0')[39m
[36m [2mâ¯[22m src/services/__tests__/email-to-task.integration.test.ts:[2m347:19[22m[39m
    [90m345| [39m      })[33m;[39m
    [90m346| [39m
    [90m347| [39m      [34mexpect[39m(rule[33m.[39mactions[[34m0[39m][33m?.[39mactionType)[33m.[39m[34mtoBe[39m([32m'create_task'[39m)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m348| [39m    })[33m;[39m
    [90m349| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[237/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateEmbedding[2m > [22mshould generate 768-dimensional embedding
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m14:25[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m14:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[238/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateEmbedding[2m > [22mshould be normalized (magnitude close to 1)
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m24:25[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m24:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[239/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateEmbedding[2m > [22mshould generate different embeddings for different texts
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m46:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m46:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[240/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateEmbedding[2m > [22mshould handle long text
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m59:25[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m59:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[241/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateEmbedding[2m > [22mshould be consistent (same text produces same embedding)
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m68:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m68:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[242/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateBatchEmbeddings[2m > [22mshould generate embeddings for multiple texts
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding/batch[39m
[36m [2mâ¯[22m EmbeddingService.generateBatchEmbeddings src/services/embedding.ts:[2m66:24[22m[39m
    [90m 64| [39m      }
    [90m 65| [39m
    [90m 66| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding/batch'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 67| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 68| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m84:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateBatchEmbeddings src/services/embedding.ts:[2m66:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m84:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding/batch' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[243/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mgenerateBatchEmbeddings[2m > [22mshould preserve order of embeddings
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding/batch[39m
[36m [2mâ¯[22m EmbeddingService.generateBatchEmbeddings src/services/embedding.ts:[2m66:24[22m[39m
    [90m 64| [39m      }
    [90m 65| [39m
    [90m 66| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding/batch'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 67| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 68| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m111:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateBatchEmbeddings src/services/embedding.ts:[2m66:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m111:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding/batch' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[244/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mvalidateEmbedding[2m > [22mshould validate correct embedding
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m127:25[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m127:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[245/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mcalculateMagnitude[2m > [22mshould calculate magnitude of normalized embedding
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m162:25[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m162:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[246/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mcosineSimilarity[2m > [22mshould return 1 for identical embeddings
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m186:25[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m186:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[247/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mcosineSimilarity[2m > [22mshould handle different embeddings
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m196:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m196:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[248/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mcosineSimilarity[2m > [22mshould throw on dimension mismatch
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m207:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m207:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[249/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/embedding.test.ts[2m > [22mEmbeddingService[2m > [22mcosineSimilarity[2m > [22mshould be commutative
[31m[1mTypeError[22m: Failed to parse URL from /api/embedding[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:24[22m[39m
    [90m 14| [39m      }
    [90m 15| [39m
    [90m 16| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/embedding'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 17| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 18| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m219:26[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmbeddingService.generateEmbedding src/services/embedding.ts:[2m16:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/embedding.test.ts:[2m219:40[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/embedding' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[250/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotionDetectionService - Integration Tests[2m > [22mshould detect joy emotion from positive conversation
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m29:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m29:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[251/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotionDetectionService - Integration Tests[2m > [22mshould detect sadness emotion from negative conversation
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m51:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m51:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[252/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotionDetectionService - Integration Tests[2m > [22mshould calculate salience score with correct formula
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m68:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m68:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[253/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotionDetectionService - Integration Tests[2m > [22mshould classify salience tiers correctly
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m109:22[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m109:43[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[254/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotionDetectionService - Integration Tests[2m > [22mshould return valid dimensional values
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m131:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m131:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[255/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotionDetectionService - Integration Tests[2m > [22mshould handle multi-turn conversations
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m169:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m169:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[256/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mTopicExtractionService - Integration Tests[2m > [22mshould extract 3-5 topics from conversation
[31m[1mTypeError[22m: Failed to parse URL from /api/topic-extraction[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:24[22m[39m
    [90m 18| [39m      }
    [90m 19| [39m
    [90m 20| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/topic-extraction'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 21| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 22| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m194:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m194:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/topic-extraction' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[257/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mTopicExtractionService - Integration Tests[2m > [22mshould extract relevant topics from technical conversation
[31m[1mTypeError[22m: Failed to parse URL from /api/topic-extraction[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:24[22m[39m
    [90m 18| [39m      }
    [90m 19| [39m
    [90m 20| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/topic-extraction'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 21| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 22| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m215:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m215:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/topic-extraction' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[258/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mTopicExtractionService - Integration Tests[2m > [22mshould extract distinct topics without duplicates
[31m[1mTypeError[22m: Failed to parse URL from /api/topic-extraction[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:24[22m[39m
    [90m 18| [39m      }
    [90m 19| [39m
    [90m 20| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/topic-extraction'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 21| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 22| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m235:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m235:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/topic-extraction' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[259/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mTopicExtractionService - Integration Tests[2m > [22mshould handle empty or short conversations gracefully
[31m[1mTypeError[22m: Failed to parse URL from /api/topic-extraction[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:24[22m[39m
    [90m 18| [39m      }
    [90m 19| [39m
    [90m 20| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/topic-extraction'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 21| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 22| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m252:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m252:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/topic-extraction' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[260/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mTopicExtractionService - Integration Tests[2m > [22mshould return valid JSON format
[31m[1mTypeError[22m: Failed to parse URL from /api/topic-extraction[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:24[22m[39m
    [90m 18| [39m      }
    [90m 19| [39m
    [90m 20| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/topic-extraction'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 21| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 22| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m267:20[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m TopicExtractionService.extractTopics src/services/topic-extraction.ts:[2m20:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m267:39[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/topic-extraction' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[261/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotion Detection and Topic Extraction - Combined Tests[2m > [22mshould analyze emotion and extract topics from same conversation
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m292:27[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m292:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[262/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/integration.test.ts[2m > [22mEmotion Detection and Topic Extraction - Combined Tests[2m > [22mshould handle high-salience emotional conversation with relevant topics
[31m[1mTypeError[22m: Failed to parse URL from /api/emotion-detection[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:24[22m[39m
    [90m 20| [39m
    [90m 21| [39m      [90m// Call backend API endpoint instead of external API directly[39m
    [90m 22| [39m      [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m'/api/emotion-detection'[39m[33m,[39m {
    [90m   | [39m                       [31m^[39m
    [90m 23| [39m        method[33m:[39m [32m'POST'[39m[33m,[39m
    [90m 24| [39m        headers[33m:[39m {
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m318:27[22m[39m

[31m[1mCaused by: TypeError[22m: Invalid URL[39m
[36m [2mâ¯[22m EmotionDetectionService.analyzeConversation src/services/emotion-detection.ts:[2m22:30[22m[39m
[90m [2mâ¯[22m src/services/__tests__/integration.test.ts:[2m318:48[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ code: 'ERR_INVALID_URL', input: '/api/emotion-detection' }[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[263/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22mMeetingâ†’Task Integration Workflow[2m > [22mPre-Meeting Workflow[2m > [22mprepares meeting 15 minutes before start
[31m[1mTypeError[22m: Cannot read properties of null (reading 'userId')[39m
[36m [2mâ¯[22m src/services/__tests__/meeting-to-task.integration.test.ts:[2m55:22[22m[39m
    [90m 53| [39m
    [90m 54| [39m      [34mexpect[39m(context)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 55| [39m      [34mexpect[39m(context[33m.[39muserId)[33m.[39m[34mtoBe[39m(testUserId)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 56| [39m      [34mexpect[39m(context[33m.[39meventId)[33m.[39m[34mtoBe[39m(testEventId)[33m;[39m
    [90m 57| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(context[33m.[39mrelevantEmails))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[264/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22mMeetingâ†’Task Integration Workflow[2m > [22mPost-Meeting Workflow[2m > [22mextracts due dates from action items
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/meeting-to-task.integration.test.ts:[2m183:71[22m[39m
    [90m181| [39m
    [90m182| [39m      expect(dueDateToday === null || dueDateToday instanceof Date).toâ€¦
    [90m183| [39m      expect(dueDateFriday === null || dueDateFriday instanceof Date).â€¦
    [90m   | [39m                                                                      [31m^[39m
    [90m184| [39m    })[33m;[39m
    [90m185| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[265/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22mMeetingâ†’Task Integration Workflow[2m > [22mComplete Meeting Lifecycle[2m > [22mlinks pre-meeting context to post-meeting actions
[31m[1mTypeError[22m: Cannot read properties of null (reading 'prepTaskId')[39m
[36m [2mâ¯[22m src/services/__tests__/meeting-to-task.integration.test.ts:[2m263:26[22m[39m
    [90m261| [39m
    [90m262| [39m      const prepContext = await meetingPrepService.prepareMeeting(testâ€¦
    [90m263| [39m      [34mexpect[39m(prepContext[33m.[39mprepTaskId)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m264| [39m
    [90m265| [39m      const retrievedContext = await meetingPrepService.getMeetingContâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[266/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/meeting-to-task.integration.test.ts[2m > [22mMeetingâ†’Task Integration Workflow[2m > [22mType Safety[2m > [22mreturns properly typed meeting context
[31m[1mTypeError[22m: Cannot read properties of null (reading 'id')[39m
[36m [2mâ¯[22m src/services/__tests__/meeting-to-task.integration.test.ts:[2m408:22[22m[39m
    [90m406| [39m      const context = await meetingPrepService.prepareMeeting(testEvenâ€¦
    [90m407| [39m
    [90m408| [39m      [34mexpect[39m(context[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m409| [39m      [34mexpect[39m(context[33m.[39muserId)[33m.[39m[34mtoBe[39m(testUserId)[33m;[39m
    [90m410| [39m      [34mexpect[39m(context[33m.[39meventId)[33m.[39m[34mtoBe[39m(testEventId)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[267/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 1: Emailâ†’Task Automation[2m > [22mcreates task from incoming email matching rule
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m87:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[268/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 1: Emailâ†’Task Automation[2m > [22mrespects email from filter
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m112:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[269/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 1: Emailâ†’Task Automation[2m > [22msubstitutes template variables in task title
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m135:26[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[270/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 2: Calendarâ†’Task Automation[2m > [22mPre-Meeting Preparation[2m > [22mprepares meeting before it starts
[31m[1mTypeError[22m: Cannot read properties of null (reading 'prepTaskId')[39m
[36m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m150:24[22m[39m
    [90m148| [39m
    [90m149| [39m        [34mexpect[39m(context)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m150| [39m        [34mexpect[39m(context[33m.[39mprepTaskId)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m151| [39m        [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(context[33m.[39mrelevantEmails))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m152| [39m        [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(context[33m.[39mactionItems))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[271/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 3: Smart Scheduling[2m > [22mfinds best meeting times for multiple attendees
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m244:56[22m[39m
    [90m242| [39m
    [90m243| [39m      [34mexpect[39m(suggestion)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m244| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m245| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m246| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[272/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 3: Smart Scheduling[2m > [22mscores time slots based on multiple factors
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'length')[39m
[36m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m260:37[22m[39m
    [90m258| [39m      })[33m;[39m
    [90m259| [39m
    [90m260| [39m      [35mif[39m (suggestion[33m.[39msuggestedTimes[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m   | [39m                                    [31m^[39m
    [90m261| [39m        [35mconst[39m topSlot [33m=[39m suggestion[33m.[39msuggestedTimes[[34m0[39m][33m;[39m
    [90m262| [39m        [34mexpect[39m([35mtypeof[39m topSlot[33m.[39mscore)[33m.[39m[34mtoBe[39m([32m'number'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[273/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mTrack 3: Smart Scheduling[2m > [22mrespects time preferences
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m280:41[22m[39m
    [90m278| [39m
    [90m279| [39m      [90m// Should return suggestions even with preferences[39m
    [90m280| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m281| [39m    })[33m;[39m
    [90m282| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[274/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mCross-Track Integration[2m > [22morchestrator manages all automation types
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m345:44[22m[39m
    [90m343| [39m      await orchestrator.onTaskCreated({ id: 'task-1', title: 'Test' }â€¦
    [90m344| [39m
    [90m345| [39m      [34mexpect[39m(orchestrator[33m.[39m[34misInitialized[39m())[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m346| [39m    })[33m;[39m
    [90m347| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[275/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mCross-Track Integration[2m > [22mmultiple triggers can fire in sequence
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m355:26[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[276/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mComplete End-to-End Scenario[2m > [22mexecutes full automation lifecycle
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m401:46[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[277/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mComplete End-to-End Scenario[2m > [22mhandles complex multi-step workflows
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m447:35[22m[39m
    [90m445| [39m      })[33m;[39m
    [90m446| [39m
    [90m447| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m448| [39m
    [90m449| [39m      [90m// Step 2: Prepare for that meeting[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[278/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mError Recovery[2m > [22mcontinues workflow on partial failures
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m477:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[279/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mPerformance & Concurrency[2m > [22mhandles concurrent automation executions
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m523:44[22m[39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m523:16[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[280/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/phase7-e2e.test.ts[2m > [22mPhase 7 End-to-End Automation Workflows[2m > [22mPerformance & Concurrency[2m > [22mmaintains data consistency across workflows
[31m[1mTypeError[22m: __vite_ssr_import_0__.supabase.from(...).select(...).eq(...).eq is not a function[39m
[36m [2mâ¯[22m AutomationEmailTriggerService.onEmailReceived src/services/automation-email-trigger.ts:[2m130:10[22m[39m
    [90m128| [39m        [33m.[39m[34mselect[39m([32m'*'[39m)
    [90m129| [39m        [33m.[39m[34meq[39m([32m'user_id'[39m[33m,[39m userId)
    [90m130| [39m        [33m.[39m[34meq[39m([32m'trigger_type'[39m[33m,[39m [32m'email_received'[39m)
    [90m   | [39m         [31m^[39m
    [90m131| [39m        [33m.[39m[34meq[39m([32m'enabled'[39m[33m,[39m [35mtrue[39m)[33m;[39m
    [90m132| [39m
[90m [2mâ¯[22m src/services/__tests__/phase7-e2e.test.ts:[2m544:41[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[281/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mFinding Best Meeting Times[2m > [22mfinds suitable times for multiple attendees
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m52:56[22m[39m
    [90m 50| [39m
    [90m 51| [39m      [34mexpect[39m(suggestion)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 52| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m 53| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 54| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[282/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mFinding Best Meeting Times[2m > [22mrespects attendee count in scoring
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m77:45[22m[39m
    [90m 75| [39m      })[33m;[39m
    [90m 76| [39m
    [90m 77| [39m      [34mexpect[39m(singleAttendee[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m 78| [39m      [34mexpect[39m(multipleAttendees[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 79| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[283/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mFinding Best Meeting Times[2m > [22mreturns sorted suggestions by quality score
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'length')[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m93:37[22m[39m
    [90m 91| [39m      })[33m;[39m
    [90m 92| [39m
    [90m 93| [39m      [35mif[39m (suggestion[33m.[39msuggestedTimes[33m.[39mlength [33m>[39m [34m1[39m) {
    [90m   | [39m                                    [31m^[39m
    [90m 94| [39m        for (let i = 0; i < suggestion.suggestedTimes.length - 1; i++)â€¦
    [90m 95| [39m          expect(suggestion.suggestedTimes[i].score).toBeGreaterThanOrâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[284/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mTime Slot Scoring Algorithm[2m > [22mscores morning slots higher
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m155:52[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[285/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mTime Slot Scoring Algorithm[2m > [22mincludes time of day bonus in scoring
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m170:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[286/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mTime Slot Scoring Algorithm[2m > [22mincludes day of week scoring
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m184:45[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[287/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mTime Slot Scoring Algorithm[2m > [22mpenalizes excessive attendees
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m197:55[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[288/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mPreference Respecting[2m > [22mrespects preferred meeting times
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m213:62[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[289/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mPreference Respecting[2m > [22mavoids blocked times
[31m[1mTypeError[22m: slot.start.getHours is not a function[39m
[36m [2mâ¯[22m SmartSchedulingService.scoreTimeSlot src/services/automation-smart-scheduling.ts:[2m197:29[22m[39m
    [90m195| [39m    [35mlet[39m score [33m=[39m [34m50[39m[33m;[39m [90m// Base score[39m
    [90m196| [39m
    [90m197| [39m    [35mconst[39m hour [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetHours[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m198| [39m    [35mconst[39m day [33m=[39m slot[33m.[39mstart[33m.[39m[34mgetDay[39m()[33m;[39m
    [90m199| [39m
[90m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m230:61[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[290/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mDuration Handling[2m > [22mfinds slots for 30-minute meetings
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m253:41[22m[39m
    [90m251| [39m      })[33m;[39m
    [90m252| [39m
    [90m253| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m254| [39m    })[33m;[39m
    [90m255| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[291/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mDuration Handling[2m > [22mfinds slots for 2-hour meetings
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m268:41[22m[39m
    [90m266| [39m      })[33m;[39m
    [90m267| [39m
    [90m268| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m269| [39m    })[33m;[39m
    [90m270| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[292/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mDate Range Handling[2m > [22mrespects date range boundaries
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'length')[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m304:37[22m[39m
    [90m302| [39m      })[33m;[39m
    [90m303| [39m
    [90m304| [39m      [35mif[39m (suggestion[33m.[39msuggestedTimes[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m   | [39m                                    [31m^[39m
    [90m305| [39m        [35mfor[39m ([35mconst[39m slot [35mof[39m suggestion[33m.[39msuggestedTimes) {
    [90m306| [39m          expect(slot.start.getTime()).toBeGreaterThanOrEqual(tomorrowâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[293/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mDate Range Handling[2m > [22mhandles narrow date ranges
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m327:41[22m[39m
    [90m325| [39m      })[33m;[39m
    [90m326| [39m
    [90m327| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m328| [39m    })[33m;[39m
    [90m329| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[294/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mDate Range Handling[2m > [22mhandles wide date ranges
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'length')[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m342:40[22m[39m
    [90m340| [39m      })[33m;[39m
    [90m341| [39m
    [90m342| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes[33m.[39mlength)[33m.[39m[34mtoBeLessThanOrEqual[39m([34m5[39m)[33m;[39m
    [90m   | [39m                                       [31m^[39m
    [90m343| [39m    })[33m;[39m
    [90m344| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[295/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mBest Time Selection[2m > [22mselects best time from suggestions
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m359:35[22m[39m
    [90m357| [39m      })[33m;[39m
    [90m358| [39m
    [90m359| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m360| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime[33m.[39mstart)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m361| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime[33m.[39mend)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[296/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mPerformance[2m > [22mhandles large attendee lists
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m458:41[22m[39m
    [90m456| [39m      })[33m;[39m
    [90m457| [39m
    [90m458| [39m      [34mexpect[39m(suggestion[33m.[39msuggestedTimes)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m459| [39m    })[33m;[39m
    [90m460| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[297/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/services/__tests__/smart-scheduling.integration.test.ts[2m > [22mSmart Scheduling Integration Workflow[2m > [22mType Safety[2m > [22mreturns properly typed suggestion
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m src/services/__tests__/smart-scheduling.integration.test.ts:[2m475:56[22m[39m
    [90m473| [39m      })[33m;[39m
    [90m474| [39m
    [90m475| [39m      [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(suggestion[33m.[39msuggestedTimes))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                                       [31m^[39m
    [90m476| [39m      [34mexpect[39m(suggestion[33m.[39mbestTime)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m477| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[298/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mCreate Operations[2m > [22mshould insert conversation with emotional metadata
[31m[1mAssertionError[22m: expected undefined to be 'c70f46cd-8599-4418-aff4-db5625400b3f' // Object.is equality[39m

[32m- Expected:[39m 
"c70f46cd-8599-4418-aff4-db5625400b3f"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m49:30[22m[39m
    [90m 47| [39m
    [90m 48| [39m      [34mexpect[39m(result[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 49| [39m      [34mexpect[39m(result[33m.[39muser_id)[33m.[39m[34mtoBe[39m(testUserId)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m 50| [39m      [34mexpect[39m(result[33m.[39mcreated_at)[33m.[39m[34mtoBeInstanceOf[39m([33mDate[39m)[33m;[39m
    [90m 51| [39m      [34mexpect[39m(result[33m.[39mprimary_emotion)[33m.[39m[34mtoBe[39m([32m'joy'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[299/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mCreate Operations[2m > [22mshould store conversation with default optional fields
[31m[1mAssertionError[22m: expected undefined to be 1 // Object.is equality[39m

[32m- Expected:[39m 
1

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m64:39[22m[39m
    [90m 62| [39m
    [90m 63| [39m      [34mexpect[39m(result[33m.[39mid)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m 64| [39m      [34mexpect[39m(result[33m.[39mdecay_multiplier)[33m.[39m[34mtoBe[39m([34m1.0[39m)[33m;[39m
    [90m   | [39m                                      [31m^[39m
    [90m 65| [39m      [34mexpect[39m(result[33m.[39muser_marked_important)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m 66| [39m      [34mexpect[39m(result[33m.[39mis_deleted)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[300/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mCreate Operations[2m > [22mshould store conversation with all optional fields
[31m[1mAssertionError[22m: expected undefined to be 'father-legacy' // Object.is equality[39m

[32m- Expected:[39m 
"father-legacy"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m77:41[22m[39m
    [90m 75| [39m      [35mconst[39m result [33m=[39m [35mawait[39m repository[33m.[39m[34mstoreConversation[39m(testData)[33m;[39m
    [90m 76| [39m
    [90m 77| [39m      [34mexpect[39m(result[33m.[39mattachment_context)[33m.[39m[34mtoBe[39m([32m'father-legacy'[39m)[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m 78| [39m      [34mexpect[39m(result[33m.[39mprospective_self_context)[33m.[39m[34mtoBe[39m([32m'career-goals'[39m)[33m;[39m
    [90m 79| [39m      [34mexpect[39m(result[33m.[39minstance_key)[33m.[39m[34mtoBe[39m([32m'conversation-instance-1'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[301/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mRead Operations[2m > [22mshould retrieve recent memories ordered by date descending
[31m[1mAssertionError[22m: expected 1 to be greater than or equal to 3[39m
[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m100:29[22m[39m
    [90m 98| [39m      const recent = await repository.getRecentMemories(testUserId, 10â€¦
    [90m 99| [39m
    [90m100| [39m      [34mexpect[39m(recent[33m.[39mlength)[33m.[39m[34mtoBeGreaterThanOrEqual[39m([34m3[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m101| [39m      [90m// Most recent should come first[39m
    [90m102| [39m      [35mconst[39m indices [33m=[39m [

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[302/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mRead Operations[2m > [22mshould respect limit and offset pagination
[31m[1mAssertionError[22m: expected 'test-id' not to be 'test-id' // Object.is equality[39m
[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m128:31[22m[39m
    [90m126| [39m      [34mexpect[39m(page1[33m.[39mlength)[33m.[39m[34mtoBeLessThanOrEqual[39m([34m2[39m)[33m;[39m
    [90m127| [39m      [34mexpect[39m(page2[33m.[39mlength)[33m.[39m[34mtoBeLessThanOrEqual[39m([34m2[39m)[33m;[39m
    [90m128| [39m      [34mexpect[39m(page1[[34m0[39m][33m.[39mid)[33m.[39mnot[33m.[39m[34mtoBe[39m(page2[[34m0[39m][33m.[39mid)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m129| [39m      [34mexpect[39m(page2[[34m0[39m][33m.[39mid)[33m.[39mnot[33m.[39m[34mtoBe[39m(page3[[34m0[39m][33m.[39mid)[33m;[39m
    [90m130| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[303/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mRead Operations[2m > [22mshould exclude soft-deleted conversations from results
[31m[1mAssertionError[22m: expected 1 to be 2 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 1[39m

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m138:28[22m[39m
    [90m136| [39m      [35mawait[39m repository[33m.[39m[34mstoreConversation[39m([34mcreateTestConversation[39m())[33m;[39m
    [90m137| [39m      const after = await repository.getRecentMemories(testUserId, 100â€¦
    [90m138| [39m      [34mexpect[39m(after[33m.[39mlength)[33m.[39m[34mtoBe[39m(initialCount [33m+[39m [34m1[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m139| [39m    })[33m;[39m
    [90m140| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[304/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mVector Search Operations[2m > [22mshould perform similarity search using pgvector
[31m[1mTypeError[22m: Cannot read properties of null (reading 'map')[39m
[36m [2mâ¯[22m MemoryRepository.semanticSearch src/lib/repositories/memory-repository.ts:[2m119:17[22m[39m
    [90m117| [39m    }
    [90m118| [39m
    [90m119| [39m    [35mreturn[39m data[33m.[39m[34mmap[39m((row[33m:[39m any) [33m=>[39m ({
    [90m   | [39m                [31m^[39m
    [90m120| [39m      [33m...[39mrow[33m,[39m
    [90m121| [39m      created_at[33m:[39m [35mnew[39m [33mDate[39m(row[33m.[39mcreated_at)[33m,[39m
[90m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m154:23[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[305/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mVector Search Operations[2m > [22mshould return empty results for user with no memories
[31m[1mTypeError[22m: Cannot read properties of null (reading 'map')[39m
[36m [2mâ¯[22m MemoryRepository.semanticSearch src/lib/repositories/memory-repository.ts:[2m119:17[22m[39m
    [90m117| [39m    }
    [90m118| [39m
    [90m119| [39m    [35mreturn[39m data[33m.[39m[34mmap[39m((row[33m:[39m any) [33m=>[39m ({
    [90m   | [39m                [31m^[39m
    [90m120| [39m      [33m...[39mrow[33m,[39m
    [90m121| [39m      created_at[33m:[39m [35mnew[39m [33mDate[39m(row[33m.[39mcreated_at)[33m,[39m
[90m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m164:23[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[306/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mVector Search Operations[2m > [22mshould respect limit parameter in search results
[31m[1mTypeError[22m: Cannot read properties of null (reading 'map')[39m
[36m [2mâ¯[22m MemoryRepository.semanticSearch src/lib/repositories/memory-repository.ts:[2m119:17[22m[39m
    [90m117| [39m    }
    [90m118| [39m
    [90m119| [39m    [35mreturn[39m data[33m.[39m[34mmap[39m((row[33m:[39m any) [33m=>[39m ({
    [90m   | [39m                [31m^[39m
    [90m120| [39m      [33m...[39mrow[33m,[39m
    [90m121| [39m      created_at[33m:[39m [35mnew[39m [33mDate[39m(row[33m.[39mcreated_at)[33m,[39m
[90m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m181:24[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[307/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mUpdate Operations[2m > [22mshould update conversation with emotion analysis
[31m[1mAssertionError[22m: expected undefined to be 'joy' // Object.is equality[39m

[32m- Expected:[39m 
"joy"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m219:42[22m[39m
    [90m217| [39m      [35mconst[39m foundConv [33m=[39m updated[33m.[39m[34mfind[39m((c) [33m=>[39m c[33m.[39mid [33m===[39m testConv[33m.[39mid)[33m;[39m
    [90m218| [39m
    [90m219| [39m      [34mexpect[39m(foundConv[33m?.[39mprimary_emotion)[33m.[39m[34mtoBe[39m([32m'joy'[39m)[33m;[39m
    [90m   | [39m                                         [31m^[39m
    [90m220| [39m      [34mexpect[39m(foundConv[33m?.[39memotional_salience)[33m.[39m[34mtoBe[39m([34m0.85[39m)[33m;[39m
    [90m221| [39m      [34mexpect[39m(foundConv[33m?.[39msalience_tier)[33m.[39m[34mtoBe[39m([32m'critical'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[308/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mUpdate Operations[2m > [22mshould update secondary emotions in emotion analysis
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m252:45[22m[39m
    [90m250| [39m      [35mconst[39m foundConv [33m=[39m updated[33m.[39m[34mfind[39m((c) [33m=>[39m c[33m.[39mid [33m===[39m testConv[33m.[39mid)[33m;[39m
    [90m251| [39m
    [90m252| [39m      [34mexpect[39m(foundConv[33m?.[39msecondary_emotions)[33m.[39m[34mtoContain[39m([32m'gratitude'[39m)[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m253| [39m      [34mexpect[39m(foundConv[33m?.[39msecondary_emotions)[33m.[39m[34mtoContain[39m([32m'excitement'[39m)[33m;[39m
    [90m254| [39m      [34mexpect[39m(foundConv[33m?.[39msecondary_emotions)[33m.[39m[34mtoContain[39m([32m'relief'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[309/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mSalience Tier Operations[2m > [22mshould store conversations with different salience tiers
[31m[1mAssertionError[22m: expected undefined to be 'critical' // Object.is equality[39m

[32m- Expected:[39m 
"critical"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m279:42[22m[39m
    [90m277| [39m
    [90m278| [39m      [35mfor[39m ([35mlet[39m i [33m=[39m [34m0[39m[33m;[39m i [33m<[39m tiers[33m.[39mlength[33m;[39m i[33m++[39m) {
    [90m279| [39m        [34mexpect[39m(results[i][33m.[39msalience_tier)[33m.[39m[34mtoBe[39m(tiers[i])[33m;[39m
    [90m   | [39m                                         [31m^[39m
    [90m280| [39m      }
    [90m281| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[310/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mData Format and Integrity[2m > [22mshould properly store and retrieve complex message arrays
[31m[1mAssertionError[22m: expected undefined to deeply equal [ { role: 'user', â€¦(2) }, â€¦(2) ][39m

[32m- Expected:[39m 
[
  {
    "content": "Hello",
    "role": "user",
    "timestamp": 1770299933055,
  },
  {
    "content": "Hi there!",
    "role": "assistant",
    "timestamp": 1770299933055,
  },
  {
    "content": "How are you?",
    "role": "user",
    "timestamp": 1770299933055,
  },
]

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m301:35[22m[39m
    [90m299| [39m      [35mconst[39m foundConv [33m=[39m retrieved[33m.[39m[34mfind[39m((c) [33m=>[39m c[33m.[39mid [33m===[39m testConv[33m.[39mid)[33m;[39m
    [90m300| [39m
    [90m301| [39m      [34mexpect[39m(foundConv[33m?.[39mmessages)[33m.[39m[34mtoEqual[39m(complexMessages)[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m302| [39m      [34mexpect[39m(foundConv[33m?.[39mmessages[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m3[39m)[33m;[39m
    [90m303| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[311/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mData Format and Integrity[2m > [22mshould properly handle array fields (secondary_emotions, topics)
[31m[1mAssertionError[22m: expected undefined to deeply equal [ 'gratitude', 'trust', 'contentment' ][39m

[32m- Expected:[39m 
[
  "gratitude",
  "trust",
  "contentment",
]

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m316:45[22m[39m
    [90m314| [39m      [35mconst[39m foundConv [33m=[39m retrieved[33m.[39m[34mfind[39m((c) [33m=>[39m c[33m.[39mid [33m===[39m testConv[33m.[39mid)[33m;[39m
    [90m315| [39m
    [90m316| [39m      expect(foundConv?.secondary_emotions).toEqual(['gratitude', 'truâ€¦
    [90m   | [39m                                            [31m^[39m
    [90m317| [39m      expect(foundConv?.extracted_topics).toEqual(['relationships', 'pâ€¦
    [90m318| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[312/454]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/lib/repositories/__tests__/conversations.test.ts[2m > [22mMemoryRepository[2m > [22mIntegration Tests[2m > [22mshould perform complete workflow: create, retrieve, update, search
[31m[1mAssertionError[22m: expected undefined to be 'joy' // Object.is equality[39m

[32m- Expected:[39m 
"joy"

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m src/lib/repositories/__tests__/conversations.test.ts:[2m377:44[22m[39m
    [90m375| [39m      const updated = await repository.getRecentMemories(testUserId, 1â€¦
    [90m376| [39m      [35mconst[39m updatedConv [33m=[39m updated[33m.[39m[34mfind[39m((c) [33m=>[39m c[33m.[39mid [33m===[39m conv1[33m.[39mid)[33m;[39m
    [90m377| [39m      [34mexpect[39m(updatedConv[33m?.[39mprimary_emotion)[33m.[39m[34mtoBe[39m([32m'joy'[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m378| [39m      [34mexpect[39m(updatedConv[33m?.[39memotional_salience)[33m.[39m[34mtoBe[39m([34m0.75[39m)[33m;[39m
    [90m379| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[313/454]âŽ¯[22m[39m


[2m Test Files [22m [1m[31m51 failed[39m[22m[2m | [22m[1m[32m42 passed[39m[22m[90m (93)[39m
[2m      Tests [22m [1m[31m388 failed[39m[22m[2m | [22m[1m[32m2088 passed[39m[22m[2m | [22m[33m13 skipped[39m[90m (2489)[39m
[2m   Start at [22m 10:58:49
[2m   Duration [22m 17.16s[2m (transform 31.36s, setup 22.26s, import 33.46s, tests 43.18s, environment 97.22s)[22m

